<!doctype html>
<html lang="zh-CN" data-theme="light">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <meta name="generator" content="VuePress 2.0.0-rc.18" />
    <meta name="theme" content="VuePress Theme Hope 2.0.0-rc.27" />
    <style>
      html {
        background: var(--bg-color, #fff);
      }

      html[data-theme="dark"] {
        background: var(--bg-color, #1d1e1f);
      }

      body {
        background: var(--bg-color);
      }
    </style>
    <script>
      const userMode = localStorage.getItem("vuepress-theme-hope-scheme");
      const systemDarkMode =
        window.matchMedia &&
        window.matchMedia("(prefers-color-scheme: dark)").matches;

      if (userMode === "dark" || (userMode !== "light" && systemDarkMode)) {
        document.documentElement.setAttribute("data-theme", "dark");
      }
    </script>
    <meta property="og:url" content="https://echo0d.github.io/DailyNotes/develop/FrontEnd/JSModularity.html"><meta property="og:site_name" content="echo0d'notes"><meta property="og:title" content="前端模块化"><meta property="og:description" content="前端模块化 1. 模块化的理解 1.1. 什么是模块化 将一个复杂的程序依据一定的规则(规范)封装成几个块(文件), 并进行组合在一起 块的内部数据与实现是私有的, 只是向外部暴露一些接口(方法)与外部其它模块通信 模块化开发的好处 避免命名冲突 更好地分离, 降低了耦合 提高代码的复用性 提高代码的可维护性 1.2. 模块化的演进 全局函数模式 将不..."><meta property="og:type" content="article"><meta property="og:locale" content="zh-CN"><meta property="og:updated_time" content="2024-12-31T03:05:33.000Z"><meta property="article:author" content="echo0d"><meta property="article:modified_time" content="2024-12-31T03:05:33.000Z"><script type="application/ld+json">{"@context":"https://schema.org","@type":"Article","headline":"前端模块化","image":[""],"dateModified":"2024-12-31T03:05:33.000Z","author":[{"@type":"Person","name":"echo0d","url":""}]}</script><link rel="alternate" type="application/atom+xml" href="https://echo0d.github.io/DailyNotes/atom.xml" title="echo0d'notes Atom Feed"><link rel="alternate" type="application/json" href="https://echo0d.github.io/DailyNotes/feed.json" title="echo0d'notes JSON Feed"><link rel="alternate" type="application/rss+xml" href="https://echo0d.github.io/DailyNotes/rss.xml" title="echo0d'notes RSS Feed"><title>前端模块化 | echo0d'notes</title><meta name="description" content="前端模块化 1. 模块化的理解 1.1. 什么是模块化 将一个复杂的程序依据一定的规则(规范)封装成几个块(文件), 并进行组合在一起 块的内部数据与实现是私有的, 只是向外部暴露一些接口(方法)与外部其它模块通信 模块化开发的好处 避免命名冲突 更好地分离, 降低了耦合 提高代码的复用性 提高代码的可维护性 1.2. 模块化的演进 全局函数模式 将不...">
    <link rel="preload" href="/DailyNotes/assets/style-CV2lW7Pe.css" as="style"><link rel="stylesheet" href="/DailyNotes/assets/style-CV2lW7Pe.css">
    <link rel="modulepreload" href="/DailyNotes/assets/app-C5cR4qpO.js"><link rel="modulepreload" href="/DailyNotes/assets/JSModularity.html-Bh5vla5V.js"><link rel="modulepreload" href="/DailyNotes/assets/plugin-vue_export-helper-DlAUqK2U.js">
    <link rel="prefetch" href="/DailyNotes/assets/index.html-DxnBVUDa.js" as="script"><link rel="prefetch" href="/DailyNotes/assets/index.html-CA5lCDZo.js" as="script"><link rel="prefetch" href="/DailyNotes/assets/DailySkills.html-Bd1Pyhiw.js" as="script"><link rel="prefetch" href="/DailyNotes/assets/Treasure.html-Dcs93DEU.js" as="script"><link rel="prefetch" href="/DailyNotes/assets/1-FileSystem.html-D6mmlxUw.js" as="script"><link rel="prefetch" href="/DailyNotes/assets/2-commandExecute.html-dYoYa8Ds.js" as="script"><link rel="prefetch" href="/DailyNotes/assets/3-Database.html-CYzNqtk8.js" as="script"><link rel="prefetch" href="/DailyNotes/assets/4-JNDI.html-7f6nckKG.js" as="script"><link rel="prefetch" href="/DailyNotes/assets/5-reflection.html-CMn2z5Yp.js" as="script"><link rel="prefetch" href="/DailyNotes/assets/6-ClassLoader.html-DhqpIiRQ.js" as="script"><link rel="prefetch" href="/DailyNotes/assets/7-DynamicProxy.html-lYQOS3lT.js" as="script"><link rel="prefetch" href="/DailyNotes/assets/1-JavaEE.html-CAggtZuu.js" as="script"><link rel="prefetch" href="/DailyNotes/assets/2-JavaMVC.html-DbvtQPSZ.js" as="script"><link rel="prefetch" href="/DailyNotes/assets/3-JavaWeb_Servlet.html-amH6tphV.js" as="script"><link rel="prefetch" href="/DailyNotes/assets/4-JavaWeb_filter.html-DD8Ec11W.js" as="script"><link rel="prefetch" href="/DailyNotes/assets/5-JavaWeb_Listener.html-zIhAHUko.js" as="script"><link rel="prefetch" href="/DailyNotes/assets/6-CookieAndSession.html-B0-gOCve.js" as="script"><link rel="prefetch" href="/DailyNotes/assets/7-JSP.html-VrWwxPju.js" as="script"><link rel="prefetch" href="/DailyNotes/assets/JavaVul.html-Dj8E0vkO.js" as="script"><link rel="prefetch" href="/DailyNotes/assets/deserialize.html-BVYkDSC_.js" as="script"><link rel="prefetch" href="/DailyNotes/assets/GoVul.html-DjL3zfN3.js" as="script"><link rel="prefetch" href="/DailyNotes/assets/1-CTF_WEB.html-B48DFnOr.js" as="script"><link rel="prefetch" href="/DailyNotes/assets/index.html-CfDkL0Fu.js" as="script"><link rel="prefetch" href="/DailyNotes/assets/ExecuteAssembly.html-D-QFrUiw.js" as="script"><link rel="prefetch" href="/DailyNotes/assets/RDI.html-BrVAI2IW.js" as="script"><link rel="prefetch" href="/DailyNotes/assets/index.html-Dc_ijCD_.js" as="script"><link rel="prefetch" href="/DailyNotes/assets/index.html-yQzOoJ-n.js" as="script"><link rel="prefetch" href="/DailyNotes/assets/1_syntax.html-DrNmpXOH.js" as="script"><link rel="prefetch" href="/DailyNotes/assets/2_VariableTypes.html-WwNhtQ-q.js" as="script"><link rel="prefetch" href="/DailyNotes/assets/index.html-Bx2Xx-9w.js" as="script"><link rel="prefetch" href="/DailyNotes/assets/index.html-Br2EsOfM.js" as="script"><link rel="prefetch" href="/DailyNotes/assets/index.html-Dz2fbnUO.js" as="script"><link rel="prefetch" href="/DailyNotes/assets/React_Typescript_antd.html-Y4YUGC7J.js" as="script"><link rel="prefetch" href="/DailyNotes/assets/Vue.html-DOlUI5X8.js" as="script"><link rel="prefetch" href="/DailyNotes/assets/1_JavaBase.html-B4NVzDFe.js" as="script"><link rel="prefetch" href="/DailyNotes/assets/2_ObjectOriented.html-CMG0UTJO.js" as="script"><link rel="prefetch" href="/DailyNotes/assets/3_CoreClass.html-yZOa8bip.js" as="script"><link rel="prefetch" href="/DailyNotes/assets/4_Exception.html-DVvnR0rc.js" as="script"><link rel="prefetch" href="/DailyNotes/assets/5_Reflection.html-BWyXZYHK.js" as="script"><link rel="prefetch" href="/DailyNotes/assets/6_Annotation.html-KJnsMskU.js" as="script"><link rel="prefetch" href="/DailyNotes/assets/7_Genericity.html-ClxV6TPa.js" as="script"><link rel="prefetch" href="/DailyNotes/assets/index.html-D9W4DEuE.js" as="script"><link rel="prefetch" href="/DailyNotes/assets/test_django.html-Do3psCU8.js" as="script"><link rel="prefetch" href="/DailyNotes/assets/index.html-TNOMhTJ_.js" as="script"><link rel="prefetch" href="/DailyNotes/assets/anti-debug.html-NeHk4hRT.js" as="script"><link rel="prefetch" href="/DailyNotes/assets/index.html-m26Ei5iH.js" as="script"><link rel="prefetch" href="/DailyNotes/assets/1_InformationGathering.html-BlNYGpZ7.js" as="script"><link rel="prefetch" href="/DailyNotes/assets/2_Intranet_windows.html-Cy6FgTYD.js" as="script"><link rel="prefetch" href="/DailyNotes/assets/3_CDN.html-7CSY8I9J.js" as="script"><link rel="prefetch" href="/DailyNotes/assets/1_LinuxPersistence.html-DRkM1Vga.js" as="script"><link rel="prefetch" href="/DailyNotes/assets/2_WindowsPersistence.html-DAD5jiyL.js" as="script"><link rel="prefetch" href="/DailyNotes/assets/3_ProcessInjection.html-yxJpjZT6.js" as="script"><link rel="prefetch" href="/DailyNotes/assets/1_Linux.html-DhQ7nB1z.js" as="script"><link rel="prefetch" href="/DailyNotes/assets/2_Windows.html-D1r47NdA.js" as="script"><link rel="prefetch" href="/DailyNotes/assets/Intranet_tunnel.html-Bzf1r3c0.js" as="script"><link rel="prefetch" href="/DailyNotes/assets/Tamper.html-BlJA5zAE.js" as="script"><link rel="prefetch" href="/DailyNotes/assets/TracesRemoval.html-DHecL4I5.js" as="script"><link rel="prefetch" href="/DailyNotes/assets/Burpsuite.html-BLDFPA-I.js" as="script"><link rel="prefetch" href="/DailyNotes/assets/SQLmap.html-BiHy3vFE.js" as="script"><link rel="prefetch" href="/DailyNotes/assets/Tunnel.html-C1bflLYV.js" as="script"><link rel="prefetch" href="/DailyNotes/assets/WebShell.html-BRWWOvlA.js" as="script"><link rel="prefetch" href="/DailyNotes/assets/openwrt.html-DDhP7vsk.js" as="script"><link rel="prefetch" href="/DailyNotes/assets/1_GoFinal.html-DdWTXGwU.js" as="script"><link rel="prefetch" href="/DailyNotes/assets/2_fscanPro.html-CpApcBGR.js" as="script"><link rel="prefetch" href="/DailyNotes/assets/index.html-CA1A_8eS.js" as="script"><link rel="prefetch" href="/DailyNotes/assets/index.html-MMjxTejJ.js" as="script"><link rel="prefetch" href="/DailyNotes/assets/ch1.html-Cvdb4Tli.js" as="script"><link rel="prefetch" href="/DailyNotes/assets/ch10.html-BLzhQSMo.js" as="script"><link rel="prefetch" href="/DailyNotes/assets/ch11.html-CC4T4ANJ.js" as="script"><link rel="prefetch" href="/DailyNotes/assets/ch12.html-CEz0KVQf.js" as="script"><link rel="prefetch" href="/DailyNotes/assets/ch2.html-B7i4BibS.js" as="script"><link rel="prefetch" href="/DailyNotes/assets/ch3.html-BPYV7yNf.js" as="script"><link rel="prefetch" href="/DailyNotes/assets/ch4.html-vDiws5ni.js" as="script"><link rel="prefetch" href="/DailyNotes/assets/ch5.html-_tIuVafx.js" as="script"><link rel="prefetch" href="/DailyNotes/assets/ch6.html-CGLuKw9Y.js" as="script"><link rel="prefetch" href="/DailyNotes/assets/ch7.html-BCnoMJ9O.js" as="script"><link rel="prefetch" href="/DailyNotes/assets/node_CVE-2017-14849.html-zkbVQbH-.js" as="script"><link rel="prefetch" href="/DailyNotes/assets/tomcat_CVE-2017-12615.html-DZj3k0YF.js" as="script"><link rel="prefetch" href="/DailyNotes/assets/tomcat_CVE-2020-1938.html-BNcOxlky.js" as="script"><link rel="prefetch" href="/DailyNotes/assets/weblogic_CVE-2017-10271.html-BvL_22L8.js" as="script"><link rel="prefetch" href="/DailyNotes/assets/weblogic_CVE-2018-2894.html-CstZUAA0.js" as="script"><link rel="prefetch" href="/DailyNotes/assets/weblogic_CVE-2020-14882.html-Dt3Y10Iu.js" as="script"><link rel="prefetch" href="/DailyNotes/assets/FastjsonVul.html-DWjfN0Ki.js" as="script"><link rel="prefetch" href="/DailyNotes/assets/log4j2 .html-CB0g7r5Y.js" as="script"><link rel="prefetch" href="/DailyNotes/assets/shiro.html-DPm7BDCr.js" as="script"><link rel="prefetch" href="/DailyNotes/assets/反序列化_shiro_CVE-2019-12422_shiro721反序列化命令执行漏洞.html-D0_6rhW2.js" as="script"><link rel="prefetch" href="/DailyNotes/assets/权限绕过_shiro_CVE-2020-11989_Apache Shiro782权限绕过漏洞.html-DtEhdZTA.js" as="script"><link rel="prefetch" href="/DailyNotes/assets/权限绕过_shiro_CVE-2020-13933_Apache Shiro权限绕过漏洞.html-C_qXX2ds.js" as="script"><link rel="prefetch" href="/DailyNotes/assets/spring.html-nXxKkb61.js" as="script"><link rel="prefetch" href="/DailyNotes/assets/spring_CVE-2018-1273_bypass.html-DdnzpcS6.js" as="script"><link rel="prefetch" href="/DailyNotes/assets/supervisor_CVE-2017-11610.html-CsxdOqXF.js" as="script"><link rel="prefetch" href="/DailyNotes/assets/xstream_CVE-2021-21351.html-WCxLCycf.js" as="script"><link rel="prefetch" href="/DailyNotes/assets/C3.html-D5YMNf-R.js" as="script"><link rel="prefetch" href="/DailyNotes/assets/CS.html-ASK2AseJ.js" as="script"><link rel="prefetch" href="/DailyNotes/assets/MSFUse.html-B4gZLBA9.js" as="script"><link rel="prefetch" href="/DailyNotes/assets/MSF_CS.html-MeoUZlKW.js" as="script"><link rel="prefetch" href="/DailyNotes/assets/404.html-BLkp2l3W.js" as="script"><link rel="prefetch" href="/DailyNotes/assets/index.html-DJQeLb05.js" as="script"><link rel="prefetch" href="/DailyNotes/assets/index.html-O9YOU2wO.js" as="script"><link rel="prefetch" href="/DailyNotes/assets/index.html-cu5qPhty.js" as="script"><link rel="prefetch" href="/DailyNotes/assets/index.html-DwwUhiPm.js" as="script"><link rel="prefetch" href="/DailyNotes/assets/index.html-k0DkECbF.js" as="script"><link rel="prefetch" href="/DailyNotes/assets/index.html-DTsWv8AB.js" as="script"><link rel="prefetch" href="/DailyNotes/assets/index.html-2T6cjQvo.js" as="script"><link rel="prefetch" href="/DailyNotes/assets/index.html-dpecgtCf.js" as="script"><link rel="prefetch" href="/DailyNotes/assets/index.html-CMtntObE.js" as="script"><link rel="prefetch" href="/DailyNotes/assets/index.html-MZ8Yvpqk.js" as="script"><link rel="prefetch" href="/DailyNotes/assets/index.html-DWCXrs96.js" as="script"><link rel="prefetch" href="/DailyNotes/assets/index.html-BOIA3tED.js" as="script"><link rel="prefetch" href="/DailyNotes/assets/index.html-XPQnecdj.js" as="script"><link rel="prefetch" href="/DailyNotes/assets/index.html-CBA17jLG.js" as="script"><link rel="prefetch" href="/DailyNotes/assets/index.html-DCyGU3It.js" as="script"><link rel="prefetch" href="/DailyNotes/assets/index.html-BR-LIUbT.js" as="script"><link rel="prefetch" href="/DailyNotes/assets/index.html-DLVCupXM.js" as="script"><link rel="prefetch" href="/DailyNotes/assets/index.html-CNm6UFWr.js" as="script"><link rel="prefetch" href="/DailyNotes/assets/index.html-DDBsj7Ub.js" as="script"><link rel="prefetch" href="/DailyNotes/assets/index.html-SofaEJpN.js" as="script"><link rel="prefetch" href="/DailyNotes/assets/index.html-CHK30OXB.js" as="script"><link rel="prefetch" href="/DailyNotes/assets/index.html-BWVa7KKE.js" as="script"><link rel="prefetch" href="/DailyNotes/assets/index.html-DOhxA24H.js" as="script"><link rel="prefetch" href="/DailyNotes/assets/index.html-CZ3Frny3.js" as="script"><link rel="prefetch" href="/DailyNotes/assets/index.html-0GDbSRVa.js" as="script"><link rel="prefetch" href="/DailyNotes/assets/index.html-CI6y-Hat.js" as="script"><link rel="prefetch" href="/DailyNotes/assets/index.html-CP1-npig.js" as="script"><link rel="prefetch" href="/DailyNotes/assets/photoswipe.esm-CMg0yb1C.js" as="script"><link rel="prefetch" href="/DailyNotes/assets/SearchResult-DI0KkfUs.js" as="script"><link rel="prefetch" href="/DailyNotes/assets/setupDevtools-7MC2TMWH-CMFffQNO.js" as="script">
  </head>
  <body>
    <div id="app"><!--[--><!--[--><!--[--><span tabindex="-1"></span><a href="#main-content" class="vp-skip-link sr-only">跳至主要內容</a><!--]--><div class="theme-container has-toc"><!--[--><header id="navbar" class="vp-navbar"><div class="vp-navbar-start"><button type="button" class="vp-toggle-sidebar-button" title="Toggle Sidebar"><span class="icon"></span></button><!--[--><!----><!--]--><!--[--><a class="route-link vp-brand" href="/DailyNotes/"><img class="vp-nav-logo" src="/DailyNotes/logo.jpg" alt><!----><span class="vp-site-name hide-in-pad">echo0d&#39;notes</span></a><!--]--><!--[--><!----><!--]--></div><div class="vp-navbar-center"><!--[--><!----><!--]--><!--[--><nav class="vp-nav-links"><div class="nav-item hide-in-mobile"><a class="route-link nav-link" href="/DailyNotes/CyberSecurity/" aria-label="网络安全"><span class="font-icon icon fa-fw fa-sm fas fa-laptop-code" style=""></span>网络安全<!----></a></div><div class="nav-item hide-in-mobile"><a class="route-link nav-link" href="/DailyNotes/CodeAudittutorial/" aria-label="代码审计"><span class="font-icon icon fa-fw fa-sm fas fa-laptop-code" style=""></span>代码审计<!----></a></div><div class="nav-item hide-in-mobile"><a class="route-link nav-link active" href="/DailyNotes/develop/" aria-label="开发技术"><span class="font-icon icon fa-fw fa-sm fas fa-laptop-code" style=""></span>开发技术<!----></a></div><div class="nav-item hide-in-mobile"><a class="route-link nav-link" href="/DailyNotes/others/" aria-label="其他随笔"><span class="font-icon icon fa-fw fa-sm fas fa-laptop-code" style=""></span>其他随笔<!----></a></div></nav><!--]--><!--[--><!----><!--]--></div><div class="vp-navbar-end"><!--[--><!----><!--]--><!--[--><!----><div class="nav-item vp-repo"><a class="vp-repo-link" href="https://github.com/echo0d/DailyNotes" target="_blank" rel="noopener noreferrer" aria-label="GitHub"><svg xmlns="http://www.w3.org/2000/svg" class="icon github-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="github icon" style="width:1.25rem;height:1.25rem;vertical-align:middle;"><path d="M511.957 21.333C241.024 21.333 21.333 240.981 21.333 512c0 216.832 140.544 400.725 335.574 465.664 24.49 4.395 32.256-10.07 32.256-23.083 0-11.69.256-44.245 0-85.205-136.448 29.61-164.736-64.64-164.736-64.64-22.315-56.704-54.4-71.765-54.4-71.765-44.587-30.464 3.285-29.824 3.285-29.824 49.195 3.413 75.179 50.517 75.179 50.517 43.776 75.008 114.816 53.333 142.762 40.79 4.523-31.66 17.152-53.377 31.19-65.537-108.971-12.458-223.488-54.485-223.488-242.602 0-53.547 19.114-97.323 50.517-131.67-5.035-12.33-21.93-62.293 4.779-129.834 0 0 41.258-13.184 134.912 50.346a469.803 469.803 0 0 1 122.88-16.554c41.642.213 83.626 5.632 122.88 16.554 93.653-63.488 134.784-50.346 134.784-50.346 26.752 67.541 9.898 117.504 4.864 129.834 31.402 34.347 50.474 78.123 50.474 131.67 0 188.586-114.73 230.016-224.042 242.09 17.578 15.232 33.578 44.672 33.578 90.454v135.85c0 13.142 7.936 27.606 32.854 22.87C862.25 912.597 1002.667 728.747 1002.667 512c0-271.019-219.648-490.667-490.71-490.667z"></path></svg></a></div><div class="nav-item hide-in-mobile"><button type="button" class="outlook-button" tabindex="-1" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" class="icon outlook-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="outlook icon"><path d="M224 800c0 9.6 3.2 44.8 6.4 54.4 6.4 48-48 76.8-48 76.8s80 41.6 147.2 0 134.4-134.4 38.4-195.2c-22.4-12.8-41.6-19.2-57.6-19.2C259.2 716.8 227.2 761.6 224 800zM560 675.2l-32 51.2c-51.2 51.2-83.2 32-83.2 32 25.6 67.2 0 112-12.8 128 25.6 6.4 51.2 9.6 80 9.6 54.4 0 102.4-9.6 150.4-32l0 0c3.2 0 3.2-3.2 3.2-3.2 22.4-16 12.8-35.2 6.4-44.8-9.6-12.8-12.8-25.6-12.8-41.6 0-54.4 60.8-99.2 137.6-99.2 6.4 0 12.8 0 22.4 0 12.8 0 38.4 9.6 48-25.6 0-3.2 0-3.2 3.2-6.4 0-3.2 3.2-6.4 3.2-6.4 6.4-16 6.4-16 6.4-19.2 9.6-35.2 16-73.6 16-115.2 0-105.6-41.6-198.4-108.8-268.8C704 396.8 560 675.2 560 675.2zM224 419.2c0-28.8 22.4-51.2 51.2-51.2 28.8 0 51.2 22.4 51.2 51.2 0 28.8-22.4 51.2-51.2 51.2C246.4 470.4 224 448 224 419.2zM320 284.8c0-22.4 19.2-41.6 41.6-41.6 22.4 0 41.6 19.2 41.6 41.6 0 22.4-19.2 41.6-41.6 41.6C339.2 326.4 320 307.2 320 284.8zM457.6 208c0-12.8 12.8-25.6 25.6-25.6 12.8 0 25.6 12.8 25.6 25.6 0 12.8-12.8 25.6-25.6 25.6C470.4 233.6 457.6 220.8 457.6 208zM128 505.6C128 592 153.6 672 201.6 736c28.8-60.8 112-60.8 124.8-60.8-16-51.2 16-99.2 16-99.2l316.8-422.4c-48-19.2-99.2-32-150.4-32C297.6 118.4 128 291.2 128 505.6zM764.8 86.4c-22.4 19.2-390.4 518.4-390.4 518.4-22.4 28.8-12.8 76.8 22.4 99.2l9.6 6.4c35.2 22.4 80 12.8 99.2-25.6 0 0 6.4-12.8 9.6-19.2 54.4-105.6 275.2-524.8 288-553.6 6.4-19.2-3.2-32-19.2-32C777.6 76.8 771.2 80 764.8 86.4z"></path></svg><div class="outlook-dropdown"><!----></div></button></div><!--[--><button type="button" class="search-pro-button" aria-label="搜索"><svg xmlns="http://www.w3.org/2000/svg" class="icon search-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="search icon"><path d="M192 480a256 256 0 1 1 512 0 256 256 0 0 1-512 0m631.776 362.496-143.2-143.168A318.464 318.464 0 0 0 768 480c0-176.736-143.264-320-320-320S128 303.264 128 480s143.264 320 320 320a318.016 318.016 0 0 0 184.16-58.592l146.336 146.368c12.512 12.48 32.768 12.48 45.28 0 12.48-12.512 12.48-32.768 0-45.28"></path></svg><div class="search-pro-placeholder">搜索</div><div class="search-pro-key-hints"><kbd class="search-pro-key">Ctrl</kbd><kbd class="search-pro-key">K</kbd></div></button><!--]--><!--]--><!--[--><!----><!--]--><button type="button" class="vp-toggle-navbar-button" aria-label="Toggle Navbar" aria-expanded="false" aria-controls="nav-screen"><span><span class="vp-top"></span><span class="vp-middle"></span><span class="vp-bottom"></span></span></button></div></header><!----><!--]--><!----><div class="toggle-sidebar-wrapper"><span class="arrow start"></span></div><aside id="sidebar" class="vp-sidebar"><!--[--><!----><!--]--><ul class="vp-sidebar-links"><li><section class="vp-sidebar-group"><p class="vp-sidebar-header clickable active"><!----><a class="route-link nav-link active vp-sidebar-title" href="/DailyNotes/develop/" aria-label="开发技术"><!---->开发技术<!----></a><!----></p><ul class="vp-sidebar-links"><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">C 语言</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">C++笔记</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">Go</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">Java</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">Other</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">PHP</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">Python</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">Rust</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable active" type="button"><!----><span class="vp-sidebar-title">前端</span><span class="vp-arrow down"></span></button><ul class="vp-sidebar-links"><li><a class="route-link nav-link vp-sidebar-link vp-sidebar-page" href="/DailyNotes/develop/FrontEnd/" aria-label="前端"><!---->前端<!----></a></li><li><a class="route-link nav-link vp-sidebar-link vp-sidebar-page" href="/DailyNotes/develop/FrontEnd/React_Typescript_antd.html" aria-label="React Typescript antd"><!---->React Typescript antd<!----></a></li><li><a class="route-link nav-link vp-sidebar-link vp-sidebar-page" href="/DailyNotes/develop/FrontEnd/Vue.html" aria-label="Vue3"><!---->Vue3<!----></a></li><li><a class="route-link nav-link active vp-sidebar-link vp-sidebar-page active" href="/DailyNotes/develop/FrontEnd/JSModularity.html" aria-label="前端模块化"><!---->前端模块化<!----></a></li></ul></section></li></ul></section></li></ul><!--[--><!----><!--]--></aside><!--[--><main id="main-content" class="vp-page"><!--[--><!--[--><!----><!--]--><!----><nav class="vp-breadcrumb disable"></nav><div class="vp-page-title"><h1><!---->前端模块化</h1><div class="page-info"><span class="page-author-info" aria-label="作者🖊" data-balloon-pos="down"><svg xmlns="http://www.w3.org/2000/svg" class="icon author-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="author icon"><path d="M649.6 633.6c86.4-48 147.2-144 147.2-249.6 0-160-128-288-288-288s-288 128-288 288c0 108.8 57.6 201.6 147.2 249.6-121.6 48-214.4 153.6-240 288-3.2 9.6 0 19.2 6.4 25.6 3.2 9.6 12.8 12.8 22.4 12.8h704c9.6 0 19.2-3.2 25.6-12.8 6.4-6.4 9.6-16 6.4-25.6-25.6-134.4-121.6-240-243.2-288z"></path></svg><span><span class="page-author-item">echo0d</span></span><span property="author" content="echo0d"></span></span><!----><span class="page-date-info" aria-label="写作日期📅" data-balloon-pos="down"><svg xmlns="http://www.w3.org/2000/svg" class="icon calendar-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="calendar icon"><path d="M716.4 110.137c0-18.753-14.72-33.473-33.472-33.473-18.753 0-33.473 14.72-33.473 33.473v33.473h66.993v-33.473zm-334.87 0c0-18.753-14.72-33.473-33.473-33.473s-33.52 14.72-33.52 33.473v33.473h66.993v-33.473zm468.81 33.52H716.4v100.465c0 18.753-14.72 33.473-33.472 33.473a33.145 33.145 0 01-33.473-33.473V143.657H381.53v100.465c0 18.753-14.72 33.473-33.473 33.473a33.145 33.145 0 01-33.473-33.473V143.657H180.6A134.314 134.314 0 0046.66 277.595v535.756A134.314 134.314 0 00180.6 947.289h669.74a134.36 134.36 0 00133.94-133.938V277.595a134.314 134.314 0 00-133.94-133.938zm33.473 267.877H147.126a33.145 33.145 0 01-33.473-33.473c0-18.752 14.72-33.473 33.473-33.473h736.687c18.752 0 33.472 14.72 33.472 33.473a33.145 33.145 0 01-33.472 33.473z"></path></svg><span><!----></span><meta property="datePublished" content="2024-12-30T10:01:46.000Z"></span><!----><span class="page-reading-time-info" aria-label="阅读时间⌛" data-balloon-pos="down"><svg xmlns="http://www.w3.org/2000/svg" class="icon timer-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="timer icon"><path d="M799.387 122.15c4.402-2.978 7.38-7.897 7.38-13.463v-1.165c0-8.933-7.38-16.312-16.312-16.312H256.33c-8.933 0-16.311 7.38-16.311 16.312v1.165c0 5.825 2.977 10.874 7.637 13.592 4.143 194.44 97.22 354.963 220.201 392.763-122.204 37.542-214.893 196.511-220.2 389.397-4.661 5.049-7.638 11.651-7.638 19.03v5.825h566.49v-5.825c0-7.379-2.849-13.981-7.509-18.9-5.049-193.016-97.867-351.985-220.2-389.527 123.24-37.67 216.446-198.453 220.588-392.892zM531.16 450.445v352.632c117.674 1.553 211.787 40.778 211.787 88.676H304.097c0-48.286 95.149-87.382 213.728-88.676V450.445c-93.077-3.107-167.901-81.297-167.901-177.093 0-8.803 6.99-15.793 15.793-15.793 8.803 0 15.794 6.99 15.794 15.793 0 80.261 63.69 145.635 142.01 145.635s142.011-65.374 142.011-145.635c0-8.803 6.99-15.793 15.794-15.793s15.793 6.99 15.793 15.793c0 95.019-73.789 172.82-165.96 177.093z"></path></svg><span>大约 15 分钟</span><meta property="timeRequired" content="PT15M"></span><!----><!----></div><hr></div><div class="vp-toc-placeholder"><aside id="toc"><!--[--><!----><!--]--><div class="vp-toc-header">此页内容<button type="button" class="print-button" title="打印"><svg xmlns="http://www.w3.org/2000/svg" class="icon print-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="print icon"><path d="M819.2 364.8h-44.8V128c0-17.067-14.933-32-32-32H281.6c-17.067 0-32 14.933-32 32v236.8h-44.8C145.067 364.8 96 413.867 96 473.6v192c0 59.733 49.067 108.8 108.8 108.8h44.8V896c0 17.067 14.933 32 32 32h460.8c17.067 0 32-14.933 32-32V774.4h44.8c59.733 0 108.8-49.067 108.8-108.8v-192c0-59.733-49.067-108.8-108.8-108.8zM313.6 160h396.8v204.8H313.6V160zm396.8 704H313.6V620.8h396.8V864zM864 665.6c0 25.6-19.2 44.8-44.8 44.8h-44.8V588.8c0-17.067-14.933-32-32-32H281.6c-17.067 0-32 14.933-32 32v121.6h-44.8c-25.6 0-44.8-19.2-44.8-44.8v-192c0-25.6 19.2-44.8 44.8-44.8h614.4c25.6 0 44.8 19.2 44.8 44.8v192z"></path></svg></button><div class="arrow end"></div></div><div class="vp-toc-wrapper"><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#_1-模块化的理解">1. 模块化的理解</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_1-1-什么是模块化">1.1. 什么是模块化</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_1-2-模块化的演进">1.2. 模块化的演进</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_1-3-引入多个-script-后出现出现问题">1.3. 引入多个&lt;script&gt;后出现出现问题</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#_2-模块化规范">2. 模块化规范</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_2-1-commonjs-cjs">2.1. CommonJS（CJS）</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_2-2-amd-cmd">2.2. AMD/CMD</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_2-3-es6-module">2.3. ES6 module</a></li><!----><!--]--></ul></li><!--]--></ul><div class="vp-toc-marker" style="top:-1.7rem;"></div></div><!--[--><!----><!--]--></aside></div><!--[--><!----><!--]--><div class="theme-hope-content"><h1 id="前端模块化" tabindex="-1"><a class="header-anchor" href="#前端模块化"><span>前端模块化</span></a></h1><h2 id="_1-模块化的理解" tabindex="-1"><a class="header-anchor" href="#_1-模块化的理解"><span>1. 模块化的理解</span></a></h2><h3 id="_1-1-什么是模块化" tabindex="-1"><a class="header-anchor" href="#_1-1-什么是模块化"><span>1.1. 什么是模块化</span></a></h3><ul><li>将一个复杂的程序依据一定的规则(规范)封装成几个块(文件), 并进行组合在一起</li><li>块的内部数据与实现是私有的, 只是向外部暴露一些接口(方法)与外部其它模块通信</li><li>模块化开发的好处 <ul><li>避免命名冲突</li><li>更好地分离, 降低了耦合</li><li>提高代码的复用性</li><li>提高代码的可维护性</li></ul></li></ul><h3 id="_1-2-模块化的演进" tabindex="-1"><a class="header-anchor" href="#_1-2-模块化的演进"><span>1.2. 模块化的演进</span></a></h3><ul><li><p>全局函数模式</p><ul><li>将不同的功能封装成不同的全局函数</li><li>问题: 污染全局命名空间, 容易引起命名冲突，而且模块成员之间看不出直接关系</li></ul></li></ul><pre><code class="language-js"><span class="token keyword">function</span> <span class="token function">m1</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">//...</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">m2</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">//...</span>
<span class="token punctuation">}</span>
</code></pre><ul><li><p>namespace模式</p><ul><li>将不同的功能封装不同的对象中</li><li>作用：减少了全局变量，解决命名冲突</li><li>问题: 数据不安全(外部可以直接修改模块内部的数据)</li></ul></li></ul><pre><code class="language-js"><span class="token keyword">let</span> myModule <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">data</span><span class="token operator">:</span> <span class="token string">&#39;www.baidu.com&#39;</span><span class="token punctuation">,</span>
  <span class="token function">foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">foo() </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token keyword">this</span><span class="token punctuation">.</span>data<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token function">bar</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">bar() </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token keyword">this</span><span class="token punctuation">.</span>data<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
myModule<span class="token punctuation">.</span>data <span class="token operator">=</span> <span class="token string">&#39;other data&#39;</span> <span class="token comment">//能直接修改模块内部的数据</span>
myModule<span class="token punctuation">.</span><span class="token function">foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// foo() other data</span>
</code></pre><ul><li><p>IIFE模式</p><ul><li>使用立即执行函数表达式(IIFE)创建一个独立作用域</li><li>IIFE中封装不同的模块功能</li><li>问题: 模块成员之间看不出直接关系</li></ul></li></ul><pre><code class="language-html">// index.html文件
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>text/javascript<span class="token punctuation">&quot;</span></span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>module.js<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token script"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>text/javascript<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
    myModule<span class="token punctuation">.</span><span class="token function">foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    myModule<span class="token punctuation">.</span><span class="token function">bar</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>myModule<span class="token punctuation">.</span>data<span class="token punctuation">)</span> <span class="token comment">//undefined 不能访问模块内部数据</span>
    myModule<span class="token punctuation">.</span>data <span class="token operator">=</span> <span class="token string">&#39;xxxx&#39;</span> <span class="token comment">//不是修改的模块内部的data</span>
    myModule<span class="token punctuation">.</span><span class="token function">foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">//没有改变</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
</code></pre><pre><code class="language-js"><span class="token comment">// module.js</span>
<span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">window</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> data <span class="token operator">=</span> <span class="token string">&#39;www.baidu.com&#39;</span>
  <span class="token comment">//操作数据的函数</span>
  <span class="token keyword">function</span> <span class="token function">foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">//用于暴露函数</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">foo() </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>data<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">function</span> <span class="token function">bar</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">//用于暴露有函数</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">bar() </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>data<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span>
    <span class="token function">otherFun</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">//内部调用</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">function</span> <span class="token function">otherFun</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">//内部私有的函数</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;otherFun()&#39;</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
  <span class="token comment">//暴露模块</span>
  window<span class="token punctuation">.</span>myModule <span class="token operator">=</span> <span class="token punctuation">{</span> foo<span class="token punctuation">,</span> bar <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span>window<span class="token punctuation">)</span>
</code></pre><ul><li>IIFE模式增强</li></ul><p>这就是现代模块实现的基石</p><pre><code class="language-js"><span class="token comment">// module.js文件</span>
<span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">window<span class="token punctuation">,</span> $</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> data <span class="token operator">=</span> <span class="token string">&#39;www.baidu.com&#39;</span>
  <span class="token comment">//操作数据的函数</span>
  <span class="token keyword">function</span> <span class="token function">foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">//用于暴露有函数</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">foo() </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>data<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span>
    <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">&#39;body&#39;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">css</span><span class="token punctuation">(</span><span class="token string">&#39;background&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;red&#39;</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">function</span> <span class="token function">bar</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">//用于暴露有函数</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">bar() </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>data<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span>
    <span class="token function">otherFun</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">//内部调用</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">function</span> <span class="token function">otherFun</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">//内部私有的函数</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;otherFun()&#39;</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
  <span class="token comment">//暴露行为</span>
  window<span class="token punctuation">.</span>myModule <span class="token operator">=</span> <span class="token punctuation">{</span> foo<span class="token punctuation">,</span> bar <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span>window<span class="token punctuation">,</span> jQuery<span class="token punctuation">)</span>
</code></pre><pre><code class="language-html"> // index.html文件
  <span class="token comment">&lt;!-- 引入的js必须有一定顺序 --&gt;</span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>text/javascript<span class="token punctuation">&quot;</span></span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>jquery-1.10.1.js<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token script"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>text/javascript<span class="token punctuation">&quot;</span></span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>module.js<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token script"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>text/javascript<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
    myModule<span class="token punctuation">.</span><span class="token function">foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  </span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
</code></pre><p>上例子通过jquery方法将页面的背景颜色改成红色，所以必须先引入jQuery库，就把这个库当作参数传入。这样做除了保证模块的独立性，还使得模块之间的依赖关系变得明显。</p><h3 id="_1-3-引入多个-script-后出现出现问题" tabindex="-1"><a class="header-anchor" href="#_1-3-引入多个-script-后出现出现问题"><span>1.3. 引入多个<code>&lt;script&gt;</code>后出现出现问题</span></a></h3><ul><li><p>请求过多</p><p>首先我们要依赖多个模块，那样就会发送多个请求，导致请求过多</p></li><li><p>依赖模糊</p><p>我们不知道他们的具体依赖关系是什么，也就是说很容易因为不了解他们之间的依赖关系导致加载先后顺序出错。</p></li><li><p>难以维护</p><p>以上两种原因就导致了很难维护，很可能出现牵一发而动全身的情况导致项目出现严重的问题。 模块化固然有多个好处，然而一个页面需要引入多个js文件，就会出现以上这些问题。而这些问题可以通过模块化规范来解决，下面介绍开发中最流行的commonjs, AMD, ES6, CMD规范。</p></li></ul><h2 id="_2-模块化规范" tabindex="-1"><a class="header-anchor" href="#_2-模块化规范"><span>2. 模块化规范</span></a></h2><h3 id="_2-1-commonjs-cjs" tabindex="-1"><a class="header-anchor" href="#_2-1-commonjs-cjs"><span>2.1. CommonJS（CJS）</span></a></h3><ul><li><p><strong>概述</strong></p><p>Node 应用由模块组成，采用 CommonJS 模块规范。每个文件就是一个模块，有自己的作用域。在一个文件里面定义的变量、函数、类，都是私有的，对其他文件不可见。在服务器端，模块的加载是运行时同步加载的；在浏览器端，模块需要提前编译打包处理。</p></li><li><p><strong>特点</strong></p><ul><li>所有代码都运行在模块作用域，不会污染全局作用域。</li><li>模块可以多次加载，但是只会在第一次加载时运行一次，然后运行结果就被缓存了，以后再加载，就直接读取缓存结果。要想让模块再次运行，必须清除缓存。</li><li>模块加载的顺序，按照其在代码中出现的顺序。</li></ul></li><li><p><strong>基本语法</strong></p><ul><li>暴露模块：<code>module.exports = value</code> 或 <code>exports.xxx = value</code></li><li>引入模块：<code>require(xxx)</code>，如果是第三方模块，xxx为模块名；如果是自定义模块，xxx为模块文件路径</li></ul></li></ul><p>CommonJS规范规定，每个模块内部，module变量代表当前模块。这个变量是一个对象，它的exports属性（即module.exports）是对外的接口。加载某个模块，其实是加载该模块的module.exports属性。</p><pre><code class="language-js"><span class="token comment">// example.js</span>
<span class="token keyword">var</span> x <span class="token operator">=</span> <span class="token number">5</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> <span class="token function-variable function">addX</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">value</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> value <span class="token operator">+</span> x<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
module<span class="token punctuation">.</span>exports<span class="token punctuation">.</span>x <span class="token operator">=</span> x<span class="token punctuation">;</span>
module<span class="token punctuation">.</span>exports<span class="token punctuation">.</span>addX <span class="token operator">=</span> addX<span class="token punctuation">;</span>
</code></pre><p>上面代码通过module.exports输出两个方法：x和addX。其他文件加载这个模块，就可以使用这两个方法。加载该模块的写法如下。</p><pre><code class="language-js"><span class="token keyword">var</span> example <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;./example.js&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>example<span class="token punctuation">.</span>x<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 5</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>example<span class="token punctuation">.</span><span class="token function">addX</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 6</span>
</code></pre><p>require方法用于加载模块。</p><ul><li><strong>模块加载机制</strong></li></ul><p>CommonJS模块的加载机制是，输入的是被输出的值的拷贝。也就是说，一旦输出一个值，模块内部的变化就影响不到这个值。这点与ES6模块化有重大差异（下文会介绍），请看下面这个例子：</p><pre><code class="language-js"><span class="token comment">// lib.js</span>
<span class="token keyword">var</span> counter <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">;</span>
<span class="token keyword">function</span> <span class="token function">incCounter</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  counter<span class="token operator">++</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">counter</span><span class="token operator">:</span> counter<span class="token punctuation">,</span>
  <span class="token literal-property property">incCounter</span><span class="token operator">:</span> incCounter<span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre><p>上面代码输出内部变量counter和改写这个变量的内部方法incCounter。</p><pre><code class="language-js"><span class="token comment">// main.js</span>
<span class="token keyword">var</span> counter <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;./lib&#39;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>counter<span class="token punctuation">;</span>
<span class="token keyword">var</span> incCounter <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;./lib&#39;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>incCounter<span class="token punctuation">;</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>counter<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// 3</span>
<span class="token function">incCounter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>counter<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 3</span>
</code></pre><p>上面代码说明，counter输出以后，lib.js模块内部的变化就影响不到counter了。这是因为counter是一个原始类型的值，会被缓存。除非写成一个函数，才能得到内部变动后的值。</p><h4 id="module-exports和exports" tabindex="-1"><a class="header-anchor" href="#module-exports和exports"><span><code>module.exports</code>和<code>exports</code></span></a></h4><p>我们在看 node 代码时，应该会发现，关于接口导出，有的地方使用<code>module.exports</code>，而有的地方使用<code>exports</code>，这两个有什么区别呢?</p><p>CommonJS 规范仅定义了<code>exports</code>，但<code>exports</code>存在一些问题（下面会说到），所以<code>module.exports</code>被创造了出来，它被称为 CommonJS2 。 每一个文件都是一个模块，每个模块都有一个<code>module</code>对象，这个<code>module</code>对象的<code>exports</code>属性用来导出接口，外部模块导入当前模块时，使用的也是<code>module</code>对象，这些都是 node 基于 CommonJS2 规范做的处理。</p><pre><code class="language-javascript"><span class="token comment">// a.js</span>
<span class="token keyword">var</span> s <span class="token operator">=</span> <span class="token string">&#39;i am ronffy&#39;</span>
module<span class="token punctuation">.</span>exports <span class="token operator">=</span> s<span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>module<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><p>执行<code>node a.js</code>，看看打印的<code>module</code>对象：</p><pre><code class="language-javascript"><span class="token punctuation">{</span>
  <span class="token literal-property property">exports</span><span class="token operator">:</span> <span class="token string">&#39;i am ronffy&#39;</span><span class="token punctuation">,</span>
  <span class="token literal-property property">id</span><span class="token operator">:</span> <span class="token string">&#39;.&#39;</span><span class="token punctuation">,</span>                                <span class="token comment">// 模块id</span>
  <span class="token literal-property property">filename</span><span class="token operator">:</span> <span class="token string">&#39;/Users/apple/Desktop/a.js&#39;</span><span class="token punctuation">,</span>  <span class="token comment">// 文件路径名称</span>
  <span class="token literal-property property">loaded</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>                          <span class="token comment">// 模块是否加载完成</span>
  <span class="token literal-property property">parent</span><span class="token operator">:</span> <span class="token keyword">null</span><span class="token punctuation">,</span>                           <span class="token comment">// 父级模块</span>
  <span class="token literal-property property">children</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>                           <span class="token comment">// 子级模块</span>
  <span class="token literal-property property">paths</span><span class="token operator">:</span> <span class="token punctuation">[</span> <span class="token comment">/* ... */</span> <span class="token punctuation">]</span><span class="token punctuation">,</span>                   <span class="token comment">// 执行 node a.js 后 node 搜索模块的路径</span>
<span class="token punctuation">}</span>
</code></pre><p>其他模块导入该模块时：</p><pre><code class="language-javascript"><span class="token comment">// b.js</span>
<span class="token keyword">var</span> a <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;./a.js&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// a --&gt; i am ronffy</span>
</code></pre><p>当在 <code>a.js</code> 里这样写时：</p><pre><code class="language-javascript"><span class="token comment">// a.js</span>
<span class="token keyword">var</span> s <span class="token operator">=</span> <span class="token string">&#39;i am ronffy&#39;</span>
exports <span class="token operator">=</span> s<span class="token punctuation">;</span>
</code></pre><p><code>a.js</code> 模块的<code>module.exports</code>是一个空对象。``````</p><pre><code class="language-javascript"><span class="token comment">// b.js</span>
<span class="token keyword">var</span> a <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;./a.js&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// a --&gt; {}</span>
</code></pre><p>把<code>module.exports</code>和<code>exports</code>放到“明面”上来写，可能就更清楚了：</p><pre><code class="language-javascript"><span class="token keyword">var</span> module <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">exports</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">var</span> exports <span class="token operator">=</span> module<span class="token punctuation">.</span>exports<span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>module<span class="token punctuation">.</span>exports <span class="token operator">===</span> exports<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// true</span>

<span class="token keyword">var</span> s <span class="token operator">=</span> <span class="token string">&#39;i am ronffy&#39;</span>
exports <span class="token operator">=</span> s<span class="token punctuation">;</span> <span class="token comment">// module.exports 不受影响</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>module<span class="token punctuation">.</span>exports <span class="token operator">===</span> exports<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// false</span>
</code></pre><p>模块初始化时，<code>exports</code>和<code>module.exports</code>指向同一块内存，<code>exports</code>被重新赋值后，就切断了跟原内存地址的关系。</p><p>所以，<code>exports</code>要这样使用：</p><pre><code class="language-javascript"><span class="token comment">// a.js</span>
exports<span class="token punctuation">.</span>s <span class="token operator">=</span> <span class="token string">&#39;i am ronffy&#39;</span><span class="token punctuation">;</span>

<span class="token comment">// b.js</span>
<span class="token keyword">var</span> a <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;./a.js&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>a<span class="token punctuation">.</span>s<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// i am ronffy</span>
</code></pre><p>CommonJS 和 CommonJS2 经常被混淆概念，一般大家经常提到的 CommonJS 其实是指 CommonJS2，本文也是如此，不过不管怎样，大家知晓它们的区别和如何应用就好。</p><h3 id="_2-2-amd-cmd" tabindex="-1"><a class="header-anchor" href="#_2-2-amd-cmd"><span>2.2. AMD/CMD</span></a></h3><p>随着前端业务增重，代码越来越复杂，靠全局变量通信的方式开始捉襟见肘，前端急需一种更清晰、更简单的处理代码依赖的方式，将 JS 模块化的实现及规范陆续出现，其中被应用较广的模块规范有 AMD 和 CMD。</p><p>面对一种模块化方案，我们首先要了解的是：1. 如何导出接口；2. 如何导入接口。</p><h4 id="amd" tabindex="-1"><a class="header-anchor" href="#amd"><span>AMD</span></a></h4><p>异步模块定义规范（AMD）制定了定义模块的规则，这样模块和模块的依赖可以被异步加载。这和浏览器的异步加载模块的环境刚好适应（浏览器同步加载模块会导致性能、可用性、调试和跨域访问等问题）。 本规范只定义了一个函数define，它是全局变量。</p><pre><code class="language-js"><span class="token doc-comment comment">/**
 * <span class="token keyword">@param</span> <span class="token class-name"><span class="token punctuation">{</span>string<span class="token punctuation">}</span></span> <span class="token parameter">id</span> 模块名称
 * <span class="token keyword">@param</span> <span class="token class-name"><span class="token punctuation">{</span>string<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">}</span></span> <span class="token parameter">dependencies</span> 模块所依赖模块的数组
 * <span class="token keyword">@param</span> <span class="token class-name"><span class="token punctuation">{</span><span class="token keyword">function</span><span class="token punctuation">}</span></span> <span class="token parameter">factory</span> 模块初始化要执行的函数或对象
 * <span class="token keyword">@return</span> <span class="token class-name"><span class="token punctuation">{</span>any<span class="token punctuation">}</span></span> 模块导出的接口
 */</span>
<span class="token keyword">function</span> <span class="token function">define</span><span class="token punctuation">(</span><span class="token parameter">id<span class="token operator">?</span><span class="token punctuation">,</span> dependencies<span class="token operator">?</span><span class="token punctuation">,</span> factory</span><span class="token punctuation">)</span><span class="token operator">:</span> any
</code></pre><p><strong>RequireJS</strong></p><p>AMD 是一种异步模块规范，RequireJS 是 AMD 规范的实现。接下来，我们用 RequireJS 重构上面的项目。</p><p>在原项目 js 文件夹下增加 require.js 文件：</p><p><strong>项目目录:</strong></p><pre><code>├─ js                # js文件夹
│  ├─ ...
│  └─ require.js     # RequireJS 的 JS 库
└─  ...
</code></pre><pre><code class="language-js"><span class="token comment">// config.js</span>
<span class="token function">define</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> api <span class="token operator">=</span> <span class="token string">&#39;https://github.com&#39;</span><span class="token punctuation">;</span>
  <span class="token keyword">var</span> config <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">api</span><span class="token operator">:</span> api<span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> config<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><pre><code class="language-js"><span class="token comment">// utils.js</span>
<span class="token function">define</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">&#39;./config&#39;</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">config</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> utils <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token function">request</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>config<span class="token punctuation">.</span>api<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> utils<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><pre><code class="language-js"><span class="token comment">// main.js</span>
<span class="token function">require</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">&#39;./utils&#39;</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">utils</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  utils<span class="token punctuation">.</span><span class="token function">request</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><pre><code class="language-html"><span class="token comment">&lt;!-- index.html  --&gt;</span>
<span class="token comment">&lt;!-- ...省略其他 --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">&gt;</span></span>

  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">data-main</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>./js/main<span class="token punctuation">&quot;</span></span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>./js/require.js<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token script"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">&gt;</span></span>
</code></pre><p>可以看到，使用 RequireJS 后，每个文件都可以作为一个模块来管理，通信方式也是以模块的形式，这样既可以清晰的管理模块依赖，又可以避免声明全局变量。</p><p>特别说明：</p><p>先有 RequireJS，后有 AMD 规范，随着 RequireJS 的推广和普及，AMD 规范才被创建出来。</p><h4 id="cmd和amd" tabindex="-1"><a class="header-anchor" href="#cmd和amd"><span>CMD和AMD</span></a></h4><p>CMD 和 AMD 一样，都是 JS 的模块化规范，也主要应用于浏览器端。AMD 是 RequireJS 在的推广和普及过程中被创造出来。CMD 是 SeaJS 在的推广和普及过程中被创造出来。</p><p>二者的的主要区别是 CMD 推崇依赖就近，AMD 推崇依赖前置：</p><pre><code class="language-js"><span class="token comment">// AMD</span>
<span class="token comment">// 依赖必须一开始就写好</span>
<span class="token function">define</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">&#39;./utils&#39;</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">utils</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  utils<span class="token punctuation">.</span><span class="token function">request</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><pre><code class="language-js"><span class="token comment">// CMD</span>
<span class="token function">define</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">require</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// 依赖可以就近书写</span>
  <span class="token keyword">var</span> utils <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;./utils&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  utils<span class="token punctuation">.</span><span class="token function">request</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><p>AMD 也支持依赖就近，但 RequireJS 作者和官方文档都是优先推荐依赖前置写法。 考虑到目前主流项目中对 AMD 和 CMD 的使用越来越少，大家对 AMD 和 CMD 有大致的认识就好，此处不再过多赘述。</p><h4 id="commonjs与amd" tabindex="-1"><a class="header-anchor" href="#commonjs与amd"><span>CommonJS与AMD</span></a></h4><p>CommonJS 和 AMD 都是运行时加载，换言之：都是在运行时确定模块之间的依赖关系。</p><p>二者有何不同点：</p><ol><li>CommonJS 是服务器端模块规范，AMD 是浏览器端模块规范。</li><li>CommonJS 加载模块是同步的，即执行<code>var a = require(&#39;./a.js&#39;);</code>时，在 a.js 文件加载完成后，才执行后面的代码。AMD 加载模块是异步的，所有依赖加载完成后以回调函数的形式执行代码。</li><li>如下代码，<code>fs</code>和<code>chalk</code>都是模块，不同的是，<code>fs</code>是 node 内置模块，<code>chalk</code>是一个 npm 包。这两种情况在 CommonJS 中才有，AMD 不支持。</li></ol><pre><code class="language-javascript"><span class="token keyword">var</span> fs <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;fs&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> chalk <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;chalk&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><h3 id="_2-3-es6-module" tabindex="-1"><a class="header-anchor" href="#_2-3-es6-module"><span>2.3. ES6 module</span></a></h3><p>AMD 、 CMD 等都是在原有JS语法的基础上二次封装的一些方法来解决模块化的方案，ES6 module（在很多地方被简写为 ESM）是语言层面的规范，ES6 module 旨在为浏览器和服务器提供通用的模块解决方案。长远来看，未来无论是基于 JS 的 WEB 端，还是基于 node 的服务器端或桌面应用，模块规范都会统一使用 ES6 module。</p><h4 id="兼容性" tabindex="-1"><a class="header-anchor" href="#兼容性"><span>兼容性</span></a></h4><p>目前，无论是浏览器端还是 node ，都没有完全原生支持 ES6 module，如果使用 ES6 module ，可借助 <a href="https://link.segmentfault.com/?enc=eaZYMU7AZnrFASQuCCXHvw%3D%3D.x84T7b%2Fj6aCr1W1EestSDb5Y9EQGndvqWbhoIl8DADE%3D" target="_blank" rel="noopener noreferrer">babel<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a> 等编译器。本文只讨论 ES6 module 语法，故不对 babel 或 typescript 等可编译 ES6 的方式展开讨论。</p><h4 id="导出接口" tabindex="-1"><a class="header-anchor" href="#导出接口"><span>导出接口</span></a></h4><p>CommonJS 中顶层作用域不是全局作用域，同样的，ES6 module 中，一个文件就是一个模块，文件的顶层作用域也不是全局作用域。导出接口使用<code>export</code>关键字，导入接口使用<code>import</code>关键字。</p><p><code>export</code>导出接口有以下方式：</p><p><strong>方式1</strong></p><pre><code class="language-javascript"><span class="token keyword">export</span> <span class="token keyword">const</span> prefix <span class="token operator">=</span> <span class="token string">&#39;https://github.com&#39;</span><span class="token punctuation">;</span>
<span class="token keyword">export</span> <span class="token keyword">const</span> api <span class="token operator">=</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>prefix<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">/ronffy</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span>
</code></pre><p><strong>方式2</strong></p><pre><code class="language-javascript"><span class="token keyword">const</span> prefix <span class="token operator">=</span> <span class="token string">&#39;https://github.com&#39;</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> api <span class="token operator">=</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>prefix<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">/ronffy</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span>
<span class="token keyword">export</span> <span class="token punctuation">{</span>
  prefix<span class="token punctuation">,</span>
  api<span class="token punctuation">,</span>
<span class="token punctuation">}</span>
</code></pre><p>方式1和方式2只是写法不同，结果是一样的，都是把<code>prefix</code>和<code>api</code>分别导出。</p><p><strong>方式3（默认导出）</strong></p><pre><code class="language-javascript"><span class="token comment">// foo.js</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">function</span> <span class="token function">foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>

<span class="token comment">// 等同于：</span>
<span class="token keyword">function</span> <span class="token function">foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token keyword">export</span> <span class="token punctuation">{</span>
  foo <span class="token keyword">as</span> <span class="token keyword">default</span>
<span class="token punctuation">}</span>
</code></pre><p><code>export default</code>用来导出模块默认的接口，它等同于导出一个名为<code>default</code>的接口。配合<code>export</code>使用的<code>as</code>关键字用来在导出接口时为接口重命名。</p><p><strong>方式4（先导入再导出简写）</strong></p><pre><code class="language-javascript"><span class="token keyword">export</span> <span class="token punctuation">{</span> api <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;./config.js&#39;</span><span class="token punctuation">;</span>

<span class="token comment">// 等同于：</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> api <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;./config.js&#39;</span><span class="token punctuation">;</span>
<span class="token keyword">export</span> <span class="token punctuation">{</span>
  api
<span class="token punctuation">}</span>
</code></pre><p>如果需要在一个模块中先导入一个接口，再导出，可以使用<code>export ... from &#39;module&#39;</code>这样的简便写法。</p><h4 id="导入模块接口" tabindex="-1"><a class="header-anchor" href="#导入模块接口"><span>导入模块接口</span></a></h4><p>ES6 module 使用<code>import</code>导入模块接口。</p><p>导出接口的模块代码1：</p><pre><code class="language-javascript"><span class="token comment">// config.js</span>
<span class="token keyword">const</span> prefix <span class="token operator">=</span> <span class="token string">&#39;https://github.com&#39;</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> api <span class="token operator">=</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>prefix<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">/ronffy</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span>
<span class="token keyword">export</span> <span class="token punctuation">{</span>
  prefix<span class="token punctuation">,</span>
  api<span class="token punctuation">,</span>
<span class="token punctuation">}</span>
</code></pre><p>接口已经导出，如何导入呢：</p><p><strong>方式1</strong></p><pre><code class="language-javascript"><span class="token keyword">import</span> <span class="token punctuation">{</span> api <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;./config.js&#39;</span><span class="token punctuation">;</span>

<span class="token comment">// or</span>
<span class="token comment">// 配合`import`使用的`as`关键字用来为导入的接口重命名。</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> api <span class="token keyword">as</span> myApi <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;./config.js&#39;</span><span class="token punctuation">;</span>
</code></pre><p><strong>方式2（整体导入）</strong></p><pre><code class="language-javascript"><span class="token keyword">import</span> <span class="token operator">*</span> <span class="token keyword">as</span> config <span class="token keyword">from</span> <span class="token string">&#39;./config.js&#39;</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> api <span class="token operator">=</span> config<span class="token punctuation">.</span>api<span class="token punctuation">;</span>
</code></pre><p>将 config.js 模块导出的所有接口都挂载在<code>config</code>对象上。</p><p><strong>方式3（默认导出的导入）</strong></p><pre><code class="language-javascript"><span class="token comment">// foo.js</span>
<span class="token keyword">export</span> <span class="token keyword">const</span> conut <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">function</span> <span class="token function">myFoo</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token comment">// index.js</span>
<span class="token comment">// 默认导入的接口此处刻意命名为cusFoo，旨在说明该命名可完全自定义。</span>
<span class="token keyword">import</span> cusFoo<span class="token punctuation">,</span> <span class="token punctuation">{</span> count <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;./foo.js&#39;</span><span class="token punctuation">;</span>

<span class="token comment">// 等同于：</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> <span class="token keyword">default</span> <span class="token keyword">as</span> cusFoo<span class="token punctuation">,</span> count <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;./foo.js&#39;</span><span class="token punctuation">;</span>
</code></pre><p><code>export default</code>导出的接口，可以使用<code>import name from &#39;module&#39;</code>导入。这种方式，使导入默认接口很便捷。</p><p><strong>方式4（整体加载）</strong></p><pre><code class="language-javascript"><span class="token keyword">import</span> <span class="token string">&#39;./config.js&#39;</span><span class="token punctuation">;</span>
</code></pre><p>这样会加载整个 <code>config.js</code> 模块，但未导入该模块的任何接口。</p><p><strong>方式5（动态加载模块）</strong></p><p>上面介绍了 ES6 module 各种导入接口的方式，但有一种场景未被涵盖：动态加载模块。比如用户点击某个按钮后才弹出弹窗，弹窗里功能涉及的模块的代码量比较重，所以这些相关模块如果在页面初始化时就加载，实在浪费资源，<code>import()</code>可以解决这个问题，从语言层面实现模块代码的按需加载。</p><p>ES6 module 在处理以上几种导入模块接口的方式时都是编译时处理，所以<code>import</code>和<code>export</code>命令只能用在模块的顶层，以下方式都会报错：</p><pre><code class="language-javascript"><span class="token comment">// 报错</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token comment">/* ... */</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">import</span> <span class="token punctuation">{</span> api <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;./config.js&#39;</span><span class="token punctuation">;</span> 
<span class="token punctuation">}</span>

<span class="token comment">// 报错</span>
<span class="token keyword">function</span> <span class="token function">foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">import</span> <span class="token punctuation">{</span> api <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;./config.js&#39;</span><span class="token punctuation">;</span> 
<span class="token punctuation">}</span>

<span class="token comment">// 报错</span>
<span class="token keyword">const</span> modulePath <span class="token operator">=</span> <span class="token string">&#39;./utils&#39;</span> <span class="token operator">+</span> <span class="token string">&#39;/api.js&#39;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> modulePath<span class="token punctuation">;</span>
</code></pre><p>使用<code>import()</code>实现按需加载：</p><pre><code class="language-javascript"><span class="token keyword">function</span> <span class="token function">foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">import</span><span class="token punctuation">(</span><span class="token string">&#39;./config.js&#39;</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> api <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>

    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">const</span> modulePath <span class="token operator">=</span> <span class="token string">&#39;./utils&#39;</span> <span class="token operator">+</span> <span class="token string">&#39;/api.js&#39;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span><span class="token punctuation">(</span>modulePath<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><p>特别说明： 该功能的提议目前处于 TC39 流程的第4阶段。更多说明，请查看<a href="https://link.segmentfault.com/?enc=wGjhpbdtDzGcnObVZRlTOw%3D%3D.nyyE44PVOuqeGs%2FHlUso2cD0p4S867dRCs84HrmIfZ6uppGQqNvy%2FK%2Fq%2FahgI45T" target="_blank" rel="noopener noreferrer">TC39/proposal-dynamic-import<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>。</p><h4 id="commonjs-和-es6-module" tabindex="-1"><a class="header-anchor" href="#commonjs-和-es6-module"><span>CommonJS 和 ES6 module</span></a></h4><p>CommonJS 和 AMD 是运行时加载，在运行时确定模块的依赖关系。 ES6 module 是在编译时（<code>import()</code>是运行时加载）处理模块依赖关系，。</p><p><strong>CommonJS</strong></p><p>CommonJS 在导入模块时，会加载该模块，所谓“CommonJS 是运行时加载”，正因代码在运行完成后生成<code>module.exports</code>的缘故。当然，CommonJS 对模块做了缓存处理，某个模块即使被多次多处导入，也只加载一次。</p><pre><code>// o.js
let num = 0;
function getNum() {
  return num;
}
function setNum(n) {
  num = n;
}
console.log(&#39;o init&#39;);
module.exports = {
  num,
  getNum,
  setNum,
}
</code></pre><pre><code>// a.js
const o = require(&#39;./o.js&#39;);
o.setNum(1);
</code></pre><pre><code>// b.js
const o = require(&#39;./o.js&#39;);
// 注意：此处只是演示，项目里不要这样修改模块
o.num = 2;
</code></pre><pre><code>// main.js
const o = require(&#39;./o.js&#39;);

require(&#39;./a.js&#39;);
console.log(&#39;a o.num:&#39;, o.num);

require(&#39;./b.js&#39;);
console.log(&#39;b o.num:&#39;, o.num);
console.log(&#39;b o.getNum:&#39;, o.getNum());
</code></pre><p>命令行执行<code>node main.js</code>，打印结果如下：</p><ol><li><code>o init</code><em>模块即使被其他多个模块导入，也只会加载一次，并且在代码运行完成后将接口赋值到<code>module.exports</code>属性上。</em></li><li><code>a o.num: 0</code><em>模块在加载完成后，模块内部的变量变化不会反应到模块的<code>module.exports</code>。</em></li><li><code>b o.num: 2</code><em>对导入模块的直接修改会反应到该模块的<code>module.exports</code>。</em></li><li><code>b o.getNum: 1</code><em>模块在加载完成后即形成一个闭包。</em></li></ol><p><strong>ES6 module</strong></p><pre><code>// o.js
let num = 0;
function getNum() {
  return num;
}
function setNum(n) {
  num = n;
}
console.log(&#39;o init&#39;);
export {
  num,
  getNum,
  setNum,
}
</code></pre><pre><code>// main.js
import { num, getNum, setNum } from &#39;./o.js&#39;;

console.log(&#39;o.num:&#39;, num);
setNum(1);

console.log(&#39;o.num:&#39;, num);
console.log(&#39;o.getNum:&#39;, getNum());
</code></pre><p>我们增加一个 index.js 用于在 node 端支持 ES6 module：</p><pre><code>// index.js
require(&quot;@babel/register&quot;)({
  presets: [&quot;@babel/preset-env&quot;]
});

module.exports = require(&#39;./main.js&#39;)
</code></pre><p>命令行执行<code>npm install @babel/core @babel/register @babel/preset-env -D</code>安装 ES6 相关 npm 包。</p><p>命令行执行<code>node index.js</code>，打印结果如下：</p><ol><li><code>o init</code><em>模块即使被其他多个模块导入，也只会加载一次。</em></li><li><code>o.num: 0</code></li><li><code>o.num: 1</code><em>编译时确定模块依赖的 ES6 module，通过<code>import</code>导入的接口只是值的引用，所以<code>num</code>才会有两次不同打印结果。</em></li><li><code>o.getNum: 1</code></li></ol><p>对于打印结果3，知晓其结果，在项目中注意这一点就好。这块会涉及到“Module Records（模块记录）”、“module instance（模快实例）” “linking（链接）”等诸多概念和原理，大家可查看<a href="https://hacks.mozilla.org/2018/03/es-modules-a-cartoon-deep-dive/" target="_blank" rel="noopener noreferrer">ES modules: A cartoon deep-dive<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>进行深入的研究，本文不再展开。</p><p>ES6 module 是编译时加载（或叫做“静态加载”），利用这一点，可以对代码做很多之前无法完成的优化：</p><ol><li>在开发阶段就可以做导入和导出模块相关的代码检查。</li><li>结合 Webpack、Babel 等工具可以在打包阶段移除上下文中未引用的代码（dead-code），这种技术被称作“tree shaking”，可以极大的减小代码体积、缩短程序运行时间、提升程序性能。</li></ol></div><!--[--><!----><!--]--><footer class="page-meta"><div class="meta-item edit-link"><a href="https://github.com/echo0d/DailyNotes/edit/main/src/develop/FrontEnd/JSModularity.md" rel="noopener noreferrer" target="_blank" aria-label="在 GitHub 上编辑此页" class="nav-link label"><!--[--><svg xmlns="http://www.w3.org/2000/svg" class="icon edit-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="edit icon"><path d="M430.818 653.65a60.46 60.46 0 0 1-50.96-93.281l71.69-114.012 7.773-10.365L816.038 80.138A60.46 60.46 0 0 1 859.225 62a60.46 60.46 0 0 1 43.186 18.138l43.186 43.186a60.46 60.46 0 0 1 0 86.373L588.879 565.55l-8.637 8.637-117.466 68.234a60.46 60.46 0 0 1-31.958 11.229z"></path><path d="M728.802 962H252.891A190.883 190.883 0 0 1 62.008 771.98V296.934a190.883 190.883 0 0 1 190.883-192.61h267.754a60.46 60.46 0 0 1 0 120.92H252.891a69.962 69.962 0 0 0-69.098 69.099V771.98a69.962 69.962 0 0 0 69.098 69.098h475.911A69.962 69.962 0 0 0 797.9 771.98V503.363a60.46 60.46 0 1 1 120.922 0V771.98A190.883 190.883 0 0 1 728.802 962z"></path></svg><!--]-->在 GitHub 上编辑此页<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!----></a></div><div class="meta-item git-info"><div class="update-time"><span class="label">上次编辑于: </span><!----></div><div class="contributors"><span class="label">贡献者: </span><!--[--><!--[--><span class="contributor" title="email: echo0d@163.com">echo0d</span><!--]--><!--]--></div></div></footer><nav class="vp-page-nav"><a class="route-link nav-link prev" href="/DailyNotes/develop/FrontEnd/Vue.html" aria-label="Vue3"><div class="hint"><span class="arrow start"></span>上一页</div><div class="link"><!---->Vue3</div></a><!----></nav><!----><!--[--><!----><!--]--><!--]--></main><!--]--><footer class="vp-footer-wrapper"><div class="vp-footer">听君一席话，如听一席话</div><div class="vp-copyright">Copyright © 2025 echo0d </div></footer></div><!--]--><!--[--><!----><!----><!--]--><!--]--></div>
    <script type="module" src="/DailyNotes/assets/app-C5cR4qpO.js" defer></script>
  </body>
</html>
