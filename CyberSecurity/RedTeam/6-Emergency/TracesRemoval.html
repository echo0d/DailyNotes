<!doctype html>
<html lang="zh-CN" data-theme="light">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <meta name="generator" content="VuePress 2.0.0-rc.18" />
    <meta name="theme" content="VuePress Theme Hope 2.0.0-rc.27" />
    <style>
      html {
        background: var(--bg-color, #fff);
      }

      html[data-theme="dark"] {
        background: var(--bg-color, #1d1e1f);
      }

      body {
        background: var(--bg-color);
      }
    </style>
    <script>
      const userMode = localStorage.getItem("vuepress-theme-hope-scheme");
      const systemDarkMode =
        window.matchMedia &&
        window.matchMedia("(prefers-color-scheme: dark)").matches;

      if (userMode === "dark" || (userMode !== "light" && systemDarkMode)) {
        document.documentElement.setAttribute("data-theme", "dark");
      }
    </script>
    <meta property="og:url" content="https://echo0d.github.io/DailyNotes/CyberSecurity/RedTeam/6-Emergency/TracesRemoval.html"><meta property="og:site_name" content="echo0d-notes"><meta property="og:title" content="痕迹清理"><meta property="og:description" content="痕迹清理 痕迹清理，是清理渗透过程中在目标机器上留下的所有操作痕迹。其主要目的是：避免溯源、隐藏攻击方法。总结了痕迹清理的一些方式。 1. 引言 痕迹清理，是清理渗透过程中在目标机器上留下的所有操作痕迹。其主要目的是：避免溯源、隐藏攻击方法。 需要注意的是： 痕迹清理这个动作本身也会产生痕迹，所以不存在完美的痕迹清理。 如果目标已经配置，第三方的日志记..."><meta property="og:type" content="article"><meta property="og:locale" content="zh-CN"><meta property="og:updated_time" content="2025-06-04T09:27:16.000Z"><meta property="article:author" content="echo0d"><meta property="article:tag" content="应急"><meta property="article:modified_time" content="2025-06-04T09:27:16.000Z"><script type="application/ld+json">{"@context":"https://schema.org","@type":"Article","headline":"痕迹清理","image":[""],"dateModified":"2025-06-04T09:27:16.000Z","author":[{"@type":"Person","name":"echo0d","url":""}]}</script><link rel="alternate" type="application/atom+xml" href="https://echo0d.github.io/DailyNotes/atom.xml" title="echo0d-notes Atom Feed"><link rel="alternate" type="application/json" href="https://echo0d.github.io/DailyNotes/feed.json" title="echo0d-notes JSON Feed"><link rel="alternate" type="application/rss+xml" href="https://echo0d.github.io/DailyNotes/rss.xml" title="echo0d-notes RSS Feed"><title>痕迹清理 | echo0d-notes</title><meta name="description" content="痕迹清理 痕迹清理，是清理渗透过程中在目标机器上留下的所有操作痕迹。其主要目的是：避免溯源、隐藏攻击方法。总结了痕迹清理的一些方式。 1. 引言 痕迹清理，是清理渗透过程中在目标机器上留下的所有操作痕迹。其主要目的是：避免溯源、隐藏攻击方法。 需要注意的是： 痕迹清理这个动作本身也会产生痕迹，所以不存在完美的痕迹清理。 如果目标已经配置，第三方的日志记...">
    <link rel="preload" href="/DailyNotes/assets/style-DJCBT2HN.css" as="style"><link rel="stylesheet" href="/DailyNotes/assets/style-DJCBT2HN.css">
    <link rel="modulepreload" href="/DailyNotes/assets/app-ClR9AqGF.js"><link rel="modulepreload" href="/DailyNotes/assets/TracesRemoval.html-CklvlMtB.js"><link rel="modulepreload" href="/DailyNotes/assets/plugin-vue_export-helper-DlAUqK2U.js">
    <link rel="prefetch" href="/DailyNotes/assets/index.html-B-FP9lOO.js" as="script"><link rel="prefetch" href="/DailyNotes/assets/flow-eda功能节点.html-D3rTYcnX.js" as="script"><link rel="prefetch" href="/DailyNotes/assets/index.html-DfKBg2By.js" as="script"><link rel="prefetch" href="/DailyNotes/assets/DailyDev.html-Bj5V1hns.js" as="script"><link rel="prefetch" href="/DailyNotes/assets/DailySkills.html-BBGfj4l9.js" as="script"><link rel="prefetch" href="/DailyNotes/assets/Treasure.html-B7-e8iAK.js" as="script"><link rel="prefetch" href="/DailyNotes/assets/1-FileSystem.html-Zc-540IR.js" as="script"><link rel="prefetch" href="/DailyNotes/assets/2-commandExecute.html-CCenXj9z.js" as="script"><link rel="prefetch" href="/DailyNotes/assets/3-Database.html-yTZiiIyx.js" as="script"><link rel="prefetch" href="/DailyNotes/assets/4-JNDI.html-CysaTQfw.js" as="script"><link rel="prefetch" href="/DailyNotes/assets/5-reflection.html-Ddzobcgg.js" as="script"><link rel="prefetch" href="/DailyNotes/assets/6-ClassLoader.html-arKy2UPv.js" as="script"><link rel="prefetch" href="/DailyNotes/assets/7-DynamicProxy.html-BRfWJQC9.js" as="script"><link rel="prefetch" href="/DailyNotes/assets/1-JavaEE.html-U_d5rd9n.js" as="script"><link rel="prefetch" href="/DailyNotes/assets/2-JavaMVC.html-CK6k37K5.js" as="script"><link rel="prefetch" href="/DailyNotes/assets/3-JavaWeb_Servlet.html-BqIYgVLX.js" as="script"><link rel="prefetch" href="/DailyNotes/assets/4-JavaWeb_filter.html-CKKTVrj9.js" as="script"><link rel="prefetch" href="/DailyNotes/assets/5-JavaWeb_Listener.html-DYLUUneH.js" as="script"><link rel="prefetch" href="/DailyNotes/assets/6-CookieAndSession.html-D9dzzj7-.js" as="script"><link rel="prefetch" href="/DailyNotes/assets/7-JSP.html-9eV20Bqr.js" as="script"><link rel="prefetch" href="/DailyNotes/assets/CTFDeserBug.html-Db3-e_NA.js" as="script"><link rel="prefetch" href="/DailyNotes/assets/JavaVul.html-Bp209147.js" as="script"><link rel="prefetch" href="/DailyNotes/assets/deserialize.html-Sac8GBoR.js" as="script"><link rel="prefetch" href="/DailyNotes/assets/GoVul.html-DD7t9esG.js" as="script"><link rel="prefetch" href="/DailyNotes/assets/1-PHPBase.html-DLTIkL_f.js" as="script"><link rel="prefetch" href="/DailyNotes/assets/1-CTF_WEB.html-D-QLf7MP.js" as="script"><link rel="prefetch" href="/DailyNotes/assets/index.html-DYl8CS5g.js" as="script"><link rel="prefetch" href="/DailyNotes/assets/ExecuteAssembly.html-CZDb6mzW.js" as="script"><link rel="prefetch" href="/DailyNotes/assets/ProcessInjection.html-DNRiU3YD.js" as="script"><link rel="prefetch" href="/DailyNotes/assets/RDI.html-BTDesfMs.js" as="script"><link rel="prefetch" href="/DailyNotes/assets/index.html-BtvsdZ_K.js" as="script"><link rel="prefetch" href="/DailyNotes/assets/WindowsArchitectureProcess.html-CnRXws4Z.js" as="script"><link rel="prefetch" href="/DailyNotes/assets/index.html-9p5q8w5l.js" as="script"><link rel="prefetch" href="/DailyNotes/assets/CodeObfuscation.html-SmzPH2Fz.js" as="script"><link rel="prefetch" href="/DailyNotes/assets/JavaVulnReverse.html-DkfgDi8s.js" as="script"><link rel="prefetch" href="/DailyNotes/assets/SrcNote.html-DwXVP7fD.js" as="script"><link rel="prefetch" href="/DailyNotes/assets/10_memory.html-Dso7ma-q.js" as="script"><link rel="prefetch" href="/DailyNotes/assets/11_preprocessor.html-DKm3EHr_.js" as="script"><link rel="prefetch" href="/DailyNotes/assets/12_IO.html-k0JGrIdo.js" as="script"><link rel="prefetch" href="/DailyNotes/assets/13_file.html-DUmFfX0Y.js" as="script"><link rel="prefetch" href="/DailyNotes/assets/14_specifier.html-De62SIR2.js" as="script"><link rel="prefetch" href="/DailyNotes/assets/15_multifile.html-BA5tdRyv.js" as="script"><link rel="prefetch" href="/DailyNotes/assets/16_cli.html-DkHnhIL7.js" as="script"><link rel="prefetch" href="/DailyNotes/assets/17_multibyte.html-DX0QWsBY.js" as="script"><link rel="prefetch" href="/DailyNotes/assets/1_syntax.html-D9tLO7mS.js" as="script"><link rel="prefetch" href="/DailyNotes/assets/2_VariableTypes.html-Cfu0gQ9H.js" as="script"><link rel="prefetch" href="/DailyNotes/assets/3_Operator.html-CNLEqWGo.js" as="script"><link rel="prefetch" href="/DailyNotes/assets/4_flow-control.html-CquqVp6U.js" as="script"><link rel="prefetch" href="/DailyNotes/assets/5_pointer.html-DvXrWhtO.js" as="script"><link rel="prefetch" href="/DailyNotes/assets/6_function.html-wurYofoV.js" as="script"><link rel="prefetch" href="/DailyNotes/assets/7_array.html-CbpvFcr7.js" as="script"><link rel="prefetch" href="/DailyNotes/assets/8_string.html-fuL2CFbf.js" as="script"><link rel="prefetch" href="/DailyNotes/assets/9_otherType.html-AJV8ag3I.js" as="script"><link rel="prefetch" href="/DailyNotes/assets/index.html-C3M6LB6o.js" as="script"><link rel="prefetch" href="/DailyNotes/assets/1_Externsion.html-CDN9567X.js" as="script"><link rel="prefetch" href="/DailyNotes/assets/2_Encapsulation.html-C2vqr48N.js" as="script"><link rel="prefetch" href="/DailyNotes/assets/3_Class_object.html-CSx-E9wq.js" as="script"><link rel="prefetch" href="/DailyNotes/assets/4_Inheritance.html-DnwSdluC.js" as="script"><link rel="prefetch" href="/DailyNotes/assets/5_overloading.html-B54paCic.js" as="script"><link rel="prefetch" href="/DailyNotes/assets/6_polymorphism.html-6GwGL_Mk.js" as="script"><link rel="prefetch" href="/DailyNotes/assets/index.html-CTplsiy7.js" as="script"><link rel="prefetch" href="/DailyNotes/assets/JSModularity.html-Tf_LBGTP.js" as="script"><link rel="prefetch" href="/DailyNotes/assets/index.html-BouYpU0h.js" as="script"><link rel="prefetch" href="/DailyNotes/assets/React_Typescript_antd.html-Bl4r6txS.js" as="script"><link rel="prefetch" href="/DailyNotes/assets/Vue.html-CY3-KmMr.js" as="script"><link rel="prefetch" href="/DailyNotes/assets/1_JavaBase.html-BmiPLghl.js" as="script"><link rel="prefetch" href="/DailyNotes/assets/2_ObjectOriented.html-wgZkvu1s.js" as="script"><link rel="prefetch" href="/DailyNotes/assets/3_CoreClass.html-DG0Oxpo2.js" as="script"><link rel="prefetch" href="/DailyNotes/assets/4_Exception.html-8hIil1tp.js" as="script"><link rel="prefetch" href="/DailyNotes/assets/5_Reflection.html-BIxtIOUK.js" as="script"><link rel="prefetch" href="/DailyNotes/assets/6_Annotation.html-DBLLdemN.js" as="script"><link rel="prefetch" href="/DailyNotes/assets/7_Genericity.html-DrzxszqT.js" as="script"><link rel="prefetch" href="/DailyNotes/assets/8_Native.html-CVSyFCWq.js" as="script"><link rel="prefetch" href="/DailyNotes/assets/9_Hook.html-DoPdgLYo.js" as="script"><link rel="prefetch" href="/DailyNotes/assets/index.html-D0c24_NF.js" as="script"><link rel="prefetch" href="/DailyNotes/assets/test_django.html-0Rc1eQPf.js" as="script"><link rel="prefetch" href="/DailyNotes/assets/index.html-DJ8gecC6.js" as="script"><link rel="prefetch" href="/DailyNotes/assets/anti-debug.html-B71I7Px_.js" as="script"><link rel="prefetch" href="/DailyNotes/assets/index.html-DMcEe7OG.js" as="script"><link rel="prefetch" href="/DailyNotes/assets/1_InformationGathering.html-43IJ045C.js" as="script"><link rel="prefetch" href="/DailyNotes/assets/2_Intranet_windows.html-D_-wq-sv.js" as="script"><link rel="prefetch" href="/DailyNotes/assets/3_CDN.html-DjcgHF--.js" as="script"><link rel="prefetch" href="/DailyNotes/assets/1_LinuxPersistence.html-sNyb4ePt.js" as="script"><link rel="prefetch" href="/DailyNotes/assets/2_WindowsPersistence.html-It3CBGrk.js" as="script"><link rel="prefetch" href="/DailyNotes/assets/1_Linux.html-CvTt4-RO.js" as="script"><link rel="prefetch" href="/DailyNotes/assets/2_Windows.html-BAJ0T9yQ.js" as="script"><link rel="prefetch" href="/DailyNotes/assets/Intranet_tunnel.html-C6w8Kldd.js" as="script"><link rel="prefetch" href="/DailyNotes/assets/Tamper.html-ba_DN3_U.js" as="script"><link rel="prefetch" href="/DailyNotes/assets/Burpsuite.html-CFvF66Yw.js" as="script"><link rel="prefetch" href="/DailyNotes/assets/SQLmap.html-Ba5JrCAL.js" as="script"><link rel="prefetch" href="/DailyNotes/assets/Tunnel.html-Ca8mf-lW.js" as="script"><link rel="prefetch" href="/DailyNotes/assets/WebShell.html-wLN9AjDG.js" as="script"><link rel="prefetch" href="/DailyNotes/assets/openwrt.html-t7IaVvB6.js" as="script"><link rel="prefetch" href="/DailyNotes/assets/1_GoFinal.html-C3i5Akg2.js" as="script"><link rel="prefetch" href="/DailyNotes/assets/2_fscanPro.html-DEnZ8qUx.js" as="script"><link rel="prefetch" href="/DailyNotes/assets/index.html-Bq4gQ3Ez.js" as="script"><link rel="prefetch" href="/DailyNotes/assets/index.html-AFplx4oD.js" as="script"><link rel="prefetch" href="/DailyNotes/assets/ch1.html-ZMXTLMmv.js" as="script"><link rel="prefetch" href="/DailyNotes/assets/ch10.html-DwgvIvGW.js" as="script"><link rel="prefetch" href="/DailyNotes/assets/ch11.html-DhWziQ6f.js" as="script"><link rel="prefetch" href="/DailyNotes/assets/ch12.html-CrLfSWx1.js" as="script"><link rel="prefetch" href="/DailyNotes/assets/ch2.html-cbrd4qMY.js" as="script"><link rel="prefetch" href="/DailyNotes/assets/ch3.html-jZOhVnri.js" as="script"><link rel="prefetch" href="/DailyNotes/assets/ch4.html-BRKjzz8P.js" as="script"><link rel="prefetch" href="/DailyNotes/assets/ch5.html-D3wVYBcf.js" as="script"><link rel="prefetch" href="/DailyNotes/assets/ch6.html-BtIAQSJq.js" as="script"><link rel="prefetch" href="/DailyNotes/assets/ch7.html-DTgoa7bc.js" as="script"><link rel="prefetch" href="/DailyNotes/assets/node_CVE-2017-14849.html-CD2Sc_x0.js" as="script"><link rel="prefetch" href="/DailyNotes/assets/tomcat_CVE-2017-12615.html-B8du9rdn.js" as="script"><link rel="prefetch" href="/DailyNotes/assets/tomcat_CVE-2020-1938.html-CFlZude8.js" as="script"><link rel="prefetch" href="/DailyNotes/assets/weblogic_CVE-2017-10271.html-CnlKc7Qq.js" as="script"><link rel="prefetch" href="/DailyNotes/assets/weblogic_CVE-2018-2894.html-BTpd-ZwP.js" as="script"><link rel="prefetch" href="/DailyNotes/assets/weblogic_CVE-2020-14882.html-hspcZLHx.js" as="script"><link rel="prefetch" href="/DailyNotes/assets/FastjsonVul.html-CY-9dItK.js" as="script"><link rel="prefetch" href="/DailyNotes/assets/log4j2 .html-BbHhuEfM.js" as="script"><link rel="prefetch" href="/DailyNotes/assets/shiro.html-CF6AEjmr.js" as="script"><link rel="prefetch" href="/DailyNotes/assets/shiro_CVE-2019-12422_shiro721.html-Cx1S0IzQ.js" as="script"><link rel="prefetch" href="/DailyNotes/assets/shiro_CVE-2020-11989.html-DcUJG49c.js" as="script"><link rel="prefetch" href="/DailyNotes/assets/shiro_CVE-2020-13933.html-Dw-N3U7t.js" as="script"><link rel="prefetch" href="/DailyNotes/assets/spring.html-BGpZcawH.js" as="script"><link rel="prefetch" href="/DailyNotes/assets/spring_CVE-2018-1273_bypass.html-7SxrQy-V.js" as="script"><link rel="prefetch" href="/DailyNotes/assets/supervisor_CVE-2017-11610.html-Ce1fE2pY.js" as="script"><link rel="prefetch" href="/DailyNotes/assets/xstream_CVE-2021-21351.html-CEgnLsrw.js" as="script"><link rel="prefetch" href="/DailyNotes/assets/C3.html-CMO7tdYB.js" as="script"><link rel="prefetch" href="/DailyNotes/assets/CS.html-C_WFf4vl.js" as="script"><link rel="prefetch" href="/DailyNotes/assets/MSFUse.html-C-PjbrQB.js" as="script"><link rel="prefetch" href="/DailyNotes/assets/MSF_CS.html-CwWp6Hoy.js" as="script"><link rel="prefetch" href="/DailyNotes/assets/404.html-BwJDywvx.js" as="script"><link rel="prefetch" href="/DailyNotes/assets/index.html-DbV5k7zo.js" as="script"><link rel="prefetch" href="/DailyNotes/assets/index.html-BM1OUVVZ.js" as="script"><link rel="prefetch" href="/DailyNotes/assets/index.html-UHmmaLU2.js" as="script"><link rel="prefetch" href="/DailyNotes/assets/index.html-Cp__PXjX.js" as="script"><link rel="prefetch" href="/DailyNotes/assets/index.html-p_0xuzqO.js" as="script"><link rel="prefetch" href="/DailyNotes/assets/index.html-B-Z0dh3n.js" as="script"><link rel="prefetch" href="/DailyNotes/assets/index.html-Ikv5hKty.js" as="script"><link rel="prefetch" href="/DailyNotes/assets/index.html-CNOqcytO.js" as="script"><link rel="prefetch" href="/DailyNotes/assets/index.html-CKqH_faV.js" as="script"><link rel="prefetch" href="/DailyNotes/assets/index.html-DVmaPLjA.js" as="script"><link rel="prefetch" href="/DailyNotes/assets/index.html-BC037vFp.js" as="script"><link rel="prefetch" href="/DailyNotes/assets/index.html-BIOdUqAw.js" as="script"><link rel="prefetch" href="/DailyNotes/assets/index.html-DUp14OsH.js" as="script"><link rel="prefetch" href="/DailyNotes/assets/index.html-CdYUjpv2.js" as="script"><link rel="prefetch" href="/DailyNotes/assets/index.html-CRMQddqA.js" as="script"><link rel="prefetch" href="/DailyNotes/assets/index.html-DNxgB1jM.js" as="script"><link rel="prefetch" href="/DailyNotes/assets/index.html-BWmVghEX.js" as="script"><link rel="prefetch" href="/DailyNotes/assets/index.html-DXNd6jFu.js" as="script"><link rel="prefetch" href="/DailyNotes/assets/index.html-BkIqzcbN.js" as="script"><link rel="prefetch" href="/DailyNotes/assets/index.html-DcwFutcd.js" as="script"><link rel="prefetch" href="/DailyNotes/assets/index.html-BQxnIszV.js" as="script"><link rel="prefetch" href="/DailyNotes/assets/index.html-DTft0WEV.js" as="script"><link rel="prefetch" href="/DailyNotes/assets/index.html-Dv49wLHG.js" as="script"><link rel="prefetch" href="/DailyNotes/assets/index.html-Bd-B_CuC.js" as="script"><link rel="prefetch" href="/DailyNotes/assets/index.html-D9wM-NGK.js" as="script"><link rel="prefetch" href="/DailyNotes/assets/index.html-a-TJoiaR.js" as="script"><link rel="prefetch" href="/DailyNotes/assets/index.html-DkBXRNuZ.js" as="script"><link rel="prefetch" href="/DailyNotes/assets/index.html-Q5s3k6Qm.js" as="script"><link rel="prefetch" href="/DailyNotes/assets/index.html-DGfqZIDZ.js" as="script"><link rel="prefetch" href="/DailyNotes/assets/index.html-DiE7sv4w.js" as="script"><link rel="prefetch" href="/DailyNotes/assets/index.html-TZw4HzS2.js" as="script"><link rel="prefetch" href="/DailyNotes/assets/index.html-Bbhtp4Pz.js" as="script"><link rel="prefetch" href="/DailyNotes/assets/index.html-BHdV6t3b.js" as="script"><link rel="prefetch" href="/DailyNotes/assets/index.html-CnRPARH1.js" as="script"><link rel="prefetch" href="/DailyNotes/assets/index.html-D56JtE6e.js" as="script"><link rel="prefetch" href="/DailyNotes/assets/index.html-C_K4IvGb.js" as="script"><link rel="prefetch" href="/DailyNotes/assets/index.html-Sob-4Qq2.js" as="script"><link rel="prefetch" href="/DailyNotes/assets/index.html-fe5T4Xwu.js" as="script"><link rel="prefetch" href="/DailyNotes/assets/index.html-J97W-5Pt.js" as="script"><link rel="prefetch" href="/DailyNotes/assets/index.html-BeSuVlES.js" as="script"><link rel="prefetch" href="/DailyNotes/assets/index.html-DyTHgjSZ.js" as="script"><link rel="prefetch" href="/DailyNotes/assets/index.html-AG7b155W.js" as="script"><link rel="prefetch" href="/DailyNotes/assets/index.html-CcIqEHQZ.js" as="script"><link rel="prefetch" href="/DailyNotes/assets/index.html-Dw80M-8x.js" as="script"><link rel="prefetch" href="/DailyNotes/assets/index.html-C_hV5xUB.js" as="script"><link rel="prefetch" href="/DailyNotes/assets/index.html-DAbz7zuO.js" as="script"><link rel="prefetch" href="/DailyNotes/assets/index.html-LCyhuol1.js" as="script"><link rel="prefetch" href="/DailyNotes/assets/index.html-IEd3aPjm.js" as="script"><link rel="prefetch" href="/DailyNotes/assets/index.html-Cb4xby_9.js" as="script"><link rel="prefetch" href="/DailyNotes/assets/index.html-YlxpSyEj.js" as="script"><link rel="prefetch" href="/DailyNotes/assets/index.html-CbTxtS-l.js" as="script"><link rel="prefetch" href="/DailyNotes/assets/index.html-8UIQMQw4.js" as="script"><link rel="prefetch" href="/DailyNotes/assets/index.html-D5AxjK6w.js" as="script"><link rel="prefetch" href="/DailyNotes/assets/index.html-rxmAm-PF.js" as="script"><link rel="prefetch" href="/DailyNotes/assets/index.html-DLcrbHkH.js" as="script"><link rel="prefetch" href="/DailyNotes/assets/index.html-DjeBecTq.js" as="script"><link rel="prefetch" href="/DailyNotes/assets/index.html-BO6Ourca.js" as="script"><link rel="prefetch" href="/DailyNotes/assets/index.html-BznU04Eu.js" as="script"><link rel="prefetch" href="/DailyNotes/assets/index.html-BDWMUL-D.js" as="script"><link rel="prefetch" href="/DailyNotes/assets/index.html-_rSGW874.js" as="script"><link rel="prefetch" href="/DailyNotes/assets/index.html-B53ug_Of.js" as="script"><link rel="prefetch" href="/DailyNotes/assets/index.html-CMfvuXfX.js" as="script"><link rel="prefetch" href="/DailyNotes/assets/index.html-BD_aLIMc.js" as="script"><link rel="prefetch" href="/DailyNotes/assets/index.html-BD_aLIMc.js" as="script"><link rel="prefetch" href="/DailyNotes/assets/index.html-CwDPZpph.js" as="script"><link rel="prefetch" href="/DailyNotes/assets/index.html-Aa1AfVyq.js" as="script"><link rel="prefetch" href="/DailyNotes/assets/index.html-C5mX7vjy.js" as="script"><link rel="prefetch" href="/DailyNotes/assets/index.html-DDFHIYVu.js" as="script"><link rel="prefetch" href="/DailyNotes/assets/index.html-xmy6yfpC.js" as="script"><link rel="prefetch" href="/DailyNotes/assets/index.html-BAFYLyor.js" as="script"><link rel="prefetch" href="/DailyNotes/assets/index.html-ChE4C0ge.js" as="script"><link rel="prefetch" href="/DailyNotes/assets/index.html-BZguuiTJ.js" as="script"><link rel="prefetch" href="/DailyNotes/assets/index.html-BaDOdKEx.js" as="script"><link rel="prefetch" href="/DailyNotes/assets/index.html-CuwZ_IC7.js" as="script"><link rel="prefetch" href="/DailyNotes/assets/index.html-CrSCZKoR.js" as="script"><link rel="prefetch" href="/DailyNotes/assets/index.html-CDjxrlHl.js" as="script"><link rel="prefetch" href="/DailyNotes/assets/index.html-DfPaTO3h.js" as="script"><link rel="prefetch" href="/DailyNotes/assets/index.html-rQHfkbb1.js" as="script"><link rel="prefetch" href="/DailyNotes/assets/index.html-BoKFsfuA.js" as="script"><link rel="prefetch" href="/DailyNotes/assets/index.html-UNa8zZBN.js" as="script"><link rel="prefetch" href="/DailyNotes/assets/index.html-w965dYX3.js" as="script"><link rel="prefetch" href="/DailyNotes/assets/index.html-Ddzh85T0.js" as="script"><link rel="prefetch" href="/DailyNotes/assets/index.html-DDlLVaZL.js" as="script"><link rel="prefetch" href="/DailyNotes/assets/index.html-BelCLTMP.js" as="script"><link rel="prefetch" href="/DailyNotes/assets/index.html-B-q7DMD7.js" as="script"><link rel="prefetch" href="/DailyNotes/assets/photoswipe.esm-D2Nf-uDI.js" as="script"><link rel="prefetch" href="/DailyNotes/assets/SearchResult-C7ijt9Me.js" as="script">
  </head>
  <body>
    <div id="app"><!--[--><!--[--><!--[--><span tabindex="-1"></span><a href="#main-content" class="vp-skip-link sr-only">跳至主要內容</a><!--]--><div class="theme-container has-toc"><!--[--><header id="navbar" class="vp-navbar"><div class="vp-navbar-start"><button type="button" class="vp-toggle-sidebar-button" title="Toggle Sidebar"><span class="icon"></span></button><!--[--><!----><!--]--><!--[--><a class="route-link vp-brand" href="/DailyNotes/"><img class="vp-nav-logo" src="/DailyNotes/logo.jpg" alt><!----><span class="vp-site-name hide-in-pad">echo0d-notes</span></a><!--]--><!--[--><!----><!--]--></div><div class="vp-navbar-center"><!--[--><!----><!--]--><!--[--><nav class="vp-nav-links"><div class="nav-item hide-in-mobile"><a class="route-link nav-link active" href="/DailyNotes/CyberSecurity/" aria-label="网络安全"><span class="font-icon icon fa-fw fa-sm fas fa-laptop-code" style=""></span>网络安全<!----></a></div><div class="nav-item hide-in-mobile"><a class="route-link nav-link" href="/DailyNotes/CodeAudittutorial/" aria-label="代码审计"><span class="font-icon icon fa-fw fa-sm fas fa-laptop-code" style=""></span>代码审计<!----></a></div><div class="nav-item hide-in-mobile"><a class="route-link nav-link" href="/DailyNotes/develop/" aria-label="开发技术"><span class="font-icon icon fa-fw fa-sm fas fa-laptop-code" style=""></span>开发技术<!----></a></div><div class="nav-item hide-in-mobile"><a class="route-link nav-link" href="/DailyNotes/others/" aria-label="其他随笔"><span class="font-icon icon fa-fw fa-sm fas fa-laptop-code" style=""></span>其他随笔<!----></a></div></nav><!--]--><!--[--><!----><!--]--></div><div class="vp-navbar-end"><!--[--><!----><!--]--><!--[--><!----><div class="nav-item vp-repo"><a class="vp-repo-link" href="https://github.com/echo0d/DailyNotes" target="_blank" rel="noopener noreferrer" aria-label="GitHub"><svg xmlns="http://www.w3.org/2000/svg" class="icon github-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="github icon" style="width:1.25rem;height:1.25rem;vertical-align:middle;"><path d="M511.957 21.333C241.024 21.333 21.333 240.981 21.333 512c0 216.832 140.544 400.725 335.574 465.664 24.49 4.395 32.256-10.07 32.256-23.083 0-11.69.256-44.245 0-85.205-136.448 29.61-164.736-64.64-164.736-64.64-22.315-56.704-54.4-71.765-54.4-71.765-44.587-30.464 3.285-29.824 3.285-29.824 49.195 3.413 75.179 50.517 75.179 50.517 43.776 75.008 114.816 53.333 142.762 40.79 4.523-31.66 17.152-53.377 31.19-65.537-108.971-12.458-223.488-54.485-223.488-242.602 0-53.547 19.114-97.323 50.517-131.67-5.035-12.33-21.93-62.293 4.779-129.834 0 0 41.258-13.184 134.912 50.346a469.803 469.803 0 0 1 122.88-16.554c41.642.213 83.626 5.632 122.88 16.554 93.653-63.488 134.784-50.346 134.784-50.346 26.752 67.541 9.898 117.504 4.864 129.834 31.402 34.347 50.474 78.123 50.474 131.67 0 188.586-114.73 230.016-224.042 242.09 17.578 15.232 33.578 44.672 33.578 90.454v135.85c0 13.142 7.936 27.606 32.854 22.87C862.25 912.597 1002.667 728.747 1002.667 512c0-271.019-219.648-490.667-490.71-490.667z"></path></svg></a></div><div class="nav-item hide-in-mobile"><button type="button" class="outlook-button" tabindex="-1" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" class="icon outlook-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="outlook icon"><path d="M224 800c0 9.6 3.2 44.8 6.4 54.4 6.4 48-48 76.8-48 76.8s80 41.6 147.2 0 134.4-134.4 38.4-195.2c-22.4-12.8-41.6-19.2-57.6-19.2C259.2 716.8 227.2 761.6 224 800zM560 675.2l-32 51.2c-51.2 51.2-83.2 32-83.2 32 25.6 67.2 0 112-12.8 128 25.6 6.4 51.2 9.6 80 9.6 54.4 0 102.4-9.6 150.4-32l0 0c3.2 0 3.2-3.2 3.2-3.2 22.4-16 12.8-35.2 6.4-44.8-9.6-12.8-12.8-25.6-12.8-41.6 0-54.4 60.8-99.2 137.6-99.2 6.4 0 12.8 0 22.4 0 12.8 0 38.4 9.6 48-25.6 0-3.2 0-3.2 3.2-6.4 0-3.2 3.2-6.4 3.2-6.4 6.4-16 6.4-16 6.4-19.2 9.6-35.2 16-73.6 16-115.2 0-105.6-41.6-198.4-108.8-268.8C704 396.8 560 675.2 560 675.2zM224 419.2c0-28.8 22.4-51.2 51.2-51.2 28.8 0 51.2 22.4 51.2 51.2 0 28.8-22.4 51.2-51.2 51.2C246.4 470.4 224 448 224 419.2zM320 284.8c0-22.4 19.2-41.6 41.6-41.6 22.4 0 41.6 19.2 41.6 41.6 0 22.4-19.2 41.6-41.6 41.6C339.2 326.4 320 307.2 320 284.8zM457.6 208c0-12.8 12.8-25.6 25.6-25.6 12.8 0 25.6 12.8 25.6 25.6 0 12.8-12.8 25.6-25.6 25.6C470.4 233.6 457.6 220.8 457.6 208zM128 505.6C128 592 153.6 672 201.6 736c28.8-60.8 112-60.8 124.8-60.8-16-51.2 16-99.2 16-99.2l316.8-422.4c-48-19.2-99.2-32-150.4-32C297.6 118.4 128 291.2 128 505.6zM764.8 86.4c-22.4 19.2-390.4 518.4-390.4 518.4-22.4 28.8-12.8 76.8 22.4 99.2l9.6 6.4c35.2 22.4 80 12.8 99.2-25.6 0 0 6.4-12.8 9.6-19.2 54.4-105.6 275.2-524.8 288-553.6 6.4-19.2-3.2-32-19.2-32C777.6 76.8 771.2 80 764.8 86.4z"></path></svg><div class="outlook-dropdown"><!----></div></button></div><!--[--><button type="button" class="search-pro-button" aria-label="搜索"><svg xmlns="http://www.w3.org/2000/svg" class="icon search-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="search icon"><path d="M192 480a256 256 0 1 1 512 0 256 256 0 0 1-512 0m631.776 362.496-143.2-143.168A318.464 318.464 0 0 0 768 480c0-176.736-143.264-320-320-320S128 303.264 128 480s143.264 320 320 320a318.016 318.016 0 0 0 184.16-58.592l146.336 146.368c12.512 12.48 32.768 12.48 45.28 0 12.48-12.512 12.48-32.768 0-45.28"></path></svg><div class="search-pro-placeholder">搜索</div><div class="search-pro-key-hints"><kbd class="search-pro-key">Ctrl</kbd><kbd class="search-pro-key">K</kbd></div></button><!--]--><!--]--><!--[--><!----><!--]--><button type="button" class="vp-toggle-navbar-button" aria-label="Toggle Navbar" aria-expanded="false" aria-controls="nav-screen"><span><span class="vp-top"></span><span class="vp-middle"></span><span class="vp-bottom"></span></span></button></div></header><!----><!--]--><!----><div class="toggle-sidebar-wrapper"><span class="arrow start"></span></div><aside id="sidebar" class="vp-sidebar"><!--[--><!----><!--]--><ul class="vp-sidebar-links"><li><section class="vp-sidebar-group"><p class="vp-sidebar-header clickable active"><!----><a class="route-link nav-link active vp-sidebar-title" href="/DailyNotes/CyberSecurity/" aria-label="网络安全"><!---->网络安全<!----></a><!----></p><ul class="vp-sidebar-links"><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">CTF笔记</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">防御规避</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable active" type="button"><!----><span class="vp-sidebar-title">初级红队</span><span class="vp-arrow down"></span></button><ul class="vp-sidebar-links"><li><a class="route-link nav-link vp-sidebar-link vp-sidebar-page" href="/DailyNotes/CyberSecurity/RedTeam/" aria-label="初级红队"><!---->初级红队<!----></a></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">1 Information Gathering</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">2 Web Vulnerability</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">3 Persistence</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">4 Privilege Escalation</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">5 Intranet</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable active" type="button"><!----><span class="vp-sidebar-title">6 Emergency</span><span class="vp-arrow down"></span></button><ul class="vp-sidebar-links"><li><a class="route-link nav-link vp-sidebar-link vp-sidebar-page" href="/DailyNotes/CyberSecurity/RedTeam/6-Emergency/Tamper.html" aria-label="网站篡改"><!---->网站篡改<!----></a></li><li><a class="route-link nav-link active vp-sidebar-link vp-sidebar-page active" href="/DailyNotes/CyberSecurity/RedTeam/6-Emergency/TracesRemoval.html" aria-label="痕迹清理"><!---->痕迹清理<!----></a></li></ul></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">Tools</span><span class="vp-arrow end"></span></button><!----></section></li></ul></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">Reverse Engineering</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">SRC</span><span class="vp-arrow end"></span></button><!----></section></li></ul></section></li></ul><!--[--><!----><!--]--></aside><!--[--><main id="main-content" class="vp-page"><!--[--><!--[--><!----><!--]--><!----><nav class="vp-breadcrumb disable"></nav><div class="vp-page-title"><h1><!---->痕迹清理</h1><div class="page-info"><span class="page-author-info" aria-label="作者🖊" data-balloon-pos="down"><svg xmlns="http://www.w3.org/2000/svg" class="icon author-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="author icon"><path d="M649.6 633.6c86.4-48 147.2-144 147.2-249.6 0-160-128-288-288-288s-288 128-288 288c0 108.8 57.6 201.6 147.2 249.6-121.6 48-214.4 153.6-240 288-3.2 9.6 0 19.2 6.4 25.6 3.2 9.6 12.8 12.8 22.4 12.8h704c9.6 0 19.2-3.2 25.6-12.8 6.4-6.4 9.6-16 6.4-25.6-25.6-134.4-121.6-240-243.2-288z"></path></svg><span><span class="page-author-item">echo0d</span></span><span property="author" content="echo0d"></span></span><!----><span class="page-date-info" aria-label="写作日期📅" data-balloon-pos="down"><svg xmlns="http://www.w3.org/2000/svg" class="icon calendar-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="calendar icon"><path d="M716.4 110.137c0-18.753-14.72-33.473-33.472-33.473-18.753 0-33.473 14.72-33.473 33.473v33.473h66.993v-33.473zm-334.87 0c0-18.753-14.72-33.473-33.473-33.473s-33.52 14.72-33.52 33.473v33.473h66.993v-33.473zm468.81 33.52H716.4v100.465c0 18.753-14.72 33.473-33.472 33.473a33.145 33.145 0 01-33.473-33.473V143.657H381.53v100.465c0 18.753-14.72 33.473-33.473 33.473a33.145 33.145 0 01-33.473-33.473V143.657H180.6A134.314 134.314 0 0046.66 277.595v535.756A134.314 134.314 0 00180.6 947.289h669.74a134.36 134.36 0 00133.94-133.938V277.595a134.314 134.314 0 00-133.94-133.938zm33.473 267.877H147.126a33.145 33.145 0 01-33.473-33.473c0-18.752 14.72-33.473 33.473-33.473h736.687c18.752 0 33.472 14.72 33.472 33.473a33.145 33.145 0 01-33.472 33.473z"></path></svg><span><!----></span><meta property="datePublished" content="2024-11-15T10:05:31.000Z"></span><!----><span class="page-reading-time-info" aria-label="阅读时间⌛" data-balloon-pos="down"><svg xmlns="http://www.w3.org/2000/svg" class="icon timer-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="timer icon"><path d="M799.387 122.15c4.402-2.978 7.38-7.897 7.38-13.463v-1.165c0-8.933-7.38-16.312-16.312-16.312H256.33c-8.933 0-16.311 7.38-16.311 16.312v1.165c0 5.825 2.977 10.874 7.637 13.592 4.143 194.44 97.22 354.963 220.201 392.763-122.204 37.542-214.893 196.511-220.2 389.397-4.661 5.049-7.638 11.651-7.638 19.03v5.825h566.49v-5.825c0-7.379-2.849-13.981-7.509-18.9-5.049-193.016-97.867-351.985-220.2-389.527 123.24-37.67 216.446-198.453 220.588-392.892zM531.16 450.445v352.632c117.674 1.553 211.787 40.778 211.787 88.676H304.097c0-48.286 95.149-87.382 213.728-88.676V450.445c-93.077-3.107-167.901-81.297-167.901-177.093 0-8.803 6.99-15.793 15.793-15.793 8.803 0 15.794 6.99 15.794 15.793 0 80.261 63.69 145.635 142.01 145.635s142.011-65.374 142.011-145.635c0-8.803 6.99-15.793 15.794-15.793s15.793 6.99 15.793 15.793c0 95.019-73.789 172.82-165.96 177.093z"></path></svg><span>大约 27 分钟</span><meta property="timeRequired" content="PT27M"></span><span class="page-category-info" aria-label="分类🌈" data-balloon-pos="down"><svg xmlns="http://www.w3.org/2000/svg" class="icon category-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="category icon"><path d="M148.41 106.992h282.176c22.263 0 40.31 18.048 40.31 40.31V429.48c0 22.263-18.047 40.31-40.31 40.31H148.41c-22.263 0-40.311-18.047-40.311-40.31V147.302c0-22.263 18.048-40.31 40.311-40.31zM147.556 553.478H429.73c22.263 0 40.311 18.048 40.311 40.31v282.176c0 22.263-18.048 40.312-40.31 40.312H147.555c-22.263 0-40.311-18.049-40.311-40.312V593.79c0-22.263 18.048-40.311 40.31-40.311zM593.927 106.992h282.176c22.263 0 40.31 18.048 40.31 40.31V429.48c0 22.263-18.047 40.31-40.31 40.31H593.927c-22.263 0-40.311-18.047-40.311-40.31V147.302c0-22.263 18.048-40.31 40.31-40.31zM730.22 920.502H623.926c-40.925 0-74.22-33.388-74.22-74.425V623.992c0-41.038 33.387-74.424 74.425-74.424h222.085c41.038 0 74.424 33.226 74.424 74.067v114.233c0 10.244-8.304 18.548-18.547 18.548s-18.548-8.304-18.548-18.548V623.635c0-20.388-16.746-36.974-37.33-36.974H624.13c-20.585 0-37.331 16.747-37.331 37.33v222.086c0 20.585 16.654 37.331 37.126 37.331H730.22c10.243 0 18.547 8.304 18.547 18.547 0 10.244-8.304 18.547-18.547 18.547z"></path></svg><!--[--><span class="page-category-item category7 clickable" role="navigation">网络安全</span><!--]--><meta property="articleSection" content="网络安全"></span><!----></div><hr></div><div class="vp-toc-placeholder"><aside id="toc"><!--[--><!----><!--]--><div class="vp-toc-header">此页内容<button type="button" class="print-button" title="打印"><svg xmlns="http://www.w3.org/2000/svg" class="icon print-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="print icon"><path d="M819.2 364.8h-44.8V128c0-17.067-14.933-32-32-32H281.6c-17.067 0-32 14.933-32 32v236.8h-44.8C145.067 364.8 96 413.867 96 473.6v192c0 59.733 49.067 108.8 108.8 108.8h44.8V896c0 17.067 14.933 32 32 32h460.8c17.067 0 32-14.933 32-32V774.4h44.8c59.733 0 108.8-49.067 108.8-108.8v-192c0-59.733-49.067-108.8-108.8-108.8zM313.6 160h396.8v204.8H313.6V160zm396.8 704H313.6V620.8h396.8V864zM864 665.6c0 25.6-19.2 44.8-44.8 44.8h-44.8V588.8c0-17.067-14.933-32-32-32H281.6c-17.067 0-32 14.933-32 32v121.6h-44.8c-25.6 0-44.8-19.2-44.8-44.8v-192c0-25.6 19.2-44.8 44.8-44.8h614.4c25.6 0 44.8 19.2 44.8 44.8v192z"></path></svg></button><div class="arrow end"></div></div><div class="vp-toc-wrapper"><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#_1-引言">1. 引言</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#_2-windows-痕迹清理">2. Windows 痕迹清理</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_2-1-windows-核心日志相关基础知识">2.1 Windows 核心日志相关基础知识</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_2-2-windwos-核心日志清理方法">2.2 Windwos 核心日志清理方法</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_2-3-远程桌面连接日志清理">2.3 远程桌面连接日志清理</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_2-4-浏览器记录清理">2.4 浏览器记录清理</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_2-5-命令行-history-清理">2.5 命令行 history 清理</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_2-6-其他">2.6 其他</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#_3-linux-痕迹清理">3. Linux 痕迹清理</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_3-1-删除-history-记录">3.1 删除 History 记录</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_3-2-删除日志文件">3.2 删除日志文件</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_3-3-其他">3.3 其他</a></li><!----><!--]--></ul></li><!--]--></ul><div class="vp-toc-marker" style="top:-1.7rem;"></div></div><!--[--><!----><!--]--></aside></div><!--[--><!----><!--]--><div class="theme-hope-content"><h1 id="痕迹清理" tabindex="-1"><a class="header-anchor" href="#痕迹清理"><span>痕迹清理</span></a></h1><p>痕迹清理，是清理渗透过程中在目标机器上留下的所有操作痕迹。其主要目的是：避免溯源、隐藏攻击方法。总结了痕迹清理的一些方式。</p><h2 id="_1-引言" tabindex="-1"><a class="header-anchor" href="#_1-引言"><span>1. 引言</span></a></h2><p>痕迹清理，是清理渗透过程中在目标机器上留下的所有操作痕迹。其主要目的是：避免溯源、隐藏攻击方法。</p><p>需要注意的是：</p><ul><li><strong>痕迹清理这个动作本身也会产生痕迹</strong>，所以不存在完美的痕迹清理。</li><li>如果目标已经配置，第三方的日志记录平台，本机的痕迹清理作用就不大了，除非可以拿下日志系统的权限。</li></ul><h2 id="_2-windows-痕迹清理" tabindex="-1"><a class="header-anchor" href="#_2-windows-痕迹清理"><span>2. Windows 痕迹清理</span></a></h2><h3 id="_2-1-windows-核心日志相关基础知识" tabindex="-1"><a class="header-anchor" href="#_2-1-windows-核心日志相关基础知识"><span>2.1 Windows 核心日志相关基础知识</span></a></h3><h5 id="_1-3-类核心日志" tabindex="-1"><a class="header-anchor" href="#_1-3-类核心日志"><span>1）3 类核心日志</span></a></h5><p>Windows 的日志文件分为 3 类核心日志，分别是系统日志，程序日志，和安全日志，如图</p><figure><img src="/DailyNotes/assets/image-20231109171401216-sxnEkaNP.png" alt="image-20231109171401216" tabindex="0" loading="lazy"><figcaption>image-20231109171401216</figcaption></figure><p><strong>登录失败：</strong></p><figure><img src="/DailyNotes/assets/image-20231128112011589-B1bvo8I5.png" alt="image-20231128112011589" tabindex="0" loading="lazy"><figcaption>image-20231128112011589</figcaption></figure><figure><img src="/DailyNotes/assets/image-20231128112023741-DHqzhufw.png" alt="image-20231128112023741" tabindex="0" loading="lazy"><figcaption>image-20231128112023741</figcaption></figure><pre><code>帐户登录失败。

使用者:
	安全 ID:		NULL SID
	帐户名:		-
	帐户域:		-
	登录 ID:		0x0

登录类型:			3

登录失败的帐户:
	安全 ID:		NULL SID
	帐户名:		abcd
	帐户域:		HILLSTONENET

失败信息:
	失败原因:		未知用户名或密码错误。
	状态:			0xC000006D
	子状态:		0xC000006A

进程信息:
	调用方进程 ID:	0x0
	调用方进程名:	-

网络信息:
	工作站名:	XIAOMENGSONG904
	源网络地址:	10.89.17.170
	源端口:		0

详细身份验证信息:
	登录进程:		NtLmSsp
	身份验证数据包:	NTLM
	传递服务:	-
	数据包名(仅限 NTLM):	-
	密钥长度:		0

登录请求失败时在尝试访问的计算机上生成此事件。

“使用者”字段指明本地系统上请求登录的帐户。这通常是一个服务(例如 Server 服务)或本地进程(例如 Winlogon.exe 或 Services.exe)。

“登录类型”字段指明发生的登录的种类。最常见的类型是 2 (交互式)和 3 (网络)。

“进程信息”字段表明系统上的哪个帐户和进程请求了登录。

“网络信息”字段指明远程登录请求来自哪里。“工作站名”并非总是可用，而且在某些情况下可能会留为空白。

“身份验证信息”字段提供关于此特定登录请求的详细信息。
	-“传递服务”指明哪些直接服务参与了此登录请求。
	-“数据包名”指明在 NTLM 协议之间使用了哪些子协议。
	-“密钥长度”指明生成的会话密钥的长度。如果没有请求会话密钥，则此字段为 0。
</code></pre><p><strong>登录成功：</strong></p><figure><img src="/DailyNotes/assets/image-20231128112115875-D7_aqCQd.png" alt="image-20231128112115875" tabindex="0" loading="lazy"><figcaption>image-20231128112115875</figcaption></figure><figure><img src="/DailyNotes/assets/image-20231128112132734-D9ODlCFK.png" alt="image-20231128112132734" tabindex="0" loading="lazy"><figcaption>image-20231128112132734</figcaption></figure><figure><img src="/DailyNotes/assets/image-20231128112144294-CxsWMkiD.png" alt="image-20231128112144294" tabindex="0" loading="lazy"><figcaption>image-20231128112144294</figcaption></figure><pre><code>已成功登录帐户。

使用者:
	安全 ID:		SYSTEM
	帐户名称:		DESKTOP-0O9EC2H$
	帐户域:		WORKGROUP
	登录 ID:		0x3E7

登录信息:
	登录类型:		5
	受限制的管理员模式:	-
	虚拟帐户:		否
	提升的令牌:		是

模拟级别:		模拟

新登录:
	安全 ID:		SYSTEM
	帐户名称:		SYSTEM
	帐户域:		NT AUTHORITY
	登录 ID:		0x3E7
	链接的登录 ID:		0x0
	网络帐户名称:	-
	网络帐户域:	-
	登录 GUID:		{00000000-0000-0000-0000-000000000000}

进程信息:
	进程 ID:		0x2ac
	进程名称:		C:\Windows\System32\services.exe

网络信息:
	工作站名称:	-
	源网络地址:	-
	源端口:		-

详细的身份验证信息:
	登录进程:		Advapi
	身份验证数据包:	Negotiate
	传递的服务:	-
	数据包名(仅限 NTLM):	-
	密钥长度:		0

创建登录会话时，将在被访问的计算机上生成此事件。

“使用者”字段指示本地系统上请求登录的帐户。这通常是一个服务(例如 Server 服务)或本地进程(例如 Winlogon.exe 或 Services.exe)。

“登录类型”字段指示发生的登录类型。最常见的类型是 2 (交互式)和 3 (网络)。

“新登录”字段指示新登录是为哪个帐户创建的，即已登录的帐户。

“网络”字段指示远程登录请求源自哪里。“工作站名称”并非始终可用，并且在某些情况下可能会留空。

“模拟级别”字段指示登录会话中的进程可以模拟到的程度。

“身份验证信息”字段提供有关此特定登录请求的详细信息。
	- “登录 GUID”是可用于将此事件与 KDC 事件关联起来的唯一标识符。
	-“传递的服务”指示哪些中间服务参与了此登录请求。
	-“数据包名”指示在 NTLM 协议中使用了哪些子协议。
	-“密钥长度”指示生成的会话密钥的长度。如果没有请求会话密钥，则此字段将为 0。
</code></pre><p>可以查看事件属性：</p><figure><img src="/DailyNotes/assets/image-20231113132536818-2fru1DyU.png" alt="image-20231113132536818" tabindex="0" loading="lazy"><figcaption>image-20231113132536818</figcaption></figure><p>详细信息：</p><figure><img src="/DailyNotes/assets/image-20231113132603403-xmP_HAGD.png" alt="image-20231113132603403" tabindex="0" loading="lazy"><figcaption>image-20231113132603403</figcaption></figure><p>具体含义参见<a href="https://blog.csdn.net/diyiday/article/details/133831752" target="_blank" rel="noopener noreferrer">【Windows 日志】记录系统事件的日志_系统访问日志记录-CSDN 博客<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p><p><strong>日志在注册表的键：</strong></p><pre><code>HKEY_LOCAL_MACHINE\system\CurrentControlSet\Services\Eventlog
</code></pre><p>**系统日志 (SysEvent)：**记录操作系统产生的事件，如设备驱动无法正常启动或停止，系统进程崩溃等，默认位置</p><pre><code>%SystemRoot%\System32\Winevt\Logs\System.evtx
</code></pre><p>**程序日志 (AppEvent)：**包含操作应用程序软件相关的事件。事件包括了错误、警告及任何应用程序需要报告的信息。默认位置:</p><pre><code>%SystemRoot%\System32\Winevt\Logs\Application.evtx
</code></pre><p>**安全日志 (SecEvent)：**包含安全性相关的事件。e.g. 用户权限变更，登录及注销，文件 / 文件夹访问等信息。默认位置:</p><pre><code>%SystemRoot%\System32\Winevt\Logs\Security.evtx
</code></pre><p>常见的安全事件 ID：</p><table><thead><tr><th>事件 ID</th><th>说明</th></tr></thead><tbody><tr><td>4624</td><td>登录成功</td></tr><tr><td>4625</td><td>登录失败</td></tr><tr><td>4634</td><td>注销成功</td></tr><tr><td>4647</td><td>用户启动了注销过程</td></tr><tr><td>4672</td><td>使用超级用户(如管理员) 进行登录</td></tr><tr><td>4720</td><td>创建用户</td></tr><tr><td>...</td><td>...</td></tr><tr><td></td><td></td></tr></tbody></table><p>以上系统内置的 3 个核心日志文件（System、Security、Application)，默认大小均 20 MB，数据超过 20 MB 默认系统将优先覆盖过期日志记录。打开事件查看器，选中对应的日志后右键属性，即可修改日志大小。</p><figure><img src="/DailyNotes/assets/image-20231109172059211-B2a19dpj.png" alt="image-20231109172059211" tabindex="0" loading="lazy"><figcaption>image-20231109172059211</figcaption></figure><p>应用程序和服务日志默认最大不确定，不同的应用或服务有自己默认的日志最大值，超过最大限制也优先覆盖过期的日志记录</p><figure><img src="/DailyNotes/assets/image-20231109171445584-8YvzH24g.png" alt="image-20231109171445584" tabindex="0" loading="lazy"><figcaption>image-20231109171445584</figcaption></figure><p>其他系统服务的日志也都储存在<code>%SystemRoot%\System32\Winevt\Logs\</code>下</p><h5 id="_2-svhost-eventlog-wevtutil" tabindex="-1"><a class="header-anchor" href="#_2-svhost-eventlog-wevtutil"><span>2）svhost&amp;EventLog&amp;Wevtutil</span></a></h5><p><strong>操作系统日志记录大致流程</strong>：</p><ol><li><p>svhost 启动 EventLog 开始记录日志，例如<code>C:\Windows\System32\svchost.exe -k LocalServiceNetworkRestricted -p</code></p></li><li><p>EventLog 将操作记录先缓存为一段内存内容</p></li><li><p>Wevtutil 将内存内容解析为 xml 并且通过 gui 界面可视化的展现给用户</p></li></ol><p>其中 svchost，EventLog，Wevtutil 具体功能说明如下：</p><p><strong>svchost</strong>主要是用来实现服务进程数据共享，以此来减少系统资源消耗，很多系统程序和服务使用 svchost 运行。</p><p>windows 系统进程分为独立进程和共享进程两种，<code>svchost.exe</code>文件存在于<code>% systemroot% system32</code>目录下，它属于共享进程。随着 windows 系统服务不断增多，为了节省系统资源，微软把很多服务做成共享方式，交由<code>svchost.exe</code>进程来启动。但<code>svchost</code>进程只作为服务宿主，并不能实现任何服务功能，即它只能提供条件让其他服务在这里被启动，而它自己却不能给用户提供任何服务。这些系统服务是以动态链接库（dll）形式实现的，它们把可执行程序指向<code>svchost</code>，由<code>svchost</code>调用相应服务的动态链接库来启动服务。</p><p><strong>Event Log</strong> 主要是管理 windows 管理事件和事件日志。它支持日志记录事件、查询事件、订阅事件、归档事件日志以及管理事件元数据。它可以用 XML 和纯文本两种格式显示事件。</p><figure><img src="/DailyNotes/assets/image-20231109173419596-Czdu64Ah.png" alt="image-20231109173419596" tabindex="0" loading="lazy"><figcaption>image-20231109173419596</figcaption></figure><p>EventLog 的启动需要依赖于 svchost，启动示例如下:</p><pre><code>C:\Windows\System32\svchost.exe -k LocalServiceNetworkRestricted -p -s EventLog
</code></pre><p><strong>wevtutil</strong>检索有关事件日志和发布服务器的信息。此外，还可以使用此命令来安装和卸载事件清单，运行查询，以及导出、存档和清除日志。详细可以参考微软官方介绍。</p><figure><img src="/DailyNotes/assets/image-20231110112739876-YFC4dY3e.png" alt="image-20231110112739876" tabindex="0" loading="lazy"><figcaption>image-20231110112739876</figcaption></figure><figure><img src="/DailyNotes/assets/image-20231110112810268-D5_Yc-E3.png" alt="image-20231110112810268" tabindex="0" loading="lazy"><figcaption>image-20231110112810268</figcaption></figure><p>下面列举一些常用读取日志的命令：</p><pre><code>#获取security的最近十条日志
wevtutil.exe qe Security /f:text /rd:true /c:10
#获取security的前十条日志
wevtutil.exe qe Security /f:text /c:10
#默认视图xml查看（text视图不会输出EventRecordID）
wevtutil.exe qe Security /rd:true /c:10
#导出security所有日志到1.evtx
wevtutil.exe epl security 1.evtx
</code></pre><h3 id="_2-2-windwos-核心日志清理方法" tabindex="-1"><a class="header-anchor" href="#_2-2-windwos-核心日志清理方法"><span>2.2 Windwos 核心日志清理方法</span></a></h3><h4 id="_1-删除日志文件" tabindex="-1"><a class="header-anchor" href="#_1-删除日志文件"><span>1）删除日志文件</span></a></h4><h5 id="通过事件查看器删除" tabindex="-1"><a class="header-anchor" href="#通过事件查看器删除"><span>通过事件查看器删除</span></a></h5><pre><code>开始→运⾏,输⼊ eventvwr 进⼊事件查看器，右边栏选择清除⽇志
</code></pre><figure><img src="/DailyNotes/assets/image-20231110101924746-8ES130CB.png" alt="image-20231110101924746" tabindex="0" loading="lazy"><figcaption>image-20231110101924746</figcaption></figure><p>点击清除日志后，会出现选项<strong>保存并清除</strong>/<strong>清除</strong></p><p>如果选择<strong>清除</strong>。效果如下，清除日志的行为会留下一条日志，<img src="/DailyNotes/assets/image-20231110101740854-CGW4h5MS.png" alt="image-20231110101740854" loading="lazy"></p><p>如果选择了<strong>保存并清除</strong></p><figure><img src="/DailyNotes/assets/image-20231110102200925-BETxcjO2.png" alt="image-20231110102200925" tabindex="0" loading="lazy"><figcaption>image-20231110102200925</figcaption></figure><p>保存后在事件查看器里没有记录，但会留下一个 evtx 的文件，还需要手动将该文件删除（使用 Shift+Delete 快捷键直接永久删除）</p><figure><img src="/DailyNotes/assets/image-20231110102221992-C3fY6MqN.png" alt="image-20231110102221992" tabindex="0" loading="lazy"><figcaption>image-20231110102221992</figcaption></figure><figure><img src="/DailyNotes/assets/image-20231110102356886-D0EMhcAR.png" alt="image-20231110102356886" tabindex="0" loading="lazy"><figcaption>image-20231110102356886</figcaption></figure><h5 id="直接删除文件" tabindex="-1"><a class="header-anchor" href="#直接删除文件"><span>直接删除文件</span></a></h5><p>首先停止 Windows Event Log（EventLog）服务</p><figure><img src="/DailyNotes/assets/image-20231113102323778-Ddl85unt.png" alt="image-20231113102323778" tabindex="0" loading="lazy"><figcaption>image-20231113102323778</figcaption></figure><figure><img src="/DailyNotes/assets/image-20231113102603932-QwxhTzHg.png" alt="image-20231113102603932" tabindex="0" loading="lazy"><figcaption>image-20231113102603932</figcaption></figure><p>然后直接删除文件即可。删除文件时候可以：</p><p>（1）Shift+Delete 快捷键永久删除</p><p>（2）Cipher 命令多次覆写</p><p>利用 Cipher 命令通过 /W 参数可反复写入其他数据覆盖已删除文件的硬盘空间，彻底删除数据防止被恢复。</p><p>比如删除 D:\tools 目录下的文件后，执行</p><pre><code>cipher /w:D:\tools
</code></pre><p>D 盘上未使用空间就会被覆盖三次：一次 0x00、一次 0xFF，一次随机数，所有被删除的文件就都不可能被恢复了。</p><p>（3）Format 命令覆盖格式化</p><p>Format 命令加上 /P 参数后，就会把每个扇区先清零，再用随机数覆盖。而且可以覆盖多次。比如：</p><pre><code>format D: /P:8
</code></pre><p>这条命令表示把 D 盘用随机数覆盖 8 次。</p><h4 id="_2-利用-wevtutil-删除" tabindex="-1"><a class="header-anchor" href="#_2-利用-wevtutil-删除"><span>2）利用 wevtutil 删除</span></a></h4><pre><code>wevtutil el             列出系统中所有日志名称
for /F &quot;tokens=*&quot; %a in (&#39;wevtutil.exe el&#39;) DO wevtutil.exe cl &quot;%a&quot;  清除所有日志
wevtutil cl system      清理系统日志
wevtutil cl application 清理应用程序日志
wevtutil cl security    清理安全日志
wevtutil cl “windows powershell”
</code></pre><p>需要管理员权限</p><figure><img src="/DailyNotes/assets/image-20231110131420044-DgWIbD8S.png" alt="image-20231110131420044" tabindex="0" loading="lazy"><figcaption>image-20231110131420044</figcaption></figure><p>中间有空格的需要加<code>&quot; &quot;</code></p><figure><img src="data:image/png;base64,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" alt="image-20231110131208003" tabindex="0" loading="lazy"><figcaption>image-20231110131208003</figcaption></figure><h4 id="_3-通过-powershell-删除" tabindex="-1"><a class="header-anchor" href="#_3-通过-powershell-删除"><span>3）通过 PowerShell 删除</span></a></h4><p><a href="https://learn.microsoft.com/zh-cn/previous-versions/powershell/module/microsoft.powershell.management/clear-eventlog?view=powershell-5.0" target="_blank" rel="noopener noreferrer">Clear-EventLog (Microsoft.PowerShell.Management) | Microsoft Learn<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p><pre><code>cmd环境：
PowerShell -Command &quot;&amp; {Clear-Eventlog -Log 要清理的日志(如Application,System,Security)}&quot;
PowerShell -Command &quot;&amp; {Get-WinEvent -ListLog 要清理的日志(如Application,System,Security) -Force | % {Wevtutil.exe cl $_.Logname}}&quot;

powershell环境：
Clear-Eventlog -Log 要清理的日志(如Application,System,Security)
Get-WinEvent -ListLog 要清理的日志(如Application,System,Security) -Force | % {Wevtutil.exe cl $_.Logname}

</code></pre><p>普通用户运行会报如下异常：</p><figure><img src="/DailyNotes/assets/image-20231110104354305-BXhWenR8.png" alt="image-20231110104354305" tabindex="0" loading="lazy"><figcaption>image-20231110104354305</figcaption></figure><p>需要管理员权限</p><figure><img src="/DailyNotes/assets/image-20231110104708984-D8Yt1Bbg.png" alt="image-20231110104708984" tabindex="0" loading="lazy"><figcaption>image-20231110104708984</figcaption></figure><figure><img src="/DailyNotes/assets/image-20231110104746387-Bbx748SS.png" alt="image-20231110104746387" tabindex="0" loading="lazy"><figcaption>image-20231110104746387</figcaption></figure><h4 id="_4-停止日志的记录" tabindex="-1"><a class="header-anchor" href="#_4-停止日志的记录"><span>4）停止日志的记录</span></a></h4><h5 id="停止-eventlog-线程" tabindex="-1"><a class="header-anchor" href="#停止-eventlog-线程"><span>停止 eventlog 线程</span></a></h5><p>首先利用 powershell 命令找出日志记录服务（eventlog）对应的进程 PID，<code>Get-WmiObject</code>或<code>Get-CimInstance</code>命令都可以：</p><pre><code>Get-WmiObject -Class win32_service -Filter &quot;name = &#39;eventlog&#39;&quot;

Get-CimInstance -ClassName win32_service -Filter &quot;name = &#39;eventlog&#39;&quot;
</code></pre><p>运行结果中可以看出 eventlog 服务对应的 PID 为 8844，</p><figure><img src="/DailyNotes/assets/image-20231110173852231-CV32oRak.png" alt="image-20231110173852231" tabindex="0" loading="lazy"><figcaption>image-20231110173852231</figcaption></figure><p>或者用任务管理器查看（截图是后面截的 PID 不一样了）</p><figure><img src="/DailyNotes/assets/image-20231113144600874-lmNlfGGF.png" alt="image-20231113144600874" tabindex="0" loading="lazy"><figcaption>image-20231113144600874</figcaption></figure><p>cmd 没有这个命令</p><p>找到这个进程后可以直接右键停止。</p><p>或者利用使用<a href="https://live.sysinternals.com/" target="_blank" rel="noopener noreferrer">Sysinternal 套件<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>中的工具 procexp.exe( Process Explorer)，或者<a href="https://www.systeminformer.com/" target="_blank" rel="noopener noreferrer">System Informer<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>（原来的 Process Hacker）也行</p><p><strong>右键--&gt;以管理员身份运行</strong></p><p>找出 PID=8844 的进程，然后在 Process 处选择该 scvhost.exe，点选<code>右键-&gt;属性</code></p><figure><img src="/DailyNotes/assets/image-20231110175934964-DLc6coTP.png" alt="image-20231110175934964" tabindex="0" loading="lazy"><figcaption>image-20231110175934964</figcaption></figure><p>确定一下 8844 的服务确实是 EventLog</p><figure><img src="/DailyNotes/assets/image-20231110180014218-DxlNfVzQ.png" alt="image-20231110180014218" tabindex="0" loading="lazy"><figcaption>image-20231110180014218</figcaption></figure><p>点击<code>线程</code>，如下图所示，</p><figure><img src="/DailyNotes/assets/image-20231110180449628-oaevU3pN.png" alt="image-20231110180449628" tabindex="0" loading="lazy"><figcaption>image-20231110180449628</figcaption></figure><p>依次选择<code>Service</code>为<code>EventLog</code>的线程，<code>Kill</code>这些线程（如果使用的是 System Informer，就选<code>Terminate</code>），注意<code>Suspend</code>是不行的。</p><p>这样日志服务实际上就关闭了，<strong>但由于只是杀掉了其进程下运行的线程，而进程仍然存在，所以服务看起来是没有异样的</strong></p><figure><img src="/DailyNotes/assets/image-20231110181409125-DA0GimPl.png" alt="image-20231110181409125" tabindex="0" loading="lazy"><figcaption>image-20231110181409125</figcaption></figure><p>需要恢复日志记录服务时，在进程列表界面选择该 scvhost.exe，点选<code>右键-&gt;重新启动</code></p><figure><img src="/DailyNotes/assets/image-20231110181449900-Bf3Fz-NB.png" alt="image-20231110181449900" tabindex="0" loading="lazy"><figcaption>image-20231110181449900</figcaption></figure><p>此时状态还是 Stopped</p><figure><img src="/DailyNotes/assets/image-20231110181532985-8a3Y-eaT.png" alt="image-20231110181532985" tabindex="0" loading="lazy"><figcaption>image-20231110181532985</figcaption></figure><p>管理员执行命令<code>net start eventlog</code></p><figure><img src="/DailyNotes/assets/image-20231110181641995-Ckb9BX7T.png" alt="image-20231110181641995" tabindex="0" loading="lazy"><figcaption>image-20231110181641995</figcaption></figure><p>不执行上面的<code>右键-&gt;重新启动</code>步骤，直接敲命令<code>net start eventlog</code>的话，会这样：</p><figure><img src="data:image/png;base64,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" alt="image-20231113092428251" tabindex="0" loading="lazy"><figcaption>image-20231113092428251</figcaption></figure><p><strong>没有杀死进程，而是杀死了线程。虽然事件日志服务似乎在系统中运行（因为没有终止进程），但它实际上并没有运行（因为终止了线程）并且系统不收集日志。</strong></p><p>以上操作还可以通过脚本实现，遍历事件日志服务进程（专用 svchost.exe）的线程堆栈，并标识事件日志线程以杀死事件日志服务线程。</p><p>项目地址：<a href="https://github.com/hlldz/Phant0m" target="_blank" rel="noopener noreferrer">hlldz/Phant0m: Windows Event Log Killer (github.com)<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p><!----><h5 id="修改注册表停用-eventlog" tabindex="-1"><a class="header-anchor" href="#修改注册表停用-eventlog"><span>修改注册表停用 Eventlog</span></a></h5><p>查询要禁用的注册表</p><pre><code>reg query &quot;HKEY_LOCAL_MACHINE\system\CurrentControlSet\Services\Eventlog\&quot;
</code></pre><figure><img src="/DailyNotes/assets/image-20231113103053968-D2vIjEAK.png" alt="image-20231113103053968" tabindex="0" loading="lazy"><figcaption>image-20231113103053968</figcaption></figure><p>删除注册表</p><pre><code>reg delete &quot;HKEY_LOCAL_MACHINE\system\CurrentControlSet\Services\Eventlog\****&quot;
reg delete &quot;HKEY_LOCAL_MACHINE\system\CurrentControlSet\Services\Eventlog&quot;
</code></pre><h4 id="_5-按条件清理日志" tabindex="-1"><a class="header-anchor" href="#_5-按条件清理日志"><span>5）按条件清理日志</span></a></h4><p>windows 的事件查看器只能删除整个日志文件，不能单条删除单条日志</p><p>首先可以利用 wevtutil 查看 xml 格式获得日志对应的 EventRecordID</p><pre><code class="language-text">wevtutil.exe qe Security /f:xml /rd:true /c:10
</code></pre><p>默认视图为 xml，所以命令可以简写为：</p><pre><code class="language-text">wevtutil.exe qe Security /rd:true /c:10
</code></pre><figure><img src="/DailyNotes/assets/image-20231113133339459-B9ZFKJJ5.png" alt="image-20231113133339459" tabindex="0" loading="lazy"><figcaption>image-20231113133339459</figcaption></figure><p>这样看太乱了，想知道 EventRecordID 还可以通过事件查看器，右键--属性--详细信息</p><figure><img src="/DailyNotes/assets/image-20231113133446314-AgZCQlxK.png" alt="image-20231113133446314" tabindex="0" loading="lazy"><figcaption>image-20231113133446314</figcaption></figure><p>删除 Security 下的单条日志(EventRecordID=709)，并保存为 1.evtx</p><pre><code>wevtutil epl Security 1.evtx &quot;/q:*[System [(EventRecordID!=709)]]&quot;
</code></pre><figure><img src="/DailyNotes/assets/image-20231113133817897-D_yZb-F8.png" alt="image-20231113133817897" tabindex="0" loading="lazy"><figcaption>image-20231113133817897</figcaption></figure><p>或者删除多条日志</p><pre><code>wevtutil epl Security 1.evtx &quot;/q:*[System [(EventRecordID&gt;13032) or (EventRecordID&lt;13030)]]&quot;
</code></pre><p>或者按时间段删除日志，删除 SystemTime 为 2023-08-10T03:20:00 至 2023-08-10T03:21:00 之间的日志，结果保存为 1.evtx</p><pre><code>wevtutil epl Security 1.evtx &quot;/q:*[System [TimeCreated[@SystemTime &gt;&#39;2023-08-10T03:21:00&#39; or @SystemTime &lt;&#39;2023-08-10T03:20:00&#39;]]]&quot;
</code></pre><p>下面开始将这个文件命名为<code>Security.evtx</code>，将修改后的日志文件覆盖系统原文件，但是直接复制过去不行</p><figure><img src="/DailyNotes/assets/image-20231113135604401-C_2HXiqz.png" alt="image-20231113135604401" tabindex="0" loading="lazy"><figcaption>image-20231113135604401</figcaption></figure><p>应该先结束日志进程</p><figure><img src="/DailyNotes/assets/image-20231113135706597-UDLQ5OPP.png" alt="image-20231113135706597" tabindex="0" loading="lazy"><figcaption>image-20231113135706597</figcaption></figure><p>将修改后的日志文件覆盖系统原文件</p><figure><img src="/DailyNotes/assets/image-20231113134120267-BlN5Wtx-.png" alt="image-20231113134120267" tabindex="0" loading="lazy"><figcaption>image-20231113134120267</figcaption></figure><p>最后重启一下 eventlog，重启步骤参见方法 4 中的停止 eventlog 线程</p><p>如果不想这么麻烦结束进程再重启，使用<strong>EventCleaner</strong>可以实现单条日志清理（项目地址<a href="https://github.com/QAX-A-Team/EventCleaner" target="_blank" rel="noopener noreferrer">EventCleaner<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>）</p><pre><code>EventCleaner closehandle   #释放日志文件句柄(security.evtx)
EventCleaner 100           #删除 event record id 为 100 的日志
EventCleaner suspend       #暂停日志线程,停止日志记录
EventCleaner normal        #恢复日志线程
</code></pre><!----><figure><img src="/DailyNotes/assets/image-20231113130451354-mCRW4VaS.png" alt="image-20231113130451354" tabindex="0" loading="lazy"><figcaption>image-20231113130451354</figcaption></figure><h4 id="_6-windows-日志伪造" tabindex="-1"><a class="header-anchor" href="#_6-windows-日志伪造"><span>6）Windows 日志伪造</span></a></h4><p>使用<code>eventcreate</code>这个命令行工具来伪造日志或者使用自定义的大量垃圾信息覆盖现有日志。</p><pre><code>eventcreate -l system -so administrator -t warning -d &quot;this is a test&quot; -id 500
</code></pre><figure><img src="data:image/png;base64,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" alt="image-20231113145606910" tabindex="0" loading="lazy"><figcaption>image-20231113145606910</figcaption></figure><figure><img src="/DailyNotes/assets/image-20231113145748436-BKHtmi4j.png" alt="image-20231113145748436" tabindex="0" loading="lazy"><figcaption>image-20231113145748436</figcaption></figure><p>伪造一条特殊的事件 ID 的日志，骗取蓝队去溯源，浪费溯源时间。</p><h3 id="_2-3-远程桌面连接日志清理" tabindex="-1"><a class="header-anchor" href="#_2-3-远程桌面连接日志清理"><span>2.3 远程桌面连接日志清理</span></a></h3><p>当使用 3389 端口远程一台机器后会在对应机器上产生对应的记录，其记录只要有两部分组成；</p><h4 id="_1-应用程序和服务日志中的连接记录" tabindex="-1"><a class="header-anchor" href="#_1-应用程序和服务日志中的连接记录"><span>1）应用程序和服务日志中的连接记录</span></a></h4><p><strong>应用程序和服务日志 &gt; Microsoft &gt; Windows &gt; TerminalServices- RemoteConnectionManager</strong>，右键单击**“Operational”<strong>并选择</strong>“筛选当前日志”**。</p><figure><img src="/DailyNotes/assets/image-20231113153423986-C1OdYORk.png" alt="image-20231113153423986" tabindex="0" loading="lazy"><figcaption>image-20231113153423986</figcaption></figure><p>筛选日志</p><figure><img src="/DailyNotes/assets/image-20231113153551638-CEht08Mn.png" alt="image-20231113153551638" tabindex="0" loading="lazy"><figcaption>image-20231113153551638</figcaption></figure><p>依次点击事件即可查看到哪些 IP 来连接过</p><figure><img src="/DailyNotes/assets/image-20231113153722313-BI_8ZOQO.png" alt="image-20231113153722313" tabindex="0" loading="lazy"><figcaption>image-20231113153722313</figcaption></figure><p>可以像前面删除日志一样，直接点清除日志</p><figure><img src="/DailyNotes/assets/image-20231113153952041-ivc9hs82.png" alt="image-20231113153952041" tabindex="0" loading="lazy"><figcaption>image-20231113153952041</figcaption></figure><h4 id="_2-default-rdp-文件-系统隐藏文件" tabindex="-1"><a class="header-anchor" href="#_2-default-rdp-文件-系统隐藏文件"><span>2）Default.rdp 文件 (系统隐藏文件)</span></a></h4><p>删除 Default.rdp 方法</p><pre><code>cd %userprofile%\documents   # 进入Default.rdp所在路径
attrib Default.rdp -s -h     # 使用attrib去掉Default.rdp文件的系统文件属性(S)和隐藏文件属性(H)
del Default.rdp              # 删除del Default.rdp
</code></pre><h4 id="_3-注册表清理方法" tabindex="-1"><a class="header-anchor" href="#_3-注册表清理方法"><span>3）注册表清理方法</span></a></h4><p>主要就是删掉如下部分，Deafult 部分是远程主机 RDP 连接本机的记录，Servers 为本地 RDP 连接远程主机的信息</p><figure><img src="/DailyNotes/assets/image-20231113154959460-DmE-RPv1.png" alt="image-20231113154959460" tabindex="0" loading="lazy"><figcaption>image-20231113154959460</figcaption></figure><p>reg delete 参数说明参数说明</p><pre><code>/v 删除子项下的特定项。如果未指定任何项，则将删除子项下的所有项和子项。
/ve指定仅删除没有值的条目。
/va删除指定子项下的所有条目。不会删除指定子项下的子项。
/f删除现有的注册表子项或条目，而不要求确认。
/?在命令提示符下显示帮助。
</code></pre><p>删除</p><pre><code># 查询远程连接在注册表中的键值
reg query &quot;HKEY_CURRENT_USER\Software\Microsoft\Terminal Server Client\Default&quot;
# 删除对应的键值,如删除MRU0 &quot;/v MRU0&quot;
reg delete &quot;HKEY_CURRENT_USER\Software\Microsoft\Terminal Server Client\Default&quot; /f /v MRU0
也可以将deafult全部删掉
reg delete &quot;HKEY_CURRENT_USER\Software\Microsoft\Terminal Server Client\Default&quot; /va /f
</code></pre><p>如使用当前机器作为跳板 RDP 其他主机的话，需要使用同步骤清理 Servers 下的键值</p><pre><code># 查询具体要删除的键值文件夹
reg query &quot;HKEY_CURRENT_USER\Software\Microsoft\Terminal Server Client\Servers&quot;
# 确定要删除的文件夹进行删除
reg delete &quot;HKEY_CURRENT_USER\Software\Microsoft\Terminal Server Client\Servers\192.168.1.123&quot; /f
</code></pre><h3 id="_2-4-浏览器记录清理" tabindex="-1"><a class="header-anchor" href="#_2-4-浏览器记录清理"><span>2.4 浏览器记录清理</span></a></h3><p>如果使用有隐私模式的浏览器，开启隐私模式可以避免在<strong>本地计算机</strong>留下历史记录、缓存文件和 Cookies。</p><h4 id="_1-ie" tabindex="-1"><a class="header-anchor" href="#_1-ie"><span>1）IE</span></a></h4><table><thead><tr><th>日志类型</th><th>默认路径</th></tr></thead><tbody><tr><td>浏览记录</td><td>C:\Users\xxx\AppData\Local\Microsoft\Windows\History\</td></tr><tr><td>缓存文件</td><td>C:\Users\xxx\AppData\Local\Microsoft\Windows\Temporary Internet Files\</td></tr><tr><td>Cookies</td><td>C:\Users\xxx\AppData\Roaming\Microsoft\Windows\Cookies\</td></tr></tbody></table><p>删除方法一：在浏览器搜索下拉栏中，直接选择删除相应的历史记录 删除方法二：在工具-&gt;Internet 选项-&gt;常规-&gt;浏览历史记录中，选择删除所有浏览历史记录、缓存文件、Cookies</p><h4 id="_2-edge" tabindex="-1"><a class="header-anchor" href="#_2-edge"><span>2）edge</span></a></h4><table><thead><tr><th>日志类型</th><th>默认路径</th></tr></thead><tbody><tr><td>浏览记录</td><td>C:\Users\xxx\AppData\Local\Microsoft\Edge\User Data\Default\history</td></tr><tr><td>缓存文件</td><td>C:\Users\xxxAppData\Local\Microsoft\Edge\User Data\Default\Cache\</td></tr><tr><td>Cookies</td><td>C:\Users\xxx\AppData\Local\Microsoft\Edge\User Data\DefaultCookies</td></tr></tbody></table><p>删除方法：地址栏访问<code>edge://settings/privacy</code>，在<code>清除浏览数据</code>中选择要清除的内容</p><h4 id="_2-chrome" tabindex="-1"><a class="header-anchor" href="#_2-chrome"><span>2）Chrome</span></a></h4><p>在浏览器搜索栏中输入 chrome://version/，可以看到个人资料路径</p><table><thead><tr><th>日志类型</th><th>默认路径</th></tr></thead><tbody><tr><td>浏览记录</td><td>C:\Users\xxx\AppData\Local\Google\Chrome\User Data\Default\history</td></tr><tr><td>缓存文件</td><td>C:\Users\xxx\AppData\Local\Google\Chrome\User Data\Default\Cache\</td></tr><tr><td>Cookies</td><td>C:\Users\xxx\AppData\Local\Google\Chrome\User Data\Default\Cookies</td></tr></tbody></table><p>删除方法一：在浏览器搜索栏中输入 chrome://history/，选择删除单条浏览记录 删除方法二：在设置-&gt;隐私设置和安全性中，或在搜索栏输入 chrome://history/后选择清除浏览数据，选择删除特定时间范围的浏览历史记录、缓存文件、Cookies</p><h4 id="_3-firefox" tabindex="-1"><a class="header-anchor" href="#_3-firefox"><span>3）Firefox</span></a></h4><p>在浏览器搜索栏中输入 about:cache，可以看到缓存文件的磁盘存储路径</p><table><thead><tr><th>日志类型</th><th>默认路径</th></tr></thead><tbody><tr><td>浏览记录</td><td>C:\Users\xxx\AppData\Roaming\Mozilla\Firefox\Profiles\70rs4c5d.default-release\places.sqlite</td></tr><tr><td>缓存文件</td><td>C:\Users\xxx\AppData\Local\Mozilla\Firefox\Profiles\70rs4c5d.default-release\cache2\</td></tr><tr><td>Cookies</td><td>C:\Users\xxx\AppData\Roaming\Mozilla\Firefox\Profiles\afn7ww6q.default-release\cookies.sqlite</td></tr></tbody></table><p>删除方法一：在 Library-&gt;History-&gt;Recent History 栏中右键删除特定的浏览记录 删除方法二：在 Library-&gt;History-&gt;Clear Recent History，或在 Options-&gt;Privacy &amp; Security 中选择 Clear History，删除指定时间范围的历史记录</p><h3 id="_2-5-命令行-history-清理" tabindex="-1"><a class="header-anchor" href="#_2-5-命令行-history-清理"><span>2.5 命令行 history 清理</span></a></h3><h4 id="_1-powershell" tabindex="-1"><a class="header-anchor" href="#_1-powershell"><span>1）powershell</span></a></h4><p>以 5.1.19041.2673 版本为例，以下不需要管理员权限：</p><p>利用 Readline 查看历史记录，输入如下命令可以查看历史记录功能：</p><pre><code>Get-PSReadlineKeyHandler
</code></pre><figure><img src="/DailyNotes/assets/image-20231113165825620-CwP-YNiz.png" alt="image-20231113165825620" tabindex="0" loading="lazy"><figcaption>image-20231113165825620</figcaption></figure><p>如下命令只能查看到当前窗口的历史命令，</p><pre><code>Get-History
history
</code></pre><p>可以这样获得 PSReadline 保存的历史记录</p><pre><code>Get-Content (Get-PSReadlineOption).HistorySavePath
</code></pre><figure><img src="/DailyNotes/assets/image-20231113170203703-Mf2cTZZw.png" alt="image-20231113170203703" tabindex="0" loading="lazy"><figcaption>image-20231113170203703</figcaption></figure><p>当前窗口的 history 删掉删除，用<code>clear-history</code>即可，<code>Clear-History</code> 不会清除 <code>PSReadLine</code> 命令历史记录文件。</p><figure><img src="/DailyNotes/assets/image-20231110105202058-D0-Ovcp8.png" alt="image-20231110105202058" tabindex="0" loading="lazy"><figcaption>image-20231110105202058</figcaption></figure><p>其他 <code>Clear-History</code> 命令可参考<a href="https://learn.microsoft.com/zh-cn/powershell/module/Microsoft.PowerShell.Core/Clear-History?view=powershell-5.1" target="_blank" rel="noopener noreferrer">Clear-History (Microsoft.PowerShell.Core) - PowerShell | Microsoft Learn<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p><p><code>PSReadLine</code> 模块存储一个历史记录文件，其中包含每个 PowerShell 会话中的每个 PowerShell 命令。 在 PowerShell 提示符下，使用键盘上的向上和向下箭头滚动命令历史记录。</p><pre><code>Remove-Item (Get-PSReadlineOption).HistorySavePath
</code></pre><figure><img src="/DailyNotes/assets/image-20231113171502550-DIAnU35e.png" alt="image-20231113171502550" tabindex="0" loading="lazy"><figcaption>image-20231113171502550</figcaption></figure><p>还可以通过如下命令删除 history 文件</p><pre><code>del $env:appdata\Microsoft\Windows\PowerShell\PSReadLine\ConsoleHost_history.txt
</code></pre><h4 id="_2-cmd" tabindex="-1"><a class="header-anchor" href="#_2-cmd"><span>2）cmd</span></a></h4><p>默认情况下，cmd 只显示最近使用的命令历史记录。输入如下命令，只能查看到当前窗口的 history，新开一个窗口就看不见原来的命令了</p><pre><code>doskey /history
</code></pre><figure><img src="data:image/png;base64,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" alt="image-20231110132017193" tabindex="0" loading="lazy"><figcaption>image-20231110132017193</figcaption></figure><h3 id="_2-6-其他" tabindex="-1"><a class="header-anchor" href="#_2-6-其他"><span>2.6 其他</span></a></h3><h4 id="_1-文件路径访问记录" tabindex="-1"><a class="header-anchor" href="#_1-文件路径访问记录"><span>1）文件路径访问记录</span></a></h4><p>在资源管理器中输入一个路径并跳转后</p><figure><img src="/DailyNotes/assets/image-20231113162050683-dQzHqMDV.png" alt="image-20231113162050683" tabindex="0" loading="lazy"><figcaption>image-20231113162050683</figcaption></figure><p>留下这样的注册表</p><figure><img src="/DailyNotes/assets/image-20231113162020393-CXhVcfo8.png" alt="image-20231113162020393" tabindex="0" loading="lazy"><figcaption>image-20231113162020393</figcaption></figure><h4 id="_2-最近访问记录" tabindex="-1"><a class="header-anchor" href="#_2-最近访问记录"><span>2）最近访问记录</span></a></h4><p>我的电脑或资源管理器中，选择<code>查看-&gt;选项-&gt;常规</code>中，将隐私一栏的“快速访问”两个选项去掉，并选择清除历史记录。（这里以 win10 举例，win7 在我的电脑或资源管理器中，在最近访问位置<code>右键-&gt;删除最近项目列表</code>）</p><figure><img src="/DailyNotes/assets/image-20231113162231515-BK9vUMrq.png" alt="image-20231113162231515" tabindex="0" loading="lazy"><figcaption>image-20231113162231515</figcaption></figure><h4 id="_3-win-r-运行记录" tabindex="-1"><a class="header-anchor" href="#_3-win-r-运行记录"><span>3）Win+R 运行记录</span></a></h4><p>对应注册表项为<code>HKEY_CURRENT_USER\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\RunMRU</code></p><figure><img src="/DailyNotes/assets/image-20231113162602738-B-Ru_6re.png" alt="image-20231113162602738" tabindex="0" loading="lazy"><figcaption>image-20231113162602738</figcaption></figure><h2 id="_3-linux-痕迹清理" tabindex="-1"><a class="header-anchor" href="#_3-linux-痕迹清理"><span>3. Linux 痕迹清理</span></a></h2><blockquote><p><a href="https://www.cnblogs.com/liulianzhen99/articles/17568498.html" target="_blank" rel="noopener noreferrer">Linux 清理痕迹的一些方法 - 寻梦 99 - 博客园 (cnblogs.com)<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p><p><a href="https://blog.csdn.net/Captain_RB/article/details/111653887" target="_blank" rel="noopener noreferrer">Linux 痕迹清除技术_Captain_RB 的博客-CSDN 博客<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p></blockquote><h3 id="_3-1-删除-history-记录" tabindex="-1"><a class="header-anchor" href="#_3-1-删除-history-记录"><span>3.1 删除 History 记录</span></a></h3><p>History 记录原理：当前 shell 执行的命令记录放置在缓存中，<code>history</code>命令查看的也是缓存中的命令，当 exit 退出时系统会将缓存的命令写入 history 文件<code>~/.bash_history</code>，可使用<code>history -a</code>命令来将内存中的记录强制写入文件。如果在 shell 运行过程中 kill 掉其进程，则缓存命令不会写入 history。</p><p>个人理解：<code>~/.bash_history</code>默认只保存最近的 1000 条记录，<code>history</code>命令执行后看到的是<code>~/.bash_history</code>中保存的命令和当前 shell 执行过的命令，如果不注销或者关机，那么执行<code>history</code>看到的记录可能大于 1000。</p><figure><img src="/DailyNotes/assets/image-20231114100701996-DejID3h-.png" alt="image-20231114100701996" tabindex="0" loading="lazy"><figcaption>image-20231114100701996</figcaption></figure><h4 id="_1-部分删除" tabindex="-1"><a class="header-anchor" href="#_1-部分删除"><span>1）部分删除</span></a></h4><p><strong>方法一</strong>：在执行命令前加上空格，这样命令就不会被记录。这种方法在配置环境变量<code>$HISTCONTROL=ignoreboth</code>条件下有效 (缺省配置)，如果没有该项配置，将其加到配置脚本中<code>echo HISTCONTROL=ignorespace &gt;&gt; ~/.bashrc</code>，然后运行<code>source ~/.bashrc</code>即可。 <img src="/DailyNotes/assets/image-20231113181217590-Cqhyuxml.png" alt="image-20231113181217590" loading="lazy"></p><p><strong>方法二</strong>：设置当前 session 不再记录历史命令：<code>set +o history</code>，在执行该命令之前的命令仍然会记录，不会删除 history 文件中的记录，恢复记录历史命令：<code>set -o history</code>。</p><p><strong>方法三</strong>：清除当前 session 缓存的命令记录：<code>history -c</code>，history 命令本身不会被记录，但执行该命令之后的命令仍然会记录，所以要在退出前运行，不会删除.bash_history 文件中的记录。</p><p><strong>方法四</strong>：清除当前 session 缓存的命令记录：<code>unset HISTORY HISTFILE HISTSAVE HISTZONE HISTLOG</code>，无论在执行该命令之前还是之后的命令都不会被记录，且 unset 命令本身也不会被记录，不会删除.bash_history 文件中的记录。</p><p><strong>方法五</strong>：vim 修改<code>.bash_history</code>文件，可以在执行完<code>vi/vim</code>命令后，利用 vim 分屏修改历史</p><h4 id="_2-全部删除" tabindex="-1"><a class="header-anchor" href="#_2-全部删除"><span>2）全部删除</span></a></h4><p><strong>方法一</strong>：删除当前用户 history 文件<code>~/.bash_history</code>中的记录，结合如下命令可完全清理:</p><pre><code>rm -rf ~.bash_history
history -c
exit
</code></pre><p>再次登录进来只能看到一条 exit 的记录</p><p><strong>方法二</strong>：设置环境变量，添加对历史命令记录数量的限制：<code>HISTSIZE=0</code>，以及对 history 文件<code>.bash_history</code>行数的限制：<code>HISTFILESIZE=0。</code></p><p>在当前 shell 中直接输入命令<code>HISTSIZE=0 &amp;&amp; HISTFILESIZE=0</code>，这样会将缓存的 history 记录和<code>~/.bash_history</code>中的记录全部清空；</p><p>如果在<code>~/.bashrc</code>初始化文件中添加命令：<code>HISTSIZE=0 &amp;&amp; HISTFILESIZE=0</code>，这样每次开启 shell 都不会再记录 history 命令。</p><h3 id="_3-2-删除日志文件" tabindex="-1"><a class="header-anchor" href="#_3-2-删除日志文件"><span>3.2 删除日志文件</span></a></h3><h4 id="_1-linux-日志文件" tabindex="-1"><a class="header-anchor" href="#_1-linux-日志文件"><span>1）Linux 日志文件</span></a></h4><p>Linux 中的日志一般分<strong>系统日志</strong>和<strong>应用日志</strong>两种</p><h5 id="系统日志" tabindex="-1"><a class="header-anchor" href="#系统日志"><span>系统日志</span></a></h5><p>Linux 中有多种系统日志，记录主机运行和用户登录情况（记录系统日志，老版本操作系统使用 syslog，CentOS6、Ubuntu18 及以后使用 rsyslog）</p><blockquote><p>rsyslog 相关知识可以参考<a href="https://www.cnblogs.com/duanxz/p/3578194.html" target="_blank" rel="noopener noreferrer">syslog 之一：Linux syslog 日志系统详解 - duanxz - 博客园 (cnblogs.com)<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p></blockquote><p>通过如下命令查看系统日志记录在哪，大部分日志记录在<code>/var/log/messages</code>（不想保存在默认位置可以改<code>/etc/rsyslog.conf</code>文件）</p><pre><code>grep -Ev &quot;^$|^#&quot; /etc/rsyslog.conf
</code></pre><figure><img src="/DailyNotes/assets/image-20231125220753749-CRDdCi7w.png" alt="image-20231125220753749" tabindex="0" loading="lazy"><figcaption>image-20231125220753749</figcaption></figure><p><strong><code>/var/log/messages</code>：记录系统启动后的信息和错误日志</strong></p><figure><img src="/DailyNotes/assets/image-20231125193432577-CqIUEHqo.png" alt="image-20231125193432577" tabindex="0" loading="lazy"><figcaption>image-20231125193432577</figcaption></figure><ul><li>时间标签：消息发出的日期时间</li><li>主机名：生产消息的计算机的名称</li><li>子系统名称：发出消息的应用程序的名称</li><li>消息：消息级别的具体内容</li></ul><p>rsyslog 共有 8 种日志级别</p><table><thead><tr><th>级别</th><th>英文表示</th><th>意义</th></tr></thead><tbody><tr><td>0</td><td>EMERG (紧急)</td><td>导致主机系统不可用的情况</td></tr><tr><td>1</td><td>ALERT (警告)</td><td>必须马上采取解决措施</td></tr><tr><td>2</td><td>CRIT (严重)</td><td>比较严重的情况</td></tr><tr><td>3</td><td>ERR (错误)</td><td>运行出现错误</td></tr><tr><td>4</td><td>WARNING (提醒)</td><td>提醒用户的重要事件</td></tr><tr><td>5</td><td>NOTICE (注意)</td><td>不会儿影响系统，提醒用户</td></tr><tr><td>6</td><td>INFO (信息)</td><td>般信息</td></tr><tr><td>7</td><td>DEBUG (调式)</td><td>程序调式</td></tr><tr><td>8</td><td>None (没有)</td><td>不做记录</td></tr></tbody></table><p>例如查看出现的重大的错误</p><pre><code>grep -E -iw &quot;emerg|alert|critical|error&quot; /var/log/messages
</code></pre><figure><img src="/DailyNotes/assets/image-20231125222031060-CQm8TP7F.png" alt="image-20231125222031060" tabindex="0" loading="lazy"><figcaption>image-20231125222031060</figcaption></figure><p>rsyslog 日志服务是一个常会被攻击的目标,破坏了它将使运维员很难发现入侵及入侵的痕,因此要特别注意监控其守护进程及配置文件。</p><p><strong><code>/var/log/cron</code> ：Crond 周期性计划任务产生的时间信息</strong></p><figure><img src="/DailyNotes/assets/image-20231125221435781-D7w_Mhnh.png" alt="image-20231125221435781" tabindex="0" loading="lazy"><figcaption>image-20231125221435781</figcaption></figure><p><strong><code>/var/log/dmesg</code> ：引导过程中的各种时间信息</strong></p><p><strong><code>/var/log/secure</code> (centos)或 <code>/var/log/auth.log</code> (kali)：记录与安全相关的日志信息，涉及使用账户和密码登录的程序都会记录</strong></p><p><img src="/DailyNotes/assets/image-20231125192327878-W4LNgxog.png" alt="image-20231125192327878" loading="lazy"><img src="/DailyNotes/assets/image-20231125191252119-dIGGe5s6.png" alt="image-20231125191252119" loading="lazy"></p><h5 id="用户日志" tabindex="-1"><a class="header-anchor" href="#用户日志"><span>用户日志</span></a></h5><p><strong><code>/var/log/btmp</code>：记录所有用户错误登录信息，二进制文件， 使用<code>lastb</code>命令查看</strong></p><figure><img src="/DailyNotes/assets/image-20231125190613401-BjFsSg3D.png" alt="image-20231125190613401" tabindex="0" loading="lazy"><figcaption>image-20231125190613401</figcaption></figure><p><strong><code>/var/log/wtmp</code>：记录所有用户成功登录、注销信息，二进制文件，使用<code>last</code>命令查看</strong></p><figure><img src="/DailyNotes/assets/image-20231125190849726-BcRwjDdZ.png" alt="image-20231125190849726" tabindex="0" loading="lazy"><figcaption>image-20231125190849726</figcaption></figure><p><strong><code>/run/utmp</code>：记录当前已经登录的用户信息，二进制文件，使用<code>w</code>、<code>who</code>、<code>users</code>等命令查看</strong></p><figure><img src="/DailyNotes/assets/image-20231125191056842-BOcFOhHS.png" alt="image-20231125191056842" tabindex="0" loading="lazy"><figcaption>image-20231125191056842</figcaption></figure><p><strong><code>/var/log/lastlog</code>：记录所有用户最后一次的登录时间的曰志，二进制文件，使用<code>lastlog</code>命令查看（并不需要 root 权限）</strong></p><p><img src="/DailyNotes/assets/image-20231125192755531-gx_PJDQn.png" alt="image-20231125192755531" loading="lazy"><img src="/DailyNotes/assets/image-20231125192939898-7r_Mkigl.png" alt="image-20231125192939898" loading="lazy"></p><h5 id="应用日志" tabindex="-1"><a class="header-anchor" href="#应用日志"><span>应用日志</span></a></h5><p>Linux 中绝大多数应用日志默认路径都在/var/log/目录下，比如：</p><pre><code># apache
/var/log/apache2/access.log
/var/log/apache2/error.log
# nginx
/var/log/nginx/access.log
/var/log/nginx/error.log
# mysql
/var/log/mysql/error.log
# es
/var/log/elasticsearch/&lt;cluster name&gt;.log
# mongo
/var/log/mongodb/mongod.log
# postgresql
/var/log/postgresql/postgresql-&lt;version&gt;-main.log
/var/log/postgresql/postgresql-&lt;version&gt;-&lt;database name&gt;.log
</code></pre><p>root 权限直接可以查看并删改，而且不需要停止当前应用运行的服务，日志的删改方法都是相同的</p><h4 id="_2-部分删除" tabindex="-1"><a class="header-anchor" href="#_2-部分删除"><span>2）部分删除</span></a></h4><p>对于<strong>文本格式的日志文件</strong>，可以直接进入文件进行删改，也可以利用流编辑命令 sed 删除文件中匹配的行：</p><pre><code># 删除所有匹配到字符串的行，比如自己的登录ip
sed -i &#39;/ip/&#39;d /var/log/messages
sed -i &#39;/ip/&#39;d .bash_history
# 全局替换登录IP地址：
sed -i &#39;s/ip1/ip2/g&#39; /var/log/auth.log
</code></pre><p>例如<code>.bash_history</code>文件中有反弹 shell 的记录</p><figure><img src="/DailyNotes/assets/image-20231125195605438-DDDaw3YO.png" alt="image-20231125195605438" tabindex="0" loading="lazy"><figcaption>image-20231125195605438</figcaption></figure><pre><code>sed -i &#39;/192.168.1.188/&#39;d .bash_history
</code></pre><figure><img src="/DailyNotes/assets/image-20231125195839131-636Y_wdM.png" alt="image-20231125195839131" tabindex="0" loading="lazy"><figcaption>image-20231125195839131</figcaption></figure><p>或者可以这样，先通过 grep 取反把自己的敏感字剔除出去保存个新文件，然后将内容替换到日志文件中</p><pre><code>cat /var/log/nginx/access.log | grep -v evil.php &gt; tmp.log
cat tmp.log &gt; /var/log/nginx/access.log/
rm tmp.log
</code></pre><p>对于<strong>二进制日志文件</strong>，部分删除需要使用<code>utmpdump</code>命令，<code>utmpdump</code>可以将<code>wtmp</code>和<code>utmp</code>转换为文本文件，将文本文件编辑修改后恢复成二进制文件即可，如下面针对<code>wtmp</code>进行修改：</p><pre><code># 将二进制日志文件转换为可编辑的文本文件
utmpdump /var/log/wtmp &gt;/var/log/wtmp.file
# 对文本文件进行编辑和修改，例如
sed -i &#39;/192.168.1.4/&#39;d /var/log/wtmp.file
# 将编辑修改后的文本文件转换为二进制日志文件
utmpdump -r &lt; /var/log/wtmp.file &gt; /var/log/wtmp
</code></pre><h4 id="_3-全部删除" tabindex="-1"><a class="header-anchor" href="#_3-全部删除"><span>3）全部删除</span></a></h4><p>直接<code>rm -rf </code>可能有些文件删不掉或影响某些服务的正常运行，可以将日志文件全部删除即将空字符写入日志文件。不留下任何痕迹，但是特征也很明显，容易被察觉，一般不推荐使用。需要 root 权限，有五种命令可以实现：</p><pre><code>cat /dev/null &gt; filename
: &gt; filename
&gt;  filename
echo &quot;&quot; &gt; filename
echo &gt; filename
</code></pre><p>区别：前三种命令清空文件后文件大小为 0，后两种命令清空文件后会留下一个换行符，文件大小为 1byte。</p><h3 id="_3-3-其他" tabindex="-1"><a class="header-anchor" href="#_3-3-其他"><span>3.3 其他</span></a></h3><h4 id="_1-ssh-隐藏登录" tabindex="-1"><a class="header-anchor" href="#_1-ssh-隐藏登录"><span>1）ssh 隐藏登录</span></a></h4><p>从应用层面通过参数选择隐藏记录，如 ssh 远程隐藏登录：</p><p>登录时不分配伪终端，不会记录在 utmp、wtmp、btmp 中，不会被 w、who、users、last、lastb 命令发现：</p><pre><code>ssh -T root@192.168.126.1 /bin/bash -i
-T：不分配伪终端
-i：bash的参数，表示交互式shell
</code></pre><figure><img src="/DailyNotes/assets/image-20231125212117581-Be82x4Hu.png" alt="image-20231125212117581" tabindex="0" loading="lazy"><figcaption>image-20231125212117581</figcaption></figure><p>w 命令查看当前登录用户，可以看到没有发现上面的 root 用户，只有 ps 查看进程才能看到</p><figure><img src="/DailyNotes/assets/image-20231125212412324-CMe_ojc4.png" alt="image-20231125212412324" tabindex="0" loading="lazy"><figcaption>image-20231125212412324</figcaption></figure><p>登录时不将 ssh 公钥保存在本地<code>.ssh</code>目录中：</p><pre><code>ssh -o UserKnownHostsFile=/dev/null -T root@192.168.126.2 /bin/bash –i
-o：options选择信息
</code></pre><!----><h4 id="_2-文件时间修改" tabindex="-1"><a class="header-anchor" href="#_2-文件时间修改"><span>2）文件时间修改</span></a></h4><p>比如一些木马文件或其它文件想修改下时间，防止引起管理员注意，则可以使用 touch 命令修改，查看一个文件的时间可以用 stat 命令。</p><pre><code>stat test.txt
</code></pre><p>这个命令会显示三个时间，一个最近访问时间，一个最近修改时间，一个最近改动时间。<strong>访问时间</strong>用<code>-a</code>参数可以改，<strong>修改时间</strong>用<code>-m</code>参数可以改，<strong>改动时间</strong>不可以改，因为改动时间是系统自动更新的，包含了元数据的改动。</p><pre><code>touch -a -d &quot;2023-02-02 11:10:20.000235123&quot; test.txt
touch -m -d &quot;2023-02-02 12:10:20.010242137&quot; test.txt
</code></pre><p><code>-d</code>参数指定你要修改的时间，点后面是时间戳，随意输入就可以，不要为一串零，容易引起怀疑。</p><blockquote><p>关于这三个时间的区别<a href="https://blog.csdn.net/qq_42453713/article/details/125465337#" target="_blank" rel="noopener noreferrer">Linux 文件最近访问、最近更改、最近改动时间说明<em>linux 最近更改和最近改动</em>印特的博客-CSDN 博客<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p></blockquote><p>至于那个不能修改的<strong>改动时间</strong>，非要改动，思路就是先改动系统时间，然后修改目标文件，最后再恢复系统时间即可。</p><pre><code># date修改系统时间，s参数指定时间
date -s &quot;20230201 16:43:53&quot;
# touch还是用来修改文件时间，r是指定参考文件（任意指定就可以），意思是把指定的参考文件时间赋给目标文件
touch -r ~/.bashrc test.txt
# hwclock是指的硬件中的时间，hctosys意思是把硬件时间同步给系统
hwclock --hctosys
</code></pre><h4 id="_3-文件擦除" tabindex="-1"><a class="header-anchor" href="#_3-文件擦除"><span>3）文件擦除</span></a></h4><p>当担心目标利用一些恢复软件来恢复已经删除的文件，则可以去彻底删除，也就是通过多次对一个文件进行写入擦除操作，导致无法还原已有的内容。<code>shred</code>示例如下：</p><pre><code>shred -f -u -z -v -n 8 test.txt
</code></pre><p><code>-f</code>是强制的意思，即使文件只读没权限也会进行覆盖。</p><p><code>-u</code>在覆盖完成后进行删除。</p><p><code>-z</code>是覆盖完成后进行一次填充操作，避免文件存在信息泄露。</p><p><code>-v</code>是显示执行的详细信息。</p><p><code>-n</code>指覆盖次数，上面例子是 8 次。</p><p>原理和前面 windows 的 2.2 节的删除日志文件部分的<a href="#####%E7%9B%B4%E6%8E%A5%E5%88%A0%E9%99%A4%E6%96%87%E4%BB%B6">直接删除文件</a>相同。</p></div><!--[--><!----><!--]--><footer class="page-meta"><div class="meta-item edit-link"><a href="https://github.com/echo0d/DailyNotes/edit/main/src/CyberSecurity/RedTeam/6-Emergency/TracesRemoval.md" rel="noopener noreferrer" target="_blank" aria-label="在 GitHub 上编辑此页" class="nav-link label"><!--[--><svg xmlns="http://www.w3.org/2000/svg" class="icon edit-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="edit icon"><path d="M430.818 653.65a60.46 60.46 0 0 1-50.96-93.281l71.69-114.012 7.773-10.365L816.038 80.138A60.46 60.46 0 0 1 859.225 62a60.46 60.46 0 0 1 43.186 18.138l43.186 43.186a60.46 60.46 0 0 1 0 86.373L588.879 565.55l-8.637 8.637-117.466 68.234a60.46 60.46 0 0 1-31.958 11.229z"></path><path d="M728.802 962H252.891A190.883 190.883 0 0 1 62.008 771.98V296.934a190.883 190.883 0 0 1 190.883-192.61h267.754a60.46 60.46 0 0 1 0 120.92H252.891a69.962 69.962 0 0 0-69.098 69.099V771.98a69.962 69.962 0 0 0 69.098 69.098h475.911A69.962 69.962 0 0 0 797.9 771.98V503.363a60.46 60.46 0 1 1 120.922 0V771.98A190.883 190.883 0 0 1 728.802 962z"></path></svg><!--]-->在 GitHub 上编辑此页<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!----></a></div><div class="meta-item git-info"><div class="update-time"><span class="label">上次编辑于: </span><!----></div><div class="contributors"><span class="label">贡献者: </span><!--[--><!--[--><span class="contributor" title="email: echo0d@163.com">echo0d</span><!--]--><!--]--></div></div></footer><nav class="vp-page-nav"><a class="route-link nav-link prev" href="/DailyNotes/CyberSecurity/RedTeam/6-Emergency/Tamper.html" aria-label="网站篡改"><div class="hint"><span class="arrow start"></span>上一页</div><div class="link"><!---->网站篡改</div></a><!----></nav><!----><!--[--><!----><!--]--><!--]--></main><!--]--><footer class="vp-footer-wrapper"><div class="vp-footer">听君一席话，如听一席话</div><div class="vp-copyright">Copyright © 2025 echo0d </div></footer></div><!--]--><!--[--><!----><!----><!--]--><!--]--></div>
    <script type="module" src="/DailyNotes/assets/app-ClR9AqGF.js" defer></script>
  </body>
</html>
