import{_ as l}from"./plugin-vue_export-helper-DlAUqK2U.js";import{c as r,a as t,b as o,d as i,e as n,r as s,o as c}from"./app-BLgHyi2a.js";const p="/DailyNotes/assets/CVE_2018_2894_1--_479Zio.png",g="/DailyNotes/assets/01-f66Zm1aM.png",d="/DailyNotes/assets/02-CvYKpKR4.png",h="/DailyNotes/assets/03-CT9tZbPd.png",b="/DailyNotes/assets/06-CiIxthAl.png",u="/DailyNotes/assets/04-CXeb6yzA.png",m="/DailyNotes/assets/05-D-a8Mesl.png",f={},_={href:"http://www.cnnvd.org.cn/index.html",target:"_blank",rel:"noopener noreferrer"},y={href:"http://ip:7001/ws_utc/config.do",target:"_blank",rel:"noopener noreferrer"};function w(x,e){const a=s("ExternalLinkIcon");return c(),r("div",null,[e[4]||(e[4]=t("h1",{id:"漏洞名称-weblogic-任意文件上传漏洞",tabindex:"-1"},[t("a",{class:"header-anchor",href:"#漏洞名称-weblogic-任意文件上传漏洞"},[t("span",null,"漏洞名称：Weblogic 任意文件上传漏洞")])],-1)),e[5]||(e[5]=t("h2",{id:"漏洞介绍",tabindex:"-1"},[t("a",{class:"header-anchor",href:"#漏洞介绍"},[t("span",null,"漏洞介绍")])],-1)),t("p",null,[t("a",_,[e[0]||(e[0]=i("国家信息安全漏洞库 (cnnvd.org.cn)",-1)),n(a)])]),e[6]||(e[6]=o('<p>CNCERT 发现了 Oracle 公司出品的基于 JavaEE 结构的中间件 WebLogic 产品存在一个远程上传漏洞，并得到了厂商的确认，危害程度评分高达 9.8 分。WebLogic 管理端未授权的两个页面存在任意上传 getshell 漏洞，可直接获取权限。两个页面分别为<code>/ws_utc/begin.do</code>和<code>/ws_utc/config.do</code></p><h3 id="漏洞危害" tabindex="-1"><a class="header-anchor" href="#漏洞危害"><span>漏洞危害</span></a></h3><p>WebLogic 管理端未授权的两个页面存在任意上传 getshell 漏洞，可直接获取权限。</p><hr><h3 id="影响范围" tabindex="-1"><a class="header-anchor" href="#影响范围"><span>影响范围</span></a></h3><ul><li>weblogic 10.3.6.0</li><li>weblogic 12.1.3.0</li><li>weblogic 12.2.1.2</li><li>weblogic 12.2.1.3</li></ul><hr><h2 id="漏洞原理" tabindex="-1"><a class="header-anchor" href="#漏洞原理"><span>漏洞原理</span></a></h2>',8)),t("p",null,[e[2]||(e[2]=i("CVE-2020-2894 是基于 JavaEE 结构的中间件 WebLogic 产品的一个远程上传漏洞，两个页面分为/ws_utc/begin.do 和/ws_utc/config.do。访问 ",-1)),t("a",y,[e[1]||(e[1]=i("http://IP:7001/ws_utc/config.do",-1)),n(a)]),e[3]||(e[3]=i(" 页面后点击左侧的“安全”菜单，添加一个 Keystore，任意设置名字和密码，文件也是任意格式上传。但 Web Service Test Page 在“生产模式”下默认不开启，所以该漏洞有一定限制。",-1))]),e[7]||(e[7]=o('<hr><h2 id="漏洞利用" tabindex="-1"><a class="header-anchor" href="#漏洞利用"><span>漏洞利用</span></a></h2><hr><h3 id="靶机环境" tabindex="-1"><a class="header-anchor" href="#靶机环境"><span>靶机环境</span></a></h3><p>vulhub/weblogic/CVE-2018-2894</p><figure><img src="'+p+'" alt="CVE_2018_2894_1" tabindex="0" loading="lazy"><figcaption>CVE_2018_2894_1</figcaption></figure><hr><h3 id="利用方式" tabindex="-1"><a class="header-anchor" href="#利用方式"><span>利用方式</span></a></h3><p>工具：weblogicScanner https://github.com/0xn0ne/weblogicScanner，vulmap</p><h4 id="探测确认" tabindex="-1"><a class="header-anchor" href="#探测确认"><span>探测确认</span></a></h4><p>使用 weblogicScanner 探测是否存在该漏洞</p><figure><img src="'+g+`" alt="01" tabindex="0" loading="lazy"><figcaption>01</figcaption></figure><p>​ <strong>结果</strong>：发现漏洞</p><h4 id="利用过程" tabindex="-1"><a class="header-anchor" href="#利用过程"><span>利用过程</span></a></h4><ul><li>访问 http://your-ip:7001/console 页面，因为是靶场环境，且 Web Service Test Page 在“生产模式”下默认不开启，所以该漏洞有一定限制。在这里通过靶场自带的命令可以获得登录密码，并登录。</li></ul><pre><code>docker-compose logs | grep password
</code></pre><figure><img src="`+d+`" alt="02" tabindex="0" loading="lazy"><figcaption>02</figcaption></figure><p>例如我这里用户名为 weblogic 密码 dHIM3xnc</p><ul><li><p>在后台页面左侧“域结构”中点击“base_domain”，在右侧下滑页面中点击“高级”-“启用 Web 服务测试页”，然后保存。</p></li><li><p>访问 http://IP:7001/ws_utc/config.do 页面，并修改“Work Home Dir”为如下目录提交</p></li></ul><pre><code>/u01/oracle/user_projects/domains/base_domain/servers/AdminServer/tmp/_WL_internal/com.oracle.webservices.wls.ws-testclient-app-wls/4mcj4y/war/css
</code></pre><p>P.S. 这样设置的目的是将目录设置为“ws_utc”应用的 css 静态文件目录，而访问这个目录是不需要权限的。这也是该漏洞能够成功利用的关键</p><figure><img src="`+h+'" alt="03" tabindex="0" loading="lazy"><figcaption>03</figcaption></figure><ul><li>在上一个页面的左侧点击安全-添加，上传蚁剑 jsp 木马</li></ul><figure><img src="'+b+'" alt="06" tabindex="0" loading="lazy"><figcaption>06</figcaption></figure><ul><li>上传之后，在响应包中查看时间戳</li></ul><p>使用蚁剑连接：<code>http://your_ip:7001/ws_utc/css/config/keystore/[时间戳]_[文件名]</code></p><figure><img src="'+u+'" alt="04" tabindex="0" loading="lazy"><figcaption>04</figcaption></figure><figure><img src="'+m+'" alt="05" tabindex="0" loading="lazy"><figcaption>05</figcaption></figure><hr><h2 id="威胁防护建议" tabindex="-1"><a class="header-anchor" href="#威胁防护建议"><span>威胁防护建议</span></a></h2><p>1.设置 Config.do、begin.do 页面登录授权后访问；</p><p>2.IPS 等防御产品可以加入相应的特征；</p><p>3.升级到官方最新版本。</p>',33))])}const W=l(f,[["render",w]]),E=JSON.parse('{"path":"/CyberSecurity/RedTeam/2-WebVulnerability/Weblogic/weblogic_CVE-2018-2894.html","title":"漏洞名称：Weblogic 任意文件上传漏洞","lang":"zh-CN","frontmatter":{"category":"网络安全","tag":"漏洞分析","description":"漏洞名称：Weblogic 任意文件上传漏洞 漏洞介绍 国家信息安全漏洞库 (cnnvd.org.cn) CNCERT 发现了 Oracle 公司出品的基于 JavaEE 结构的中间件 WebLogic 产品存在一个远程上传漏洞，并得到了厂商的确认，危害程度评分高达 9.8 分。WebLogic 管理端未授权的两个页面存在任意上传 getshell 漏...","head":[["meta",{"property":"og:url","content":"https://echo0d.github.io/DailyNotes/CyberSecurity/RedTeam/2-WebVulnerability/Weblogic/weblogic_CVE-2018-2894.html"}],["meta",{"property":"og:site_name","content":"echo0d-notes"}],["meta",{"property":"og:title","content":"漏洞名称：Weblogic 任意文件上传漏洞"}],["meta",{"property":"og:description","content":"漏洞名称：Weblogic 任意文件上传漏洞 漏洞介绍 国家信息安全漏洞库 (cnnvd.org.cn) CNCERT 发现了 Oracle 公司出品的基于 JavaEE 结构的中间件 WebLogic 产品存在一个远程上传漏洞，并得到了厂商的确认，危害程度评分高达 9.8 分。WebLogic 管理端未授权的两个页面存在任意上传 getshell 漏..."}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:locale","content":"zh-CN"}],["meta",{"property":"og:updated_time","content":"2025-06-04T09:27:16.000Z"}],["meta",{"property":"article:author","content":"echo0d"}],["meta",{"property":"article:tag","content":"漏洞分析"}],["meta",{"property":"article:modified_time","content":"2025-06-04T09:27:16.000Z"}],["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"漏洞名称：Weblogic 任意文件上传漏洞\\",\\"image\\":[\\"\\"],\\"dateModified\\":\\"2025-06-04T09:27:16.000Z\\",\\"author\\":[{\\"@type\\":\\"Person\\",\\"name\\":\\"echo0d\\",\\"url\\":\\"\\"}]}"]]},"headers":[{"level":2,"title":"漏洞介绍","slug":"漏洞介绍","link":"#漏洞介绍","children":[{"level":3,"title":"漏洞危害","slug":"漏洞危害","link":"#漏洞危害","children":[]},{"level":3,"title":"影响范围","slug":"影响范围","link":"#影响范围","children":[]}]},{"level":2,"title":"漏洞原理","slug":"漏洞原理","link":"#漏洞原理","children":[]},{"level":2,"title":"漏洞利用","slug":"漏洞利用","link":"#漏洞利用","children":[{"level":3,"title":"靶机环境","slug":"靶机环境","link":"#靶机环境","children":[]},{"level":3,"title":"利用方式","slug":"利用方式","link":"#利用方式","children":[]}]},{"level":2,"title":"威胁防护建议","slug":"威胁防护建议","link":"#威胁防护建议","children":[]}],"git":{"createdTime":1731665131000,"updatedTime":1749029236000,"contributors":[{"name":"echo0d","email":"echo0d@163.com","commits":3}]},"readingTime":{"minutes":2.17,"words":652},"filePathRelative":"CyberSecurity/RedTeam/2-WebVulnerability/Weblogic/weblogic_CVE-2018-2894.md","localizedDate":"2024年11月15日","excerpt":"\\n","autoDesc":true}');export{W as comp,E as data};
