import{u as I,f as $,g as ee,h as j,i as te,j as le,t as ae,k as re,l as B,m as A,n as ie,p as q,q as l,s as k,v as w,R as Q,x as oe,y as se,z as ue,A as ne,O as ye,P as ce,B as de,C as me,D as ve,E as he,F as pe,G as be,H as Ce,I as F}from"./app-Btk8SoLK.js";const Se=["/","/CodeAudittutorial/","/others/DailySkills.html","/others/Treasure.html","/CodeAudittutorial/1-JavaBase/1-FileSystem.html","/CodeAudittutorial/1-JavaBase/2-commandExecute.html","/CodeAudittutorial/1-JavaBase/3-Database.html","/CodeAudittutorial/1-JavaBase/4-JNDI.html","/CodeAudittutorial/1-JavaBase/5-reflection.html","/CodeAudittutorial/1-JavaBase/6-ClassLoader.html","/CodeAudittutorial/1-JavaBase/7-DynamicProxy.html","/CodeAudittutorial/2-JavaWeb/1-JavaEE.html","/CodeAudittutorial/2-JavaWeb/2-JavaMVC.html","/CodeAudittutorial/2-JavaWeb/3-JavaWeb_Servlet.html","/CodeAudittutorial/2-JavaWeb/4-JavaWeb_filter.html","/CodeAudittutorial/2-JavaWeb/5-JavaWeb_Listener.html","/CodeAudittutorial/2-JavaWeb/6-CookieAndSession.html","/CodeAudittutorial/2-JavaWeb/7-JSP.html","/CodeAudittutorial/3-JavaVul/JavaVul.html","/CodeAudittutorial/3-JavaVul/deserialize.html","/CodeAudittutorial/4-GoVul/GoVul.html","/CyberSecurity/CTF/1-CTF_WEB.html","/CyberSecurity/CTF/","/CyberSecurity/DefenseEvasion/ExecuteAssembly.html","/CyberSecurity/DefenseEvasion/RDI.html","/CyberSecurity/DefenseEvasion/","/CyberSecurity/RedTeam/","/develop/C/1_syntax.html","/develop/C/2_VariableTypes.html","/develop/C/","/develop/CPP/","/develop/FrontEnd/JSModularity.html","/develop/FrontEnd/","/develop/FrontEnd/React_Typescript_antd.html","/develop/FrontEnd/Vue.html","/develop/Java/1_JavaBase.html","/develop/Java/2_ObjectOriented.html","/develop/Java/3_CoreClass.html","/develop/Java/4_Exception.html","/develop/Java/5_Reflection.html","/develop/Java/6_Annotation.html","/develop/Java/7_Genericity.html","/develop/Java/","/develop/Python/test_django.html","/develop/Rust/","/develop/php/","/CyberSecurity/RedTeam/1-InformationGathering/1_InformationGathering.html","/CyberSecurity/RedTeam/1-InformationGathering/2_Intranet_windows.html","/CyberSecurity/RedTeam/1-InformationGathering/3_CDN.html","/CyberSecurity/RedTeam/3-Persistence/1_LinuxPersistence.html","/CyberSecurity/RedTeam/3-Persistence/2_WindowsPersistence.html","/CyberSecurity/RedTeam/3-Persistence/3_ProcessInjection.html","/CyberSecurity/RedTeam/4-PrivilegeEscalation/1_Linux.html","/CyberSecurity/RedTeam/4-PrivilegeEscalation/2_Windows.html","/CyberSecurity/RedTeam/5-Intranet/Intranet_tunnel.html","/CyberSecurity/RedTeam/6-Emergency/Tamper.html","/CyberSecurity/RedTeam/6-Emergency/TracesRemoval.html","/CyberSecurity/RedTeam/Tools/Burpsuite.html","/CyberSecurity/RedTeam/Tools/SQLmap.html","/CyberSecurity/RedTeam/Tools/Tunnel.html","/CyberSecurity/RedTeam/Tools/WebShell.html","/CyberSecurity/RedTeam/Tools/openwrt.html","/develop/Go/ImprovingGo/1_GoFinal.html","/develop/Go/ImprovingGo/2_fscanPro.html","/develop/Go/ImprovingGo/","/develop/Go/gopl/","/develop/Go/gopl/ch1.html","/develop/Go/gopl/ch10.html","/develop/Go/gopl/ch11.html","/develop/Go/gopl/ch12.html","/develop/Go/gopl/ch2.html","/develop/Go/gopl/ch3.html","/develop/Go/gopl/ch4.html","/develop/Go/gopl/ch5.html","/develop/Go/gopl/ch6.html","/develop/Go/gopl/ch7.html","/CyberSecurity/RedTeam/2-WebVulnerability/Node.js/node_CVE-2017-14849.html","/CyberSecurity/RedTeam/2-WebVulnerability/Tomcat/tomcat_CVE-2017-12615.html","/CyberSecurity/RedTeam/2-WebVulnerability/Tomcat/tomcat_CVE-2020-1938.html","/CyberSecurity/RedTeam/2-WebVulnerability/Weblogic/weblogic_CVE-2017-10271.html","/CyberSecurity/RedTeam/2-WebVulnerability/Weblogic/weblogic_CVE-2018-2894.html","/CyberSecurity/RedTeam/2-WebVulnerability/Weblogic/weblogic_CVE-2020-14882.html","/CyberSecurity/RedTeam/2-WebVulnerability/fastjson/FastjsonVul.html","/CyberSecurity/RedTeam/2-WebVulnerability/log4j2/log4j2%20.html","/CyberSecurity/RedTeam/2-WebVulnerability/shiro/shiro.html","/CyberSecurity/RedTeam/2-WebVulnerability/shiro/%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96_shiro_CVE-2019-12422_shiro721%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E.html","/CyberSecurity/RedTeam/2-WebVulnerability/shiro/%E6%9D%83%E9%99%90%E7%BB%95%E8%BF%87_shiro_CVE-2020-11989_Apache%20Shiro782%E6%9D%83%E9%99%90%E7%BB%95%E8%BF%87%E6%BC%8F%E6%B4%9E.html","/CyberSecurity/RedTeam/2-WebVulnerability/shiro/%E6%9D%83%E9%99%90%E7%BB%95%E8%BF%87_shiro_CVE-2020-13933_Apache%20Shiro%E6%9D%83%E9%99%90%E7%BB%95%E8%BF%87%E6%BC%8F%E6%B4%9E.html","/CyberSecurity/RedTeam/2-WebVulnerability/spring/spring.html","/CyberSecurity/RedTeam/2-WebVulnerability/spring/spring_CVE-2018-1273_bypass.html","/CyberSecurity/RedTeam/2-WebVulnerability/supervisor/supervisor_CVE-2017-11610.html","/CyberSecurity/RedTeam/2-WebVulnerability/xstream/xstream_CVE-2021-21351.html","/CyberSecurity/RedTeam/Tools/C2/C3.html","/CyberSecurity/RedTeam/Tools/C2/CS.html","/CyberSecurity/RedTeam/Tools/C2/MSFUse.html","/CyberSecurity/RedTeam/Tools/C2/MSF_CS.html","/404.html","/others/","/CodeAudittutorial/1-JavaBase/","/CodeAudittutorial/2-JavaWeb/","/CodeAudittutorial/3-JavaVul/","/CodeAudittutorial/4-GoVul/","/CyberSecurity/","/develop/","/develop/Python/","/CyberSecurity/RedTeam/1-InformationGathering/","/CyberSecurity/RedTeam/3-Persistence/","/CyberSecurity/RedTeam/4-PrivilegeEscalation/","/CyberSecurity/RedTeam/5-Intranet/","/CyberSecurity/RedTeam/6-Emergency/","/CyberSecurity/RedTeam/Tools/","/develop/Go/","/CyberSecurity/RedTeam/2-WebVulnerability/Node.js/","/CyberSecurity/RedTeam/2-WebVulnerability/","/CyberSecurity/RedTeam/2-WebVulnerability/Tomcat/","/CyberSecurity/RedTeam/2-WebVulnerability/Weblogic/","/CyberSecurity/RedTeam/2-WebVulnerability/fastjson/","/CyberSecurity/RedTeam/2-WebVulnerability/log4j2/","/CyberSecurity/RedTeam/2-WebVulnerability/shiro/","/CyberSecurity/RedTeam/2-WebVulnerability/spring/","/CyberSecurity/RedTeam/2-WebVulnerability/supervisor/","/CyberSecurity/RedTeam/2-WebVulnerability/xstream/","/CyberSecurity/RedTeam/Tools/C2/"],Te="SEARCH_PRO_QUERY_HISTORY",m=I(Te,[]),Re=()=>{const{queryHistoryCount:a}=F,r=a>0;return{enabled:r,queryHistory:m,addQueryHistory:i=>{r&&(m.value.length<a?m.value=Array.from(new Set([i,...m.value])):m.value=Array.from(new Set([i,...m.value.slice(0,a-1)])))},removeQueryHistory:i=>{m.value=[...m.value.slice(0,i),...m.value.slice(i+1)]}}},G=a=>Se[a.id]+("anchor"in a?`#${a.anchor}`:""),Ee="SEARCH_PRO_RESULT_HISTORY",{resultHistoryCount:J}=F,v=I(Ee,[]),ge=()=>{const a=J>0;return{enabled:a,resultHistory:v,addResultHistory:r=>{if(a){const i={link:G(r),display:r.display};"header"in r&&(i.header=r.header),v.value.length<J?v.value=[i,...v.value]:v.value=[i,...v.value.slice(0,J-1)]}},removeResultHistory:r=>{v.value=[...v.value.slice(0,r),...v.value.slice(r+1)]}}},_e=a=>{const r=ye(),i=j(),{search:E,terminate:c}=ce(),p=B(!1),b=de([]);return me(()=>{const h=()=>{b.value=[],p.value=!1},g=Ce(C=>{p.value=!0,C?E({type:"search",query:C,locale:i.value,options:r.value}).then(d=>{b.value=d,p.value=!1}).catch(d=>{console.error(d),h()}):h()},F.searchDelay);q([a,i],()=>g(a.value),{immediate:!0}),ve(()=>{c()})}),{searching:p,results:b}};var fe=$({name:"SearchResult",props:{query:{type:String,required:!0},isFocusing:Boolean},emits:["close","updateQuery"],setup(a,{emit:r}){const i=ee(),E=j(),c=te(le),{enabled:p,addQueryHistory:b,queryHistory:h,removeQueryHistory:g}=Re(),{enabled:C,resultHistory:d,addResultHistory:x,removeResultHistory:L}=ge(),D=p||C,_=ae(a,"query"),{results:S,searching:O}=_e(_),o=re({isQuery:!0,index:0}),n=B(0),y=B(0),H=A(()=>D&&(h.value.length>0||d.value.length>0)),V=A(()=>S.value.length>0),f=A(()=>S.value[n.value]||null),M=()=>{const{isQuery:e,index:t}=o;t===0?(o.isQuery=!e,o.index=e?d.value.length-1:h.value.length-1):o.index=t-1},U=()=>{const{isQuery:e,index:t}=o;t===(e?h.value.length-1:d.value.length-1)?(o.isQuery=!e,o.index=0):o.index=t+1},N=()=>{n.value=n.value>0?n.value-1:S.value.length-1,y.value=f.value.contents.length-1},z=()=>{n.value=n.value<S.value.length-1?n.value+1:0,y.value=0},Y=()=>{y.value<f.value.contents.length-1?y.value+=1:z()},K=()=>{y.value>0?y.value-=1:N()},W=e=>e.map(t=>he(t)?t:l(t[0],t[1])),X=e=>{if(e.type==="customField"){const t=pe[e.index]||"$content",[s,R=""]=be(t)?t[E.value].split("$content"):t.split("$content");return e.display.map(u=>l("div",W([s,...u,R])))}return e.display.map(t=>l("div",W(t)))},T=()=>{n.value=0,y.value=0,r("updateQuery",""),r("close")};return ie("keydown",e=>{if(a.isFocusing){if(V.value){if(e.key==="ArrowUp")K();else if(e.key==="ArrowDown")Y();else if(e.key==="Enter"){const t=f.value.contents[y.value];b(a.query),x(t),i.push(G(t)),T()}}else if(C){if(e.key==="ArrowUp")M();else if(e.key==="ArrowDown")U();else if(e.key==="Enter"){const{index:t}=o;o.isQuery?(r("updateQuery",h.value[t]),e.preventDefault()):(i.push(d.value[t].link),T())}}}}),q([n,y],()=>{var e;(e=document.querySelector(".search-pro-result-list-item.active .search-pro-result-item.active"))==null||e.scrollIntoView(!1)},{flush:"post"}),()=>l("div",{class:["search-pro-result-wrapper",{empty:_.value?!V.value:!H.value}],id:"search-pro-results"},_.value===""?D?H.value?[p?l("ul",{class:"search-pro-result-list"},l("li",{class:"search-pro-result-list-item"},[l("div",{class:"search-pro-result-title"},c.value.queryHistory),h.value.map((e,t)=>l("div",{class:["search-pro-result-item",{active:o.isQuery&&o.index===t}],onClick:()=>{r("updateQuery",e)}},[l(k,{class:"search-pro-result-type"}),l("div",{class:"search-pro-result-content"},e),l("button",{class:"search-pro-remove-icon",innerHTML:w,onClick:s=>{s.preventDefault(),s.stopPropagation(),g(t)}})]))])):null,C?l("ul",{class:"search-pro-result-list"},l("li",{class:"search-pro-result-list-item"},[l("div",{class:"search-pro-result-title"},c.value.resultHistory),d.value.map((e,t)=>l(Q,{to:e.link,class:["search-pro-result-item",{active:!o.isQuery&&o.index===t}],onClick:()=>{T()}},()=>[l(k,{class:"search-pro-result-type"}),l("div",{class:"search-pro-result-content"},[e.header?l("div",{class:"content-header"},e.header):null,l("div",e.display.map(s=>W(s)).flat())]),l("button",{class:"search-pro-remove-icon",innerHTML:w,onClick:s=>{s.preventDefault(),s.stopPropagation(),L(t)}})]))])):null]:c.value.emptyHistory:c.value.emptyResult:O.value?l(oe,{hint:c.value.searching}):V.value?l("ul",{class:"search-pro-result-list"},S.value.map(({title:e,contents:t},s)=>{const R=n.value===s;return l("li",{class:["search-pro-result-list-item",{active:R}]},[l("div",{class:"search-pro-result-title"},e||c.value.defaultTitle),t.map((u,Z)=>{const P=R&&y.value===Z;return l(Q,{to:G(u),class:["search-pro-result-item",{active:P,"aria-selected":P}],onClick:()=>{b(a.query),x(u),T()}},()=>[u.type==="text"?null:l(u.type==="title"?se:u.type==="heading"?ue:ne,{class:"search-pro-result-type"}),l("div",{class:"search-pro-result-content"},[u.type==="text"&&u.header?l("div",{class:"content-header"},u.header):null,l("div",X(u))])])})])})):c.value.emptyResult)}});export{fe as default};
