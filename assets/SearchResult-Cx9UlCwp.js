import{f as K,u as X,g as k,h as Z,i as $,t as ee,j as te,k as P,l as B,m as l,n as le,p as I,q as F,s as H,R as x,v as ae,x as re,y as oe,z as ie,A as se,B as ue,C as ne,O as ce,P as ye,D as de,E as me,F as ve,G as he,H as Q,I as D}from"./app-BZ3msaS8.js";const pe=["/","/Clippings/flow-eda%E5%8A%9F%E8%83%BD%E8%8A%82%E7%82%B9.html","/CodeAudittutorial/","/develop/DailyDev.html","/others/DailySkills.html","/others/Treasure.html","/CyberSecurity/CTF/1-CTF_WEB.html","/CyberSecurity/CTF/","/CyberSecurity/DefenseEvasion/ExecuteAssembly.html","/CyberSecurity/DefenseEvasion/ProcessInjection.html","/CyberSecurity/DefenseEvasion/RDI.html","/CyberSecurity/DefenseEvasion/","/CyberSecurity/DefenseEvasion/WindowsArchitectureProcess.html","/CyberSecurity/RedTeam/","/CyberSecurity/SRC/SrcNote.html","/CodeAudittutorial/1-JavaBase/1-FileSystem.html","/CodeAudittutorial/1-JavaBase/2-commandExecute.html","/CodeAudittutorial/1-JavaBase/3-Database.html","/CodeAudittutorial/1-JavaBase/4-JNDI.html","/CodeAudittutorial/1-JavaBase/5-reflection.html","/CodeAudittutorial/1-JavaBase/6-ClassLoader.html","/CodeAudittutorial/1-JavaBase/7-DynamicProxy.html","/CodeAudittutorial/2-JavaWeb/1-JavaEE.html","/CodeAudittutorial/2-JavaWeb/2-JavaMVC.html","/CodeAudittutorial/2-JavaWeb/3-JavaWeb_Servlet.html","/CodeAudittutorial/2-JavaWeb/4-JavaWeb_filter.html","/CodeAudittutorial/2-JavaWeb/5-JavaWeb_Listener.html","/CodeAudittutorial/2-JavaWeb/6-CookieAndSession.html","/CodeAudittutorial/2-JavaWeb/7-JSP.html","/CodeAudittutorial/3-JavaVul/JavaVul.html","/CodeAudittutorial/3-JavaVul/deserialize.html","/CodeAudittutorial/4-GoVul/GoVul.html","/CodeAudittutorial/5-PHP/1-PHPBase.html","/develop/C/10_memory.html","/develop/C/11_preprocessor.html","/develop/C/12_IO.html","/develop/C/13_file.html","/develop/C/14_specifier.html","/develop/C/15_multifile.html","/develop/C/16_cli.html","/develop/C/17_multibyte.html","/develop/C/1_syntax.html","/develop/C/2_VariableTypes.html","/develop/C/3_Operator.html","/develop/C/4_flow-control.html","/develop/C/5_pointer.html","/develop/C/6_function.html","/develop/C/7_array.html","/develop/C/8_string.html","/develop/C/9_otherType.html","/develop/C/","/develop/CPP/1_Externsion.html","/develop/CPP/2_Encapsulation.html","/develop/CPP/3_Class_object.html","/develop/CPP/4_Inheritance.html","/develop/CPP/5_overloading.html","/develop/CPP/6_polymorphism.html","/develop/CPP/","/develop/FrontEnd/JSModularity.html","/develop/FrontEnd/","/develop/FrontEnd/React_Typescript_antd.html","/develop/FrontEnd/Vue.html","/develop/Java/1_JavaBase.html","/develop/Java/2_ObjectOriented.html","/develop/Java/3_CoreClass.html","/develop/Java/4_Exception.html","/develop/Java/5_Reflection.html","/develop/Java/6_Annotation.html","/develop/Java/7_Genericity.html","/develop/Java/8_Native.html","/develop/Java/9_Hook.html","/develop/Java/","/develop/Python/test_django.html","/develop/Rust/","/develop/other/anti-debug.html","/develop/php/","/CyberSecurity/RedTeam/1-InformationGathering/1_InformationGathering.html","/CyberSecurity/RedTeam/1-InformationGathering/2_Intranet_windows.html","/CyberSecurity/RedTeam/1-InformationGathering/3_CDN.html","/CyberSecurity/RedTeam/3-Persistence/1_LinuxPersistence.html","/CyberSecurity/RedTeam/3-Persistence/2_WindowsPersistence.html","/CyberSecurity/RedTeam/4-PrivilegeEscalation/1_Linux.html","/CyberSecurity/RedTeam/4-PrivilegeEscalation/2_Windows.html","/CyberSecurity/RedTeam/5-Intranet/Intranet_tunnel.html","/CyberSecurity/RedTeam/6-Emergency/Tamper.html","/CyberSecurity/RedTeam/6-Emergency/TracesRemoval.html","/CyberSecurity/RedTeam/Tools/Burpsuite.html","/CyberSecurity/RedTeam/Tools/SQLmap.html","/CyberSecurity/RedTeam/Tools/Tunnel.html","/CyberSecurity/RedTeam/Tools/WebShell.html","/CyberSecurity/RedTeam/Tools/openwrt.html","/develop/Go/ImprovingGo/1_GoFinal.html","/develop/Go/ImprovingGo/2_fscanPro.html","/develop/Go/ImprovingGo/","/develop/Go/gopl/","/develop/Go/gopl/ch1.html","/develop/Go/gopl/ch10.html","/develop/Go/gopl/ch11.html","/develop/Go/gopl/ch12.html","/develop/Go/gopl/ch2.html","/develop/Go/gopl/ch3.html","/develop/Go/gopl/ch4.html","/develop/Go/gopl/ch5.html","/develop/Go/gopl/ch6.html","/develop/Go/gopl/ch7.html","/CyberSecurity/RedTeam/2-WebVulnerability/Node.js/node_CVE-2017-14849.html","/CyberSecurity/RedTeam/2-WebVulnerability/Tomcat/tomcat_CVE-2017-12615.html","/CyberSecurity/RedTeam/2-WebVulnerability/Tomcat/tomcat_CVE-2020-1938.html","/CyberSecurity/RedTeam/2-WebVulnerability/Weblogic/weblogic_CVE-2017-10271.html","/CyberSecurity/RedTeam/2-WebVulnerability/Weblogic/weblogic_CVE-2018-2894.html","/CyberSecurity/RedTeam/2-WebVulnerability/Weblogic/weblogic_CVE-2020-14882.html","/CyberSecurity/RedTeam/2-WebVulnerability/fastjson/FastjsonVul.html","/CyberSecurity/RedTeam/2-WebVulnerability/log4j2/log4j2%20.html","/CyberSecurity/RedTeam/2-WebVulnerability/shiro/shiro.html","/CyberSecurity/RedTeam/2-WebVulnerability/shiro/shiro_CVE-2019-12422_shiro721.html","/CyberSecurity/RedTeam/2-WebVulnerability/shiro/shiro_CVE-2020-11989.html","/CyberSecurity/RedTeam/2-WebVulnerability/shiro/shiro_CVE-2020-13933.html","/CyberSecurity/RedTeam/2-WebVulnerability/spring/spring.html","/CyberSecurity/RedTeam/2-WebVulnerability/spring/spring_CVE-2018-1273_bypass.html","/CyberSecurity/RedTeam/2-WebVulnerability/supervisor/supervisor_CVE-2017-11610.html","/CyberSecurity/RedTeam/2-WebVulnerability/xstream/xstream_CVE-2021-21351.html","/CyberSecurity/RedTeam/Tools/C2/C3.html","/CyberSecurity/RedTeam/Tools/C2/CS.html","/CyberSecurity/RedTeam/Tools/C2/MSFUse.html","/CyberSecurity/RedTeam/Tools/C2/MSF_CS.html","/404.html","/Clippings/","/develop/","/others/","/CyberSecurity/","/CyberSecurity/SRC/","/CodeAudittutorial/1-JavaBase/","/CodeAudittutorial/2-JavaWeb/","/CodeAudittutorial/3-JavaVul/","/CodeAudittutorial/4-GoVul/","/CodeAudittutorial/5-PHP/","/develop/Python/","/develop/other/","/CyberSecurity/RedTeam/1-InformationGathering/","/CyberSecurity/RedTeam/3-Persistence/","/CyberSecurity/RedTeam/4-PrivilegeEscalation/","/CyberSecurity/RedTeam/5-Intranet/","/CyberSecurity/RedTeam/6-Emergency/","/CyberSecurity/RedTeam/Tools/","/develop/Go/","/CyberSecurity/RedTeam/2-WebVulnerability/Node.js/","/CyberSecurity/RedTeam/2-WebVulnerability/","/CyberSecurity/RedTeam/2-WebVulnerability/Tomcat/","/CyberSecurity/RedTeam/2-WebVulnerability/Weblogic/","/CyberSecurity/RedTeam/2-WebVulnerability/fastjson/","/CyberSecurity/RedTeam/2-WebVulnerability/log4j2/","/CyberSecurity/RedTeam/2-WebVulnerability/shiro/","/CyberSecurity/RedTeam/2-WebVulnerability/spring/","/CyberSecurity/RedTeam/2-WebVulnerability/supervisor/","/CyberSecurity/RedTeam/2-WebVulnerability/xstream/","/CyberSecurity/RedTeam/Tools/C2/","/category/","/category/%E6%97%A5%E5%B8%B8%E5%A4%87%E5%BF%98/","/category/%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8/","/category/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/","/category/c/","/category/c__/","/category/%E5%89%8D%E7%AB%AF/","/category/java/","/category/python/","/category/%E5%BC%80%E5%8F%91/","/category/php/","/category/%E5%B7%A5%E5%85%B7/","/category/go/","/tag/","/tag/wsl/","/tag/docker/","/tag/%E6%8A%A5%E9%94%99%E8%A7%A3%E5%86%B3/","/tag/%E5%AE%9E%E7%94%A8%E5%B7%A5%E5%85%B7/","/tag/%E4%B9%A6%E7%B1%8D/","/tag/%E8%8B%B1%E8%AF%AD/","/tag/ctf/","/tag/%E9%98%B2%E5%BE%A1%E8%A7%84%E9%81%BF/","/tag/%E6%8C%81%E4%B9%85%E5%8C%96/","/tag/windows/","/tag/src/","/tag/java/","/tag/go/","/tag/php/","/tag/c/","/tag/cpp/","/tag/%E5%89%8D%E7%AB%AF/","/tag/react/","/tag/vue/","/tag/python/","/tag/django/","/tag/%E5%8F%8D%E8%B0%83%E8%AF%95/","/tag/%E7%BA%A2%E9%98%9F/","/tag/%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87/","/tag/%E5%86%85%E7%BD%91/","/tag/%E9%9A%A7%E9%81%93/","/tag/%E5%BA%94%E6%80%A5/","/tag/burpsuite/","/tag/%E5%B7%A5%E5%85%B7/","/tag/sqlmap/","/tag/webshell/","/tag/openwrt/","/tag/%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90/","/article/","/star/","/timeline/"],Ce="SEARCH_PRO_QUERY_HISTORY",d=Q(Ce,[]),be=()=>{const{queryHistoryCount:a}=D;return{enabled:a>0,queryHistory:d,addQueryHistory:o=>{d.value.length<a?d.value=Array.from(new Set([o,...d.value])):d.value=Array.from(new Set([o,...d.value.slice(0,a-1)]))},removeQueryHistory:o=>{d.value=[...d.value.slice(0,o),...d.value.slice(o+1)]}}},J=a=>pe[a.id]+("anchor"in a?`#${a.anchor}`:""),ge="SEARCH_PRO_RESULT_HISTORY",{resultHistoryCount:W}=D,m=Q(ge,[]),Ee=()=>({enabled:W>0,resultHistory:m,addResultHistory:r=>{{const o={link:J(r),display:r.display};"header"in r&&(o.header=r.header),m.value.length<W?m.value=[o,...m.value]:m.value=[o,...m.value.slice(0,W-1)]}},removeResultHistory:r=>{m.value=[...m.value.slice(0,r),...m.value.slice(r+1)]}}),Se=a=>{const r=ce(),o=k(),{search:R,terminate:v}=ye(),h=P(!1),y=de([]);return me(()=>{const E=()=>{y.value=[],h.value=!1},p=ve(C=>{h.value=!0,C?R({type:"search",query:C,locale:o.value,options:r.value}).then(b=>{y.value=b,h.value=!1}).catch(b=>{console.error(b),E()}):E()},D.searchDelay);I([a,o],()=>p(a.value),{immediate:!0}),he(()=>{v()})}),{searching:h,results:y}};var Re=K({name:"SearchResult",props:{query:{type:String,required:!0},isFocusing:Boolean},emits:["close","updateQuery"],setup(a,{emit:r}){const o=X(),R=k(),v=Z($),{addQueryHistory:h,queryHistory:y,removeQueryHistory:E}=be(),{resultHistory:p,addResultHistory:C,removeResultHistory:b}=Ee(),A=ee(a,"query"),{results:g,searching:j}=Se(A),i=te({isQuery:!0,index:0}),n=P(0),c=P(0),w=B(()=>y.value.length>0||p.value.length>0),_=B(()=>g.value.length>0),f=B(()=>g.value[n.value]||null),q=()=>{const{isQuery:e,index:t}=i;t===0?(i.isQuery=!e,i.index=e?p.value.length-1:y.value.length-1):i.index=t-1},L=()=>{const{isQuery:e,index:t}=i;t===(e?y.value.length-1:p.value.length-1)?(i.isQuery=!e,i.index=0):i.index=t+1},O=()=>{n.value=n.value>0?n.value-1:g.value.length-1,c.value=f.value.contents.length-1},M=()=>{n.value=n.value<g.value.length-1?n.value+1:0,c.value=0},N=()=>{c.value<f.value.contents.length-1?c.value+=1:M()},U=()=>{c.value>0?c.value-=1:O()},V=e=>e.map(t=>se(t)?t:l(t[0],t[1])),z=e=>{if(e.type==="customField"){const t=ue[e.index]||"$content",[s,T=""]=ne(t)?t[R.value].split("$content"):t.split("$content");return e.display.map(u=>l("div",V([s,...u,T])))}return e.display.map(t=>l("div",V(t)))},S=()=>{n.value=0,c.value=0,r("updateQuery",""),r("close")};return le("keydown",e=>{if(a.isFocusing){if(_.value){if(e.key==="ArrowUp")U();else if(e.key==="ArrowDown")N();else if(e.key==="Enter"){const t=f.value.contents[c.value];h(a.query),C(t),o.push(J(t)),S()}}else if(e.key==="ArrowUp")q();else if(e.key==="ArrowDown")L();else if(e.key==="Enter"){const{index:t}=i;i.isQuery?(r("updateQuery",y.value[t]),e.preventDefault()):(o.push(p.value[t].link),S())}}}),I([n,c],()=>{var e;(e=document.querySelector(".search-pro-result-list-item.active .search-pro-result-item.active"))==null||e.scrollIntoView(!1)},{flush:"post"}),()=>l("div",{class:["search-pro-result-wrapper",{empty:A.value?!_.value:!w.value}],id:"search-pro-results"},A.value===""?w.value?[l("ul",{class:"search-pro-result-list"},l("li",{class:"search-pro-result-list-item"},[l("div",{class:"search-pro-result-title"},v.value.queryHistory),y.value.map((e,t)=>l("div",{class:["search-pro-result-item",{active:i.isQuery&&i.index===t}],onClick:()=>{r("updateQuery",e)}},[l(F,{class:"search-pro-result-type"}),l("div",{class:"search-pro-result-content"},e),l("button",{class:"search-pro-remove-icon",innerHTML:H,onClick:s=>{s.preventDefault(),s.stopPropagation(),E(t)}})]))])),l("ul",{class:"search-pro-result-list"},l("li",{class:"search-pro-result-list-item"},[l("div",{class:"search-pro-result-title"},v.value.resultHistory),p.value.map((e,t)=>l(x,{to:e.link,class:["search-pro-result-item",{active:!i.isQuery&&i.index===t}],onClick:()=>{S()}},()=>[l(F,{class:"search-pro-result-type"}),l("div",{class:"search-pro-result-content"},[e.header?l("div",{class:"content-header"},e.header):null,l("div",e.display.map(s=>V(s)).flat())]),l("button",{class:"search-pro-remove-icon",innerHTML:H,onClick:s=>{s.preventDefault(),s.stopPropagation(),b(t)}})]))]))]:v.value.emptyHistory:j.value?l(ae,{hint:v.value.searching}):_.value?l("ul",{class:"search-pro-result-list"},g.value.map(({title:e,contents:t},s)=>{const T=n.value===s;return l("li",{class:["search-pro-result-list-item",{active:T}]},[l("div",{class:"search-pro-result-title"},e||v.value.defaultTitle),t.map((u,Y)=>{const G=T&&c.value===Y;return l(x,{to:J(u),class:["search-pro-result-item",{active:G,"aria-selected":G}],onClick:()=>{h(a.query),C(u),S()}},()=>[u.type==="text"?null:l(u.type==="title"?re:u.type==="heading"?oe:ie,{class:"search-pro-result-type"}),l("div",{class:"search-pro-result-content"},[u.type==="text"&&u.header?l("div",{class:"content-header"},u.header):null,l("div",z(u))])])})])})):v.value.emptyResult)}});export{Re as default};
